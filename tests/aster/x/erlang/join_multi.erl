#!/usr/bin/env escript
-module(main).

-export([main/1]).

% Generated by Mochi transpiler v0.10.34 (d7f338ce0) on 2025-07-21 20:48 +0700
main(_) ->
    Customers = [#{"id" => 1, "name" => "Alice"}, #{"id" => 2, "name" => "Bob"}],
    Orders = [#{"id" => 100, "customerId" => 1}, #{"id" => 101, "customerId" => 2}],
    Items = [#{"orderId" => 100, "sku" => "a"}, #{"orderId" => 101, "sku" => "b"}],
    Result = [#{"name" => maps:get("name", C), "sku" => maps:get("sku", I)} || O <- Orders, C <- Customers, I <- Items, ((maps:get("customerId", O) == maps:get("id", C)) andalso (maps:get("id", O) == maps:get("orderId", I)))],
    io:format("~s~n", ["--- Multi Join ---"]),
    lists:foreach(fun (R) ->     io:format("~p ~s ~p~n", [maps:get("name", R), "bought item", maps:get("sku", R)])
 end, Result)
.
