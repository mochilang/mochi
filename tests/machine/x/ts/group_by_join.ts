// Generated by Mochi compiler v0.10.25 on 2025-07-14T02:52:45Z
// Source: tests/vm/valid/group_by_join.mochi

let customers: Record<string, any>[];
let orders: { [key: string]: number }[];
let stats: Record<string, any>[];

function main(): void {
  customers = [
    {
      "id": 1,
      "name": "Alice",
    },
    {
      "id": 2,
      "name": "Bob",
    },
  ];
  orders = [
    {
      "id": 100,
      "customerId": 1,
    },
    {
      "id": 101,
      "customerId": 1,
    },
    {
      "id": 102,
      "customerId": 2,
    },
  ];
  stats = (() => {
    const cMap = new Map<any, any>();
    for (const c of customers) {
      cMap.set(c.id, c.name);
    }
    const counts = new Map<any, number>();
    for (const o of orders) {
      const name = cMap.get(o.customerId);
      if (!name) continue;
      counts.set(name, (counts.get(name) || 0) + 1);
    }
    const _res = [];
    for (const [name, count] of counts) {
      _res.push({ name, count });
    }
    return _res;
  })();
  console.log("--- Orders per customer ---");
  for (const s of stats) {
    console.log(`${s.name} orders: ${s.count}`);
  }
}
main();
