// Generated by Mochi compiler v0.10.25 on 2025-07-14T02:46:22Z
// Source: tests/vm/valid/group_by_join.mochi

type Customer = {
  id: number
  name: string
}

type Order = {
  id: number
  customerId: number
}

type Stat = {
  name: string
  count: number
}

function main(): void {
  const customers: Customer[] = [
    { id: 1, name: "Alice" },
    { id: 2, name: "Bob" },
  ]

  const orders: Order[] = [
    { id: 100, customerId: 1 },
    { id: 101, customerId: 1 },
    { id: 102, customerId: 2 },
  ]

  const customerMap = new Map<number, string>()
  for (const c of customers) {
    customerMap.set(c.id, c.name)
  }

  const counts = new Map<string, number>()

  for (const o of orders) {
    const name = customerMap.get(o.customerId)
    if (!name) continue

    counts.set(name, (counts.get(name) || 0) + 1)
  }

  console.log("--- Orders per customer ---")
  for (const [name, count] of counts) {
    console.log(`${name} orders: ${count}`)
  }
}

main()
