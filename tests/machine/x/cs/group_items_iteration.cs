// Generated by Mochi C# compiler
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text.Json;

public class Program {
    public static void Main() {
        var data = new dynamic[] { new Dictionary<string, dynamic> { { "tag", "a" }, { "val", 1 } }, new Dictionary<string, dynamic> { { "tag", "a" }, { "val", 2 } }, new Dictionary<string, dynamic> { { "tag", "b" }, { "val", 3 } } };
        var groups = data.GroupBy(d => d["tag"]).Select(g => g).ToList();
        var tmp = new dynamic[] { };
        foreach (var g in groups) {
            long total = 0;
            foreach (var x in g.Items) {
                total = (total + x["val"]);
            }
            tmp = (new Func<List<dynamic>>(() => {var _tmp0=new List<dynamic>(tmp);_tmp0.Add(new Dictionary<string, dynamic> { { "tag", g.Key }, { "total", total } });return _tmp0;}))();
        }
        var result = tmp.OrderBy(r => r["tag"]).Select(r => r);
        Console.WriteLine(JsonSerializer.Serialize(result));
    }
}
