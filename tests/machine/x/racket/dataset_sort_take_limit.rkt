#lang racket
(require racket/list)
(define products (list (hash 'name "Laptop" 'price 1500) (hash 'name "Smartphone" 'price 900) (hash 'name "Tablet" 'price 600) (hash 'name "Monitor" 'price 300) (hash 'name "Keyboard" 'price 100) (hash 'name "Mouse" 'price 50) (hash 'name "Headphones" 'price 200)))
(define expensive (let ([_items0 (for*/list ([p products]) p)])
  (set! _items0 (sort _items0 (lambda (a b) (cond [(string? (let ([p a]) (hash-ref p 'price))) (string>? (let ([p a]) (hash-ref p 'price)) (let ([p b]) (hash-ref p 'price)))] [(string? (let ([p b]) (hash-ref p 'price))) (string>? (let ([p a]) (hash-ref p 'price)) (let ([p b]) (hash-ref p 'price)))] [else (> (let ([p a]) (hash-ref p 'price)) (let ([p b]) (hash-ref p 'price)))]))))
  (set! _items0 (drop _items0 (max 1 0)))
  (set! _items0 (take _items0 (max 3 0)))
  (for/list ([p _items0]) p)))
(displayln "--- Top products (excluding most expensive) ---")
(for ([item (if (hash? expensive) (hash-keys expensive) expensive)])
(displayln (string-join (map ~a (list (hash-ref item 'name) "costs $" (hash-ref item 'price))) " "))
)
