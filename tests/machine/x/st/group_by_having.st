" Generated by Mochi compiler v0.10.25 on 2025-07-13T05:07:58Z
"
| people big |
people := {Dictionary from:{'name'->'Alice'. 'city'->'Paris'}. Dictionary from:{'name'->'Bob'. 'city'->'Hanoi'}. Dictionary from:{'name'->'Charlie'. 'city'->'Paris'}. Dictionary from:{'name'->'Diana'. 'city'->'Hanoi'}. Dictionary from:{'name'->'Eve'. 'city'->'Paris'}. Dictionary from:{'name'->'Frank'. 'city'->'Hanoi'}. Dictionary from:{'name'->'George'. 'city'->'Paris'}}.
big := [ | groups tmp |
  groups := Dictionary new.
  tmp := OrderedCollection new.
  people do: [:p |
    | g |
    g := groups at: p at: 'city' ifAbsentPut:[OrderedCollection new].
    g add: Dictionary from:{#p->p}.
  ].
  groups keysAndValuesDo: [:k :grp |
    | g |
    g := Dictionary from:{'key'->k. 'items'->grp}.
    tmp add: Dictionary from:{'city'->g.key. 'num'->(g size)}.
  ].
  tmp
] value.
json value: big.
