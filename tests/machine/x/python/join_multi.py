# Generated by Mochi Python compiler
from __future__ import annotations

import typing

customers: list[dict[str, typing.Any]] = None
orders: list[dict[str, int]] = None
items: list[dict[str, typing.Any]] = None
result: list[dict[str, typing.Any]] = None


def main():
    global customers
    customers = [{"id": 1, "name": "Alice"}, {"id": 2, "name": "Bob"}]
    global orders
    orders = [{"id": 100, "customerId": 1}, {"id": 101, "customerId": 2}]
    global items
    items = [{"orderId": 100, "sku": "a"}, {"orderId": 101, "sku": "b"}]
    global result
    result = [
        {"name": c["name"], "sku": i["sku"]}
        for o in orders
        for c in customers
        for i in items
        if (o["customerId"] == c["id"]) and (o["id"] == i["orderId"])
    ]
    print("--- Multi Join ---")
    for r in result:
        print(r["name"], "bought item", r["sku"])


if __name__ == "__main__":
    main()
