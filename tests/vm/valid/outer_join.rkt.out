;; Generated by Mochi 0.10.31 on 2025-07-20 14:31 +0700
#lang racket
(require racket/list racket/string)

(define customers (list (hash id 1 name "Alice") (hash id 2 name "Bob") (hash id 3 name "Charlie") (hash id 4 name "Diana")))
(define orders (list (hash id 100 customerId 1 total 250) (hash id 101 customerId 2 total 125) (hash id 102 customerId 1 total 300) (hash id 103 customerId 5 total 80)))
(define result (let ([_res '()])
  (for ([o orders])
    (let ([matched #f])
      (for ([c customers])
        (when (= (hash-ref o "customerId") (hash-ref c "id"))
          (set! matched #t)
          (set! _res (append _res (list (hash order o customer c))))
      )
      (when (not matched)
        (let ([c #f])
          (set! _res (append _res (list (hash order o customer c))))
        )
      )
    ))
  )
  (for ([c customers])
    (unless (for/or ([o orders]) (= (hash-ref o "customerId") (hash-ref c "id")))
      (let ([o #f])
        (set! _res (append _res (list (hash order o customer c))))
      )
    ))
  )
  _res))
(displayln "--- Outer Join using syntax ---")
(for ([row result])
(if (hash-ref row "order") (begin
(if (hash-ref row "customer") (begin
(displayln (format "~a ~a ~a ~a ~a ~a" "Order" (hash-ref (hash-ref row "id") "order") "by" (hash-ref (hash-ref row "name") "customer") "- $" (hash-ref (hash-ref row "total") "order")))
) (begin
(displayln (format "~a ~a ~a ~a ~a ~a" "Order" (hash-ref (hash-ref row "id") "order") "by" "Unknown" "- $" (hash-ref (hash-ref row "total") "order")))
))
) (begin
(displayln (format "~a ~a ~a" "Customer" (hash-ref (hash-ref row "name") "customer") "has no orders"))
))
)
