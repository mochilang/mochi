func main (regs=85)
  // let data = [
  Const        r0, [{"tag": "a", "val": 1}, {"tag": "a", "val": 2}, {"tag": "b", "val": 3}]
  // let groups = from d in data group by d.tag into g select g
  Const        r1, []
  IterPrep     r2, r0
  Len          r3, r2
  Const        r4, 0
  MakeMap      r5, 0, r0
  Const        r6, []
L2:
  Less         r7, r4, r3
  JumpIfFalse  r7, L0
  Index        r8, r2, r4
  Move         r9, r8
  Const        r10, "tag"
  Index        r11, r9, r10
  Str          r12, r11
  In           r13, r12, r5
  JumpIfTrue   r13, L1
  Const        r14, []
  Const        r15, "__group__"
  Const        r16, true
  Const        r17, "key"
  Move         r18, r11
  Const        r19, "items"
  Move         r20, r14
  MakeMap      r21, 3, r15
  SetIndex     r5, r12, r21
  Append       r6, r6, r21
L1:
  Const        r23, "items"
  Index        r24, r5, r12
  Index        r25, r24, r23
  Append       r26, r25, r8
  SetIndex     r24, r23, r26
  Const        r27, 1
  Add          r4, r4, r27
  Jump         L2
L0:
  Const        r29, 0
  Len          r30, r6
L4:
  Less         r31, r29, r30
  JumpIfFalse  r31, L3
  Index        r33, r6, r29
  Append       r1, r1, r33
  Const        r35, 1
  Add          r29, r29, r35
  Jump         L4
L3:
  // var tmp = []
  Const        r38, []
  // for g in groups {
  IterPrep     r39, r1
  Len          r40, r39
  Const        r41, 0
L8:
  Less         r42, r41, r40
  JumpIfFalse  r42, L5
  Index        r33, r39, r41
  // var total = 0
  Const        r45, 0
  // for x in g.items {
  Const        r46, "items"
  Index        r47, r33, r46
  IterPrep     r48, r47
  Len          r49, r48
  Const        r50, 0
L7:
  Less         r51, r50, r49
  JumpIfFalse  r51, L6
  Index        r53, r48, r50
  // total = total + x.val
  Const        r54, "val"
  Index        r55, r53, r54
  Add          r45, r45, r55
  // for x in g.items {
  Const        r57, 1
  Add          r50, r50, r57
  Jump         L7
L6:
  // tmp = append(tmp, {tag: g.key, total: total})
  Const        r59, "tag"
  Const        r60, "key"
  Index        r61, r33, r60
  Const        r62, "total"
  MakeMap      r65, 2, r59
  Append       r38, r38, r65
  // for g in groups {
  Const        r67, 1
  Add          r41, r41, r67
  Jump         L8
L5:
  // let result = from r in tmp sort by r.tag select r
  Const        r69, []
  IterPrep     r70, r38
  Len          r71, r70
  Const        r72, 0
L10:
  Less         r73, r72, r71
  JumpIfFalse  r73, L9
  Index        r75, r70, r72
  Const        r76, "tag"
  Index        r78, r75, r76
  Move         r79, r75
  MakeList     r80, 2, r78
  Append       r69, r69, r80
  Const        r82, 1
  Add          r72, r72, r82
  Jump         L10
L9:
  Sort         r69, r69
  // print(result)
  Print        r69
  Return       r0
