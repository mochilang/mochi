func main (regs=87)
  // let data = [
  Const        r0, [{"tag": "a", "val": 1}, {"tag": "a", "val": 2}, {"tag": "b", "val": 3}]
  // let groups = from d in data group by d.tag into g select g
  Const        r1, []
  Const        r2, "tag"
  IterPrep     r3, r0
  Len          r4, r3
  Const        r5, 0
  MakeMap      r6, 0, r0
  Const        r7, []
L2:
  LessInt      r8, r5, r4
  JumpIfFalse  r8, L0
  Index        r9, r3, r5
  Index        r11, r9, r2
  Str          r12, r11
  In           r13, r12, r6
  JumpIfTrue   r13, L1
  Const        r14, []
  Const        r15, "__group__"
  Const        r16, true
  Const        r17, "key"
  Move         r18, r11
  Const        r19, "items"
  Move         r20, r14
  Const        r21, "count"
  Const        r22, 0
  Move         r23, r15
  Move         r24, r16
  Move         r25, r17
  Move         r26, r18
  Move         r27, r19
  Move         r28, r20
  Move         r29, r21
  Move         r30, r22
  MakeMap      r31, 4, r23
  SetIndex     r6, r12, r31
  Append       r7, r7, r31
L1:
  Index        r33, r6, r12
  Index        r34, r33, r19
  Append       r35, r34, r9
  SetIndex     r33, r19, r35
  Index        r36, r33, r21
  Const        r37, 1
  AddInt       r38, r36, r37
  SetIndex     r33, r21, r38
  AddInt       r5, r5, r37
  Jump         L2
L0:
  Move         r39, r22
  Len          r40, r7
L4:
  LessInt      r41, r39, r40
  JumpIfFalse  r41, L3
  Index        r43, r7, r39
  Append       r1, r1, r43
  AddInt       r39, r39, r37
  Jump         L4
L3:
  // var tmp = []
  Const        r46, []
  // for g in groups {
  IterPrep     r47, r1
  Len          r48, r47
  Const        r49, 0
L8:
  Less         r50, r49, r48
  JumpIfFalse  r50, L5
  Index        r43, r47, r49
  // var total = 0
  Move         r52, r22
  // for x in g.items {
  Index        r53, r43, r19
  IterPrep     r54, r53
  Len          r55, r54
  Const        r56, 0
L7:
  Less         r57, r56, r55
  JumpIfFalse  r57, L6
  Index        r59, r54, r56
  // total = total + x.val
  Const        r60, "val"
  Index        r61, r59, r60
  Add          r52, r52, r61
  // for x in g.items {
  Const        r63, 1
  Add          r56, r56, r63
  Jump         L7
L6:
  // tmp = append(tmp, {tag: g.key, total: total})
  Const        r65, "tag"
  Index        r66, r43, r17
  Const        r67, "total"
  Move         r68, r66
  MakeMap      r70, 2, r65
  Append       r46, r46, r70
  // for g in groups {
  Const        r72, 1
  Add          r49, r49, r72
  Jump         L8
L5:
  // let result = from r in tmp sort by r.tag select r
  Const        r74, []
  IterPrep     r75, r46
  Len          r76, r75
  Move         r77, r22
L10:
  LessInt      r78, r77, r76
  JumpIfFalse  r78, L9
  Index        r80, r75, r77
  Index        r82, r80, r2
  Move         r83, r80
  MakeList     r84, 2, r82
  Append       r74, r74, r84
  AddInt       r77, r77, r37
  Jump         L10
L9:
  Sort         r74, r74
  // print(result)
  Print        r74
  Return       r0
