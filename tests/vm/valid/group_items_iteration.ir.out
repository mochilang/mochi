func main (regs=88)
  // let data = [
  Const        r0, [{"tag": "a", "val": 1}, {"tag": "a", "val": 2}, {"tag": "b", "val": 3}]
  Move         r1, r0
  // let groups = from d in data group by d.tag into g select g
  Const        r2, []
  IterPrep     r3, r1
  Len          r4, r3
  Const        r5, 0
  MakeMap      r6, 0, r0
  Const        r7, []
L2:
  Less         r8, r5, r4
  JumpIfFalse  r8, L0
  Index        r9, r3, r5
  Move         r10, r9
  Const        r11, "tag"
  Index        r12, r10, r11
  Str          r13, r12
  In           r14, r13, r6
  JumpIfTrue   r14, L1
  Const        r15, []
  Const        r16, "__group__"
  Const        r17, true
  Const        r18, "key"
  Move         r19, r12
  Const        r20, "items"
  Move         r21, r15
  MakeMap      r22, 3, r16
  SetIndex     r6, r13, r22
  Append       r7, r7, r22
L1:
  Const        r24, "items"
  Index        r25, r6, r13
  Index        r26, r25, r24
  Append       r27, r26, r9
  SetIndex     r25, r24, r27
  Const        r28, 1
  Add          r5, r5, r28
  Jump         L2
L0:
  Const        r30, 0
  Len          r31, r7
L4:
  Less         r32, r30, r31
  JumpIfFalse  r32, L3
  Index        r34, r7, r30
  Append       r2, r2, r34
  Const        r36, 1
  Add          r30, r30, r36
  Jump         L4
L3:
  Move         r38, r2
  // var tmp = []
  Const        r40, []
  // for g in groups {
  IterPrep     r41, r38
  Len          r42, r41
  Const        r43, 0
L8:
  Less         r44, r43, r42
  JumpIfFalse  r44, L5
  Index        r34, r41, r43
  // var total = 0
  Const        r47, 0
  // for x in g.items {
  Const        r48, "items"
  Index        r49, r34, r48
  IterPrep     r50, r49
  Len          r51, r50
  Const        r52, 0
L7:
  Less         r53, r52, r51
  JumpIfFalse  r53, L6
  Index        r55, r50, r52
  // total = total + x.val
  Const        r56, "val"
  Index        r57, r55, r56
  Add          r47, r47, r57
  // for x in g.items {
  Const        r59, 1
  Add          r52, r52, r59
  Jump         L7
L6:
  // tmp = append(tmp, {tag: g.key, total: total})
  Const        r61, "tag"
  Const        r62, "key"
  Index        r63, r34, r62
  Const        r64, "total"
  MakeMap      r67, 2, r61
  Append       r40, r40, r67
  // for g in groups {
  Const        r69, 1
  Add          r43, r43, r69
  Jump         L8
L5:
  // let result = from r in tmp sort by r.tag select r
  Const        r71, []
  IterPrep     r72, r40
  Len          r73, r72
  Const        r74, 0
L10:
  Less         r75, r74, r73
  JumpIfFalse  r75, L9
  Index        r77, r72, r74
  Const        r78, "tag"
  Index        r80, r77, r78
  Move         r81, r77
  MakeList     r82, 2, r80
  Append       r71, r71, r82
  Const        r84, 1
  Add          r74, r74, r84
  Jump         L10
L9:
  Sort         r71, r71
  Move         r87, r71
  // print(result)
  Print        r87
  Return       r0
