func main (regs=90)
  // let data = [
  Const        r0, [{"tag": "a", "val": 1}, {"tag": "a", "val": 2}, {"tag": "b", "val": 3}]
  Move         r1, r0
  // let groups = from d in data group by d.tag into g select g
  Const        r2, []
  IterPrep     r3, r1
  Len          r4, r3
  Const        r5, 0
  MakeMap      r6, 0, r0
  Const        r7, []
L2:
  Less         r8, r5, r4
  JumpIfFalse  r8, L0
  Index        r9, r3, r5
  Move         r10, r9
  Const        r11, "tag"
  Index        r12, r10, r11
  Str          r13, r12
  In           r14, r13, r6
  JumpIfTrue   r14, L1
  Const        r15, []
  Const        r16, "__group__"
  Const        r17, true
  Const        r18, "key"
  Move         r19, r12
  Const        r20, "items"
  Move         r21, r15
  MakeMap      r22, 3, r16
  SetIndex     r6, r13, r22
  Append       r23, r7, r22
  Move         r7, r23
L1:
  Const        r24, "items"
  Index        r25, r6, r13
  Index        r26, r25, r24
  Append       r27, r26, r9
  SetIndex     r25, r24, r27
  Const        r28, 1
  Add          r29, r5, r28
  Move         r5, r29
  Jump         L2
L0:
  Const        r30, 0
  Len          r31, r7
L4:
  Less         r32, r30, r31
  JumpIfFalse  r32, L3
  Index        r33, r7, r30
  Append       r35, r2, r33
  Move         r2, r35
  Const        r36, 1
  Add          r37, r30, r36
  Move         r30, r37
  Jump         L4
L3:
  Move         r38, r2
  // var tmp = []
  Const        r40, []
  // for g in groups {
  IterPrep     r41, r38
  Len          r42, r41
  Const        r43, 0
L8:
  Less         r44, r43, r42
  JumpIfFalse  r44, L5
  Index        r45, r41, r43
  Move         r34, r45
  // var total = 0
  Const        r47, 0
  // for x in g.items {
  Const        r48, "items"
  Index        r49, r34, r48
  IterPrep     r50, r49
  Len          r51, r50
  Const        r52, 0
L7:
  Less         r53, r52, r51
  JumpIfFalse  r53, L6
  Index        r54, r50, r52
  Move         r55, r54
  // total = total + x.val
  Const        r56, "val"
  Index        r57, r55, r56
  Add          r58, r47, r57
  Move         r47, r58
  // for x in g.items {
  Const        r59, 1
  Add          r60, r52, r59
  Move         r52, r60
  Jump         L7
L6:
  // tmp = append(tmp, {tag: g.key, total: total})
  Const        r61, "tag"
  Const        r62, "key"
  Index        r63, r34, r62
  Const        r64, "total"
  Move         r65, r61
  Move         r66, r63
  Move         r67, r64
  Move         r68, r47
  MakeMap      r69, 2, r65
  Append       r70, r40, r69
  Move         r40, r70
  // for g in groups {
  Const        r71, 1
  Add          r72, r43, r71
  Move         r43, r72
  Jump         L8
L5:
  // let result = from r in tmp sort by r.tag select r
  Const        r73, []
  IterPrep     r74, r40
  Len          r75, r74
  Const        r76, 0
L10:
  Less         r77, r76, r75
  JumpIfFalse  r77, L9
  Index        r78, r74, r76
  Move         r79, r78
  Const        r80, "tag"
  Index        r81, r79, r80
  Move         r82, r81
  Move         r83, r79
  MakeList     r84, 2, r82
  Append       r85, r73, r84
  Move         r73, r85
  Const        r86, 1
  Add          r87, r76, r86
  Move         r76, r87
  Jump         L10
L9:
  Sort         r88, r73
  Move         r89, r88
  // print(result)
  Print        r89
  Return       r0
