func main (regs=79)
  // let data = [
  Const        r0, [{"tag": "a", "val": 1}, {"tag": "a", "val": 2}, {"tag": "b", "val": 3}]
  // let groups = from d in data group by d.tag into g select g
  Const        r1, []
  IterPrep     r2, r0
  Len          r3, r2
  Const        r4, 0
  MakeMap      r5, 0, r0
  Const        r6, []
L2:
  Less         r7, r4, r3
  JumpIfFalse  r7, L0
  Index        r8, r2, r4
  Move         r9, r8
  Const        r10, "tag"
  Index        r11, r9, r10
  Str          r12, r11
  In           r13, r12, r5
  JumpIfTrue   r13, L1
  Const        r14, []
  Const        r15, "__group__"
  Const        r16, true
  Const        r17, "key"
  Move         r18, r11
  Const        r19, "items"
  Move         r20, r14
  MakeMap      r21, 3, r15
  SetIndex     r5, r12, r21
  Append       r6, r6, r21
L1:
  Index        r23, r5, r12
  Index        r24, r23, r19
  Append       r25, r24, r8
  SetIndex     r23, r19, r25
  Const        r26, 1
  Add          r4, r4, r26
  Jump         L2
L0:
  Const        r29, 0
  Move         r28, r29
  Len          r30, r6
L4:
  Less         r31, r28, r30
  JumpIfFalse  r31, L3
  Index        r33, r6, r28
  Append       r1, r1, r33
  Add          r28, r28, r26
  Jump         L4
L3:
  // var tmp = []
  Const        r37, []
  // for g in groups {
  IterPrep     r38, r1
  Len          r39, r38
  Const        r40, 0
L8:
  Less         r41, r40, r39
  JumpIfFalse  r41, L5
  Index        r33, r38, r40
  // var total = 0
  Move         r43, r29
  // for x in g.items {
  Index        r44, r33, r19
  IterPrep     r45, r44
  Len          r46, r45
  Const        r47, 0
L7:
  Less         r48, r47, r46
  JumpIfFalse  r48, L6
  Index        r50, r45, r47
  // total = total + x.val
  Const        r51, "val"
  Index        r52, r50, r51
  Add          r43, r43, r52
  // for x in g.items {
  Const        r54, 1
  Add          r47, r47, r54
  Jump         L7
L6:
  // tmp = append(tmp, {tag: g.key, total: total})
  MakeMap      r60, 2, r10
  Append       r37, r37, r60
  // for g in groups {
  Const        r62, 1
  Add          r40, r40, r62
  Jump         L8
L5:
  // let result = from r in tmp sort by r.tag select r
  Const        r64, []
  IterPrep     r65, r37
  Len          r66, r65
  Const        r67, 0
L10:
  Less         r68, r67, r66
  JumpIfFalse  r68, L9
  Index        r70, r65, r67
  Index        r72, r70, r10
  Move         r73, r70
  MakeList     r74, 2, r72
  Append       r64, r64, r74
  Const        r76, 1
  Add          r67, r67, r76
  Jump         L10
L9:
  Sort         r64, r64
  // print(result)
  Print        r64
  Return       r0
