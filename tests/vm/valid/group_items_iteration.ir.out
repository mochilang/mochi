func main (regs=77)
  // let data = [
  Const        r0, [{"tag": "a", "val": 1}, {"tag": "a", "val": 2}, {"tag": "b", "val": 3}]
  // let groups = from d in data group by d.tag into g select g
  Const        r1, []
  Const        r2, "tag"
  IterPrep     r3, r0
  Len          r4, r3
  Const        r5, 0
  MakeMap      r6, 0, r0
  Const        r7, []
L2:
  LessInt      r8, r5, r4
  JumpIfFalse  r8, L0
  Index        r9, r3, r5
  Index        r11, r9, r2
  Str          r12, r11
  In           r13, r12, r6
  JumpIfTrue   r13, L1
  Const        r14, []
  Const        r15, "__group__"
  Const        r16, true
  Const        r17, "key"
  Move         r18, r11
  Const        r19, "items"
  Move         r20, r14
  MakeMap      r21, 3, r15
  SetIndex     r6, r12, r21
  Append       r7, r7, r21
L1:
  Index        r23, r6, r12
  Index        r24, r23, r19
  Append       r25, r24, r9
  SetIndex     r23, r19, r25
  Const        r26, 1
  AddInt       r5, r5, r26
  Jump         L2
L0:
  Const        r28, 0
  Move         r27, r28
  Len          r29, r7
L4:
  LessInt      r30, r27, r29
  JumpIfFalse  r30, L3
  Index        r32, r7, r27
  Append       r1, r1, r32
  AddInt       r27, r27, r26
  Jump         L4
L3:
  // var tmp = []
  Const        r35, []
  // for g in groups {
  IterPrep     r36, r1
  Len          r37, r36
  Const        r38, 0
L8:
  Less         r39, r38, r37
  JumpIfFalse  r39, L5
  Index        r32, r36, r38
  // var total = 0
  Move         r41, r28
  // for x in g.items {
  Index        r42, r32, r19
  IterPrep     r43, r42
  Len          r44, r43
  Const        r45, 0
L7:
  Less         r46, r45, r44
  JumpIfFalse  r46, L6
  Index        r48, r43, r45
  // total = total + x.val
  Const        r49, "val"
  Index        r50, r48, r49
  Add          r41, r41, r50
  // for x in g.items {
  Const        r52, 1
  Add          r45, r45, r52
  Jump         L7
L6:
  // tmp = append(tmp, {tag: g.key, total: total})
  MakeMap      r58, 2, r2
  Append       r35, r35, r58
  // for g in groups {
  Const        r60, 1
  Add          r38, r38, r60
  Jump         L8
L5:
  // let result = from r in tmp sort by r.tag select r
  Const        r62, []
  IterPrep     r63, r35
  Len          r64, r63
  Const        r65, 0
L10:
  Less         r66, r65, r64
  JumpIfFalse  r66, L9
  Index        r68, r63, r65
  Index        r70, r68, r2
  Move         r71, r68
  MakeList     r72, 2, r70
  Append       r62, r62, r72
  Const        r74, 1
  Add          r65, r65, r74
  Jump         L10
L9:
  Sort         r62, r62
  // print(result)
  Print        r62
  Return       r0
