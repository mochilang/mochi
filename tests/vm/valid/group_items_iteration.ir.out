func main (regs=18)
  // let data = [
  Const        r0, [{"tag": "a", "val": 1}, {"tag": "a", "val": 2}, {"tag": "b", "val": 3}]
L3:
  // let groups = from d in data group by d.tag into g select g
  Const        r1, []
  Const        r2, "tag"
L6:
  IterPrep     r3, r0
  Len          r4, r3
L7:
  Const        r5, 0
  MakeMap      r6, 0, r0
  Const        r7, []
L2:
  LessInt      r8, r5, r4
L1:
  JumpIfFalse  r8, L0
  Index        r4, r3, r5
  Index        r3, r4, r2
  Str          r9, r3
  In           r10, r9, r6
  JumpIfTrue   r10, L1
L4:
  Const        r10, []
  Const        r11, "__group__"
  Const        r12, true
  Const        r13, "key"
  Move         r14, r3
  Const        r3, "items"
  Move         r15, r10
  Const        r10, "count"
  Const        r16, 0
  Move         r17, r11
  Move         r11, r12
  Move         r12, r13
  Move         r13, r14
  Move         r14, r3
  Move         r3, r15
  Move         r15, r10
  Move         r10, r16
  MakeMap      r16, 4, r17
  SetIndex     r6, r9, r16
  Append       r7, r7, r16
  Const        r16, "items"
  Index        r10, r6, r9
  Index        r9, r10, r16
  Append       r6, r9, r4
  SetIndex     r10, r16, r6
  Const        r6, "count"
  Index        r9, r10, r6
  Const        r4, 1
  AddInt       r15, r9, r4
  SetIndex     r10, r6, r15
  AddInt       r5, r5, r4
  Jump         L2
L0:
  Const        r15, 0
  Move         r9, r15
  Len          r6, r7
  LessInt      r10, r9, r6
  JumpIfFalse  r10, L3
  Index        r10, r7, r9
  Append       r1, r1, r10
  AddInt       r9, r9, r4
  Jump         L1
  // var tmp = []
  Const        r7, []
  // for g in groups {
  IterPrep     r9, r1
  Len          r1, r9
  Const        r6, 0
  Less         r8, r6, r1
  JumpIfFalse  r8, L4
  Index        r10, r9, r6
  // var total = 0
  Move         r8, r15
  // for x in g.items {
  Index        r1, r10, r16
  IterPrep     r16, r1
  Len          r1, r16
  Const        r9, 0
  Less         r5, r9, r1
  JumpIfFalse  r5, L5
  Index        r1, r16, r9
  // total = total + x.val
  Const        r16, "val"
  Index        r3, r1, r16
  Add          r8, r8, r3
  // for x in g.items {
  Const        r3, 1
  Add          r9, r9, r3
  Jump         L6
L5:
  // tmp = append(tmp, {tag: g.key, total: total})
  Const        r3, "tag"
  Const        r9, "key"
  Index        r16, r10, r9
  Const        r9, "total"
  Move         r10, r3
  Move         r3, r16
  Move         r16, r9
  Move         r9, r8
  MakeMap      r8, 2, r10
  Append       r7, r7, r8
  // for g in groups {
  Const        r8, 1
  Add          r6, r6, r8
  Jump         L7
  // let result = from r in tmp sort by r.tag select r
  Const        r8, []
  IterPrep     r5, r7
  Len          r7, r5
  Move         r6, r15
L9:
  LessInt      r15, r6, r7
  JumpIfFalse  r15, L8
  Index        r15, r5, r6
  Index        r5, r15, r2
  Move         r2, r15
  MakeList     r15, 2, r5
  Append       r8, r8, r15
  AddInt       r6, r6, r4
  Jump         L9
L8:
  Sort         r8, r8
  // print(result)
  Print        r8
  Return       r0
