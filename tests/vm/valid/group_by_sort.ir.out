func main (regs=52)
  // let items = [
  Const        r0, [{"cat": "a", "val": 3}, {"cat": "a", "val": 1}, {"cat": "b", "val": 5}, {"cat": "b", "val": 2}]
  // from i in items
  Const        r1, []
  // total: sum(from x in g select x.val)
  Const        r2, "val"
  // group by i.cat into g
  Const        r3, "cat"
  // cat: g.key,
  Const        r4, "key"
  // from i in items
  IterPrep     r6, r0
  Len          r7, r6
  Const        r8, 0
  MakeMap      r9, 0, r0
  Const        r10, []
L3:
  LessInt      r11, r8, r7
  JumpIfFalse  r11, L0
  Index        r12, r6, r8
  // group by i.cat into g
  Index        r14, r12, r3
  // total: sum(from x in g select x.val)
  Index        r15, r12, r2
  // sort by -sum(from x in g select x.val)
  Index        r16, r12, r2
  // group by i.cat into g
  Str          r17, r14
  In           r18, r17, r9
  JumpIfTrue   r18, L1
  // from i in items
  Const        r19, "__group__"
  Const        r20, true
  // group by i.cat into g
  Move         r21, r14
  // from i in items
  Const        r22, "__agg0"
  Const        r23, "__agg1"
  MakeMap      r24, 4, r19
  SetIndex     r9, r17, r24
  Append       r25, r10, r24
L1:
  Index        r26, r9, r17
  JumpIfFalse  r18, L2
  Index        r27, r26, r22
  Add          r28, r27, r15
  SetIndex     r26, r22, r28
  Index        r29, r26, r23
  Add          r30, r29, r16
  SetIndex     r26, r23, r30
L2:
  Const        r31, 1
  AddInt       r8, r8, r31
  Jump         L3
L0:
  Const        r32, 0
  Const        r34, 0
L5:
  LessInt      r35, r32, r34
  JumpIfFalse  r35, L4
  Index        r37, r10, r32
  // cat: g.key,
  Const        r38, "cat"
  Index        r39, r37, r4
  // total: sum(from x in g select x.val)
  Const        r40, "total"
  Index        r41, r37, r22
  // select {
  MakeMap      r44, 2, r38
  // sort by -sum(from x in g select x.val)
  Index        r45, r37, r23
  Neg          r47, r45
  // from i in items
  Move         r48, r44
  MakeList     r49, 2, r47
  Append       r1, r1, r49
  AddInt       r32, r32, r31
  Jump         L5
L4:
  // sort by -sum(from x in g select x.val)
  Sort         r1, r1
  // print(grouped)
  Print        r1
  Return       r0
