# Code generated by Mochi transpiler.
# Version 0.10.60, generated on 2025-08-08 09:18 +0700
import sys
sys.set_int_max_str_digits(0)
import os
if os.path.dirname(__file__) in sys.path:
    sys.path.remove(os.path.dirname(__file__))


def panic(msg):
    raise Exception(msg)


def _set_index(lst, idx, val):
    if lst is None:
        lst = []
    if idx >= len(lst):
        lst.extend([None] * (idx - len(lst) + 1))
    lst[idx] = val
    return lst

def normalize(value):
    if value > 255:
        return 255
    return value
def to_grayscale(blue, green, red):
    gs = 0.2126 * (float(red)) + 0.587 * (float(green)) + 0.114 * (float(blue))
    return int(gs)
def make_sepia(img, factor):
    pixel_h = len(img)
    pixel_v = len(img[0])
    i = 0
    while i < pixel_h:
        j = 0
        while j < pixel_v:
            pixel = img[i][j]
            grey = to_grayscale(pixel[0], pixel[1], pixel[2])
            img[i][j] = [normalize(grey), normalize(grey + factor), normalize(grey + 2 * factor)]
            j = j + 1
        i = i + 1
    return img
image = [[[10, 20, 30], [40, 50, 60]], [[70, 80, 90], [200, 150, 100]]]
sepia = make_sepia(image, 20)
print(str(sepia))
