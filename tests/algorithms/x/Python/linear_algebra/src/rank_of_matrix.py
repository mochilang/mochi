# Code generated by Mochi transpiler.
# Version 0.10.60, generated on 2025-08-08 11:13 +0700
import sys
sys.set_int_max_str_digits(0)
import os
if os.path.dirname(__file__) in sys.path:
    sys.path.remove(os.path.dirname(__file__))


def panic(msg):
    raise Exception(msg)


def _set_index(lst, idx, val):
    if lst is None:
        lst = []
    if idx >= len(lst):
        lst.extend([None] * (idx - len(lst) + 1))
    lst[idx] = val
    return lst

def rank_of_matrix(matrix):
    rows = len(matrix)
    if rows == 0:
        return 0
    columns = (len(matrix[0]) if len(matrix[0]) > 0 else 0)
    rank = (rows if rows < columns else columns)
    row = 0
    while row < rank:
        if matrix[row][row] != 0.0:
            col = row + 1
            while col < rows:
                mult = matrix[col][row] // matrix[row][row]
                i = row
                while i < columns:
                    matrix[col][i] = matrix[col][i] - mult * matrix[row][i]
                    i = i + 1
                col = col + 1
        else:
            reduce = True
            i = row + 1
            while i < rows:
                if matrix[i][row] != 0.0:
                    temp = matrix[row]
                    matrix[row] = matrix[i]
                    matrix[i] = temp
                    reduce = False
                    break
                i = i + 1
            if reduce:
                rank = rank - 1
                j = 0
                while j < rows:
                    matrix[j][row] = matrix[j][rank]
                    j = j + 1
            row = row - 1
        row = row + 1
    return rank
# test matrix1
matrix1 = [[1.0, 2.0, 3.0], [4.0, 5.0, 6.0], [7.0, 8.0, 9.0]]
assert rank_of_matrix(matrix1) == 2
# test matrix2
matrix2 = [[1.0, 0.0, 0.0], [0.0, 1.0, 0.0], [0.0, 0.0, 0.0]]
assert rank_of_matrix(matrix2) == 2
# test matrix3
matrix3 = [[1.0, 2.0, 3.0, 4.0], [5.0, 6.0, 7.0, 8.0], [9.0, 10.0, 11.0, 12.0]]
assert rank_of_matrix(matrix3) == 2
# test matrix4
matrix4 = [[2.0, 3.0, -1.0, -1.0], [1.0, -1.0, -2.0, 4.0], [3.0, 1.0, 3.0, -2.0], [6.0, 3.0, 0.0, -7.0]]
assert rank_of_matrix(matrix4) == 4
# test matrix5
matrix5 = [[2.0, 1.0, -3.0, -6.0], [3.0, -3.0, 1.0, 2.0], [1.0, 1.0, 1.0, 2.0]]
assert rank_of_matrix(matrix5) == 3
# test matrix6
matrix6 = [[2.0, -1.0, 0.0], [1.0, 3.0, 4.0], [4.0, 1.0, -3.0]]
assert rank_of_matrix(matrix6) == 3
# test matrix7
matrix7 = [[3.0, 2.0, 1.0], [-6.0, -4.0, -2.0]]
assert rank_of_matrix(matrix7) == 1
# test matrix_empty_cols
matrix8 = [[], []]
assert rank_of_matrix(matrix8) == 0
# test matrix_single
matrix9 = [[1.0]]
assert rank_of_matrix(matrix9) == 1
# test matrix_empty
matrix10 = [[]]
assert rank_of_matrix(matrix10) == 0
