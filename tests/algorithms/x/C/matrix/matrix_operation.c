// Generated by Mochi 0.10.32 on 2025-08-19 17:31 +0700
#include <stdio.h>
#include <string.h>
#include <stdlib.h>
#include <unistd.h>
#include <malloc.h>
#include <math.h>

size_t add_len;
size_t *add_lens;
size_t subtract_len;
size_t *subtract_lens;
size_t scalar_multiply_len;
size_t *scalar_multiply_lens;
size_t multiply_len;
size_t *multiply_lens;
size_t identity_len;
size_t *identity_lens;
size_t transpose_len;
size_t *transpose_lens;
size_t minor_len;
size_t *minor_lens;
size_t inverse_len;
size_t *inverse_lens;

size_t append_len;
static char* str_concat(const char *a, const char *b) {
    size_t len1 = strlen(a);
    size_t len2 = strlen(b);
    char *res = malloc(len1 + len2 + 1);
    memcpy(res, a, len1);
    memcpy(res + len1, b, len2);
    res[len1 + len2] = 0;
    return res;
}

static char* str_int(long long v) {
    char buf[32];
    snprintf(buf, sizeof(buf), "%lld", v);
    return strdup(buf);
}

static char* str_float(double v) {
    char buf[64];
    snprintf(buf, sizeof(buf), "%f", v);
    char *p = buf + strlen(buf) - 1;
    while (p > buf && *p == '0') *p-- = '\0';
    if (p > buf && *p == '.') *p = '\0';
    return strdup(buf);
}

static char* str_list_int(const long long *arr, size_t len) {
    size_t cap = len * 32 + 2;
    char *buf = malloc(cap);
    size_t pos = 0;
    buf[pos++] = '[';
    for (size_t i = 0; i < len; i++) {
        char tmp[32];
        snprintf(tmp, sizeof(tmp), "%lld", arr[i]);
        size_t n = strlen(tmp);
        if (pos + n + 2 >= cap) { cap = cap * 2 + n + 2; buf = realloc(buf, cap); }
        memcpy(buf + pos, tmp, n);
        pos += n;
        if (i + 1 < len) buf[pos++] = ' ';
    }
    buf[pos++] = ']';
    buf[pos] = 0;
    return buf;
}

static char* str_list_double(const double *arr, size_t len) {
    size_t cap = len * 32 + 2;
    char *buf = malloc(cap);
    size_t pos = 0;
    buf[pos++] = '[';
    for (size_t i = 0; i < len; i++) {
        char tmp[64];
        snprintf(tmp, sizeof(tmp), "%g", arr[i]);
        size_t n = strlen(tmp);
        if (pos + n + 2 >= cap) { cap = cap * 2 + n + 2; buf = realloc(buf, cap); }
        memcpy(buf + pos, tmp, n);
        pos += n;
        if (i + 1 < len) buf[pos++] = ' ';
    }
    buf[pos++] = ']';
    buf[pos] = 0;
    return buf;
}

static char* str_list_list_int(long long **arr, size_t len, const size_t lens[]) {
    size_t cap = 2;
    for (size_t i = 0; i < len; i++) cap += lens[i] * 32 + 3;
    char *buf = malloc(cap);
    size_t pos = 0;
    buf[pos++] = '[';
    for (size_t i = 0; i < len; i++) {
        char *inner = str_list_int(arr[i], lens[i]);
        size_t n = strlen(inner);
        if (pos + n + 2 >= cap) { cap = cap * 2 + n + 2; buf = realloc(buf, cap); }
        memcpy(buf + pos, inner, n);
        pos += n;
        free(inner);
        if (i + 1 < len) buf[pos++] = ' ';
    }
    buf[pos++] = ']';
    buf[pos] = 0;
    return buf;
}

static char* str_list_list_double(double **arr, size_t len, const size_t lens[]) {
    size_t cap = 2;
    for (size_t i = 0; i < len; i++) cap += lens[i] * 32 + 3;
    char *buf = malloc(cap);
    size_t pos = 0;
    buf[pos++] = '[';
    for (size_t i = 0; i < len; i++) {
        char *inner = str_list_double(arr[i], lens[i]);
        size_t n = strlen(inner);
        if (pos + n + 2 >= cap) { cap = cap * 2 + n + 2; buf = realloc(buf, cap); }
        memcpy(buf + pos, inner, n);
        pos += n;
        free(inner);
        if (i + 1 < len) buf[pos++] = ' ';
    }
    buf[pos++] = ']';
    buf[pos] = 0;
    return buf;
}

static double* list_append_double(double *arr, size_t *len, double val) {
    arr = realloc(arr, (*len + 1) * sizeof(double));
    arr[*len] = val;
    (*len)++;
    return arr;
}

static long long** list_append_intptr(long long **arr, size_t *len, long long *val) {
    arr = realloc(arr, (*len + 1) * sizeof(long long*));
    arr[*len] = val;
    (*len)++;
    return arr;
}

static double** list_append_doubleptr(double **arr, size_t *len, double *val) {
    arr = realloc(arr, (*len + 1) * sizeof(double*));
    arr[*len] = val;
    (*len)++;
    return arr;
}

static size_t* list_append_szt(size_t *arr, size_t *len, size_t val) {
    arr = realloc(arr, (*len + 1) * sizeof(size_t));
    arr[*len] = val;
    (*len)++;
    return arr;
}

#include <time.h>
static int seeded_now = 0;
static long long now_seed = 0;
static long long _now(void) {
    if (!seeded_now) {
        const char *s = getenv("MOCHI_NOW_SEED");
        if (s && *s) {
            now_seed = atoll(s);
            seeded_now = 1;
        }
    }
    if (seeded_now) {
        now_seed = (now_seed * 1664525 + 1013904223) % 2147483647;
        return now_seed;
    }
    struct timespec ts;
    clock_gettime(CLOCK_REALTIME, &ts);
    return (long long)(ts.tv_sec * 1000000000LL + ts.tv_nsec);
}

static long long _mem(void) {
    long long size = 0, rss = 0;
    FILE *f = fopen("/proc/self/statm", "r");
    if (f) {
        if (fscanf(f, "%lld %lld", &size, &rss) != 2) rss = 0;
        fclose(f);
    }
    return rss * (long long)sysconf(_SC_PAGESIZE);
}

static void panic(const char *msg) {
    fputs(msg, stderr);
    fputc('\n', stderr);
    exit(1);
}

double * * add(double * * * matrices, size_t matrices_len, size_t* matrices_lens, size_t matrices_lens_len);
double * * subtract(double * * a, size_t a_len, size_t* a_lens, size_t a_lens_len, double * * b, size_t b_len, size_t* b_lens, size_t b_lens_len);
double * * scalar_multiply(double * * matrix, size_t matrix_len, size_t* matrix_lens, size_t matrix_lens_len, double n);
double * * multiply(double * * a, size_t a_len, size_t* a_lens, size_t a_lens_len, double * * b, size_t b_len, size_t* b_lens, size_t b_lens_len);
double * * identity(long long n);
double * * transpose(double * * matrix, size_t matrix_len, size_t* matrix_lens, size_t matrix_lens_len);
double * * minor(double * * matrix, size_t matrix_len, size_t* matrix_lens, size_t matrix_lens_len, long long row, long long column);
double determinant(double * * matrix, size_t matrix_len, size_t* matrix_lens, size_t matrix_lens_len);
double * * inverse(double * * matrix, size_t matrix_len, size_t* matrix_lens, size_t matrix_lens_len);
void user_main();
int main(void);

double * * add(double * * * matrices, size_t matrices_len, size_t* matrices_lens, size_t matrices_lens_len) {
    long long rows = matrices_lens[(int)(0LL)];
    long long cols = 0;
    long long r = 0LL;
    double **result = NULL;
    size_t result_len = 0;
    size_t *result_lens = NULL;
    size_t result_lens_len = 0;
    while (r < rows) {
        double *row = NULL;
        size_t row_len = 0;
        long long c = 0LL;
        while (c < cols) {
            double sum = 0.0;
            long long m = 0LL;
            while (m < matrices_len) {
                sum = sum + matrices[(int)({long long _mochi_idx = m; _mochi_idx < 0 ? matrices_len + _mochi_idx : _mochi_idx;})][(int)({long long _mochi_idx = r; _mochi_idx < 0 ? matrices_lens[(int)(m)] + _mochi_idx : _mochi_idx;})][(int)({long long _mochi_idx = c; _mochi_idx < 0 ? 0 + _mochi_idx : _mochi_idx;})];
                m = m + 1LL;
            }
            row = list_append_double(row, &row_len, sum);
            c = c + 1LL;
        }
        result = list_append_doubleptr(result, &result_len, row);
        result_lens = list_append_szt(result_lens, &result_lens_len, row_len);
        r = r + 1LL;
    }
    return add_lens = result_lens, add_len = result_len, result;
}

double * * subtract(double * * a, size_t a_len, size_t* a_lens, size_t a_lens_len, double * * b, size_t b_len, size_t* b_lens, size_t b_lens_len) {
    long long rows = a_len;
    long long cols = a_lens[(int)(0LL)];
    long long r = 0LL;
    double **result = NULL;
    size_t result_len = 0;
    size_t *result_lens = NULL;
    size_t result_lens_len = 0;
    while (r < rows) {
        double *row = NULL;
        size_t row_len = 0;
        long long c = 0LL;
        while (c < cols) {
            row = list_append_double(row, &row_len, a[(int)({long long _mochi_idx = r; _mochi_idx < 0 ? a_len + _mochi_idx : _mochi_idx;})][(int)({long long _mochi_idx = c; _mochi_idx < 0 ? a_lens[(int)(r)] + _mochi_idx : _mochi_idx;})] - b[(int)({long long _mochi_idx = r; _mochi_idx < 0 ? b_len + _mochi_idx : _mochi_idx;})][(int)({long long _mochi_idx = c; _mochi_idx < 0 ? b_lens[(int)(r)] + _mochi_idx : _mochi_idx;})]);
            c = c + 1LL;
        }
        result = list_append_doubleptr(result, &result_len, row);
        result_lens = list_append_szt(result_lens, &result_lens_len, row_len);
        r = r + 1LL;
    }
    return subtract_lens = result_lens, subtract_len = result_len, result;
}

double * * scalar_multiply(double * * matrix, size_t matrix_len, size_t* matrix_lens, size_t matrix_lens_len, double n) {
    double **result = NULL;
    size_t result_len = 0;
    size_t *result_lens = NULL;
    size_t result_lens_len = 0;
    long long i = 0LL;
    while (i < matrix_len) {
        double *row = NULL;
        size_t row_len = 0;
        long long j = 0LL;
        while (j < matrix_lens[(int)(i)]) {
            row = list_append_double(row, &row_len, matrix[(int)({long long _mochi_idx = i; _mochi_idx < 0 ? matrix_len + _mochi_idx : _mochi_idx;})][(int)({long long _mochi_idx = j; _mochi_idx < 0 ? matrix_lens[(int)(i)] + _mochi_idx : _mochi_idx;})] * n);
            j = j + 1LL;
        }
        result = list_append_doubleptr(result, &result_len, row);
        result_lens = list_append_szt(result_lens, &result_lens_len, row_len);
        i = i + 1LL;
    }
    return scalar_multiply_lens = result_lens, scalar_multiply_len = result_len, result;
}

double * * multiply(double * * a, size_t a_len, size_t* a_lens, size_t a_lens_len, double * * b, size_t b_len, size_t* b_lens, size_t b_lens_len) {
    long long rowsA = a_len;
    long long colsA = a_lens[(int)(0LL)];
    long long rowsB = b_len;
    long long colsB = b_lens[(int)(0LL)];
    double **result = NULL;
    size_t result_len = 0;
    size_t *result_lens = NULL;
    size_t result_lens_len = 0;
    long long i = 0LL;
    while (i < rowsA) {
        double *row = NULL;
        size_t row_len = 0;
        long long j = 0LL;
        while (j < colsB) {
            double sum = 0.0;
            long long k = 0LL;
            while (k < colsA) {
                sum = sum + (a[(int)({long long _mochi_idx = i; _mochi_idx < 0 ? a_len + _mochi_idx : _mochi_idx;})][(int)({long long _mochi_idx = k; _mochi_idx < 0 ? a_lens[(int)(i)] + _mochi_idx : _mochi_idx;})] * b[(int)({long long _mochi_idx = k; _mochi_idx < 0 ? b_len + _mochi_idx : _mochi_idx;})][(int)({long long _mochi_idx = j; _mochi_idx < 0 ? b_lens[(int)(k)] + _mochi_idx : _mochi_idx;})]);
                k = k + 1LL;
            }
            row = list_append_double(row, &row_len, sum);
            j = j + 1LL;
        }
        result = list_append_doubleptr(result, &result_len, row);
        result_lens = list_append_szt(result_lens, &result_lens_len, row_len);
        i = i + 1LL;
    }
    return multiply_lens = result_lens, multiply_len = result_len, result;
}

double * * identity(long long n) {
    double **result = NULL;
    size_t result_len = 0;
    size_t *result_lens = NULL;
    size_t result_lens_len = 0;
    long long i = 0LL;
    while (i < n) {
        double *row = NULL;
        size_t row_len = 0;
        long long j = 0LL;
        while (j < n) {
            if (i == j) {
                row = list_append_double(row, &row_len, 1.0);
            } else {
                row = list_append_double(row, &row_len, 0.0);
            }
            j = j + 1LL;
        }
        result = list_append_doubleptr(result, &result_len, row);
        result_lens = list_append_szt(result_lens, &result_lens_len, row_len);
        i = i + 1LL;
    }
    return identity_lens = result_lens, identity_len = result_len, result;
}

double * * transpose(double * * matrix, size_t matrix_len, size_t* matrix_lens, size_t matrix_lens_len) {
    long long rows = matrix_len;
    long long cols = matrix_lens[(int)(0LL)];
    double **result = NULL;
    size_t result_len = 0;
    size_t *result_lens = NULL;
    size_t result_lens_len = 0;
    long long c = 0LL;
    while (c < cols) {
        double *row = NULL;
        size_t row_len = 0;
        long long r = 0LL;
        while (r < rows) {
            row = list_append_double(row, &row_len, matrix[(int)({long long _mochi_idx = r; _mochi_idx < 0 ? matrix_len + _mochi_idx : _mochi_idx;})][(int)({long long _mochi_idx = c; _mochi_idx < 0 ? matrix_lens[(int)(r)] + _mochi_idx : _mochi_idx;})]);
            r = r + 1LL;
        }
        result = list_append_doubleptr(result, &result_len, row);
        result_lens = list_append_szt(result_lens, &result_lens_len, row_len);
        c = c + 1LL;
    }
    return transpose_lens = result_lens, transpose_len = result_len, result;
}

double * * minor(double * * matrix, size_t matrix_len, size_t* matrix_lens, size_t matrix_lens_len, long long row, long long column) {
    double **result = NULL;
    size_t result_len = 0;
    size_t *result_lens = NULL;
    size_t result_lens_len = 0;
    long long i = 0LL;
    while (i < matrix_len) {
        if (i != row) {
            double *new_row = NULL;
            size_t new_row_len = 0;
            long long j = 0LL;
            while (j < matrix_lens[(int)(i)]) {
                if (j != column) {
                    new_row = list_append_double(new_row, &new_row_len, matrix[(int)({long long _mochi_idx = i; _mochi_idx < 0 ? matrix_len + _mochi_idx : _mochi_idx;})][(int)({long long _mochi_idx = j; _mochi_idx < 0 ? matrix_lens[(int)(i)] + _mochi_idx : _mochi_idx;})]);
                }
                j = j + 1LL;
            }
            result = list_append_doubleptr(result, &result_len, new_row);
            result_lens = list_append_szt(result_lens, &result_lens_len, new_row_len);
        }
        i = i + 1LL;
    }
    return minor_lens = result_lens, minor_len = result_len, result;
}

double determinant(double * * matrix, size_t matrix_len, size_t* matrix_lens, size_t matrix_lens_len) {
    if (matrix_len == 1LL) {
        return matrix[(int)({long long _mochi_idx = 0LL; _mochi_idx < 0 ? matrix_len + _mochi_idx : _mochi_idx;})][(int)({long long _mochi_idx = 0LL; _mochi_idx < 0 ? matrix_lens[(int)(0LL)] + _mochi_idx : _mochi_idx;})];
    }
    double det = 0.0;
    long long c = 0LL;
    while (c < matrix_lens[(int)(0LL)]) {
        double **sub = minor(matrix, matrix_len, matrix_lens, matrix_len, 0LL, c);
        size_t sub_len = minor_len;
        size_t *sub_lens = minor_lens;
        size_t sub_lens_len = minor_len;
        long long sign;
        if ((c % 2LL) == 0LL) {
            sign = 1.0;
        } else {
            sign = -1.0;
        }
        det = det + ((matrix[(int)({long long _mochi_idx = 0LL; _mochi_idx < 0 ? matrix_len + _mochi_idx : _mochi_idx;})][(int)({long long _mochi_idx = c; _mochi_idx < 0 ? matrix_lens[(int)(0LL)] + _mochi_idx : _mochi_idx;})] * determinant(sub, sub_len, sub_lens, sub_len)) * sign);
        c = c + 1LL;
    }
    return det;
}

double * * inverse(double * * matrix, size_t matrix_len, size_t* matrix_lens, size_t matrix_lens_len) {
    double det = determinant(matrix, matrix_len, matrix_lens, matrix_len);
    if (det == 0.0) {
        {
            size_t *__tmp5_lens = malloc(0 * sizeof(size_t));
            double** __tmp5_data = malloc(0 * sizeof(double*));
            inverse_lens = __tmp5_lens;
            inverse_len = 0;
            return __tmp5_data;
        }
    }
    long long size = matrix_len;
    double **matrix_minor = NULL;
    size_t matrix_minor_len = 0;
    size_t *matrix_minor_lens = NULL;
    size_t matrix_minor_lens_len = 0;
    long long i = 0LL;
    while (i < size) {
        double *row = NULL;
        size_t row_len = 0;
        long long j = 0LL;
        while (j < size) {
            double **m = minor(matrix, matrix_len, matrix_lens, matrix_len, i, j);
            size_t m_len = minor_len;
            size_t *m_lens = minor_lens;
            size_t m_lens_len = minor_len;
            row = list_append_double(row, &row_len, determinant(m, m_len, m_lens, m_len));
            j = j + 1LL;
        }
        matrix_minor = list_append_doubleptr(matrix_minor, &matrix_minor_len, row);
        matrix_minor_lens = list_append_szt(matrix_minor_lens, &matrix_minor_lens_len, row_len);
        i = i + 1LL;
    }
    double **cofactors = NULL;
    size_t cofactors_len = 0;
    size_t *cofactors_lens = NULL;
    size_t cofactors_lens_len = 0;
    i = 0LL;
    while (i < size) {
        double *row = NULL;
        size_t row_len = 0;
        long long j = 0LL;
        while (j < size) {
            long long sign;
            if (((i + j) % 2LL) == 0LL) {
                sign = 1.0;
            } else {
                sign = -1.0;
            }
            row = list_append_double(row, &row_len, matrix_minor[(int)({long long _mochi_idx = i; _mochi_idx < 0 ? matrix_minor_len + _mochi_idx : _mochi_idx;})][(int)({long long _mochi_idx = j; _mochi_idx < 0 ? matrix_minor_lens[(int)(i)] + _mochi_idx : _mochi_idx;})] * sign);
            j = j + 1LL;
        }
        cofactors = list_append_doubleptr(cofactors, &cofactors_len, row);
        cofactors_lens = list_append_szt(cofactors_lens, &cofactors_lens_len, row_len);
        i = i + 1LL;
    }
    double **adjugate = transpose(cofactors, cofactors_len, cofactors_lens, cofactors_len);
    size_t adjugate_len = transpose_len;
    size_t *adjugate_lens = transpose_lens;
    size_t adjugate_lens_len = transpose_len;
    {
        double** __ret6 = scalar_multiply(adjugate, adjugate_len, adjugate_lens, adjugate_len, 1.0 / det);
        inverse_lens = scalar_multiply_lens;
inverse_len = scalar_multiply_len;
        return __ret6;
    }
}

void user_main() {
    double matrix_a_0[2] = {12.0, 10.0};
    double matrix_a_1[2] = {3.0, 9.0};
    double *matrix_a_init[2] = {matrix_a_0, matrix_a_1};
    double **matrix_a = matrix_a_init;
    size_t matrix_a_len = 2;
    size_t matrix_a_lens_init[2] = {2, 2};
    size_t *matrix_a_lens = matrix_a_lens_init;
    size_t matrix_a_lens_len = 2;
    double matrix_b_0[2] = {3.0, 4.0};
    double matrix_b_1[2] = {7.0, 4.0};
    double *matrix_b_init[2] = {matrix_b_0, matrix_b_1};
    double **matrix_b = matrix_b_init;
    size_t matrix_b_len = 2;
    size_t matrix_b_lens_init[2] = {2, 2};
    size_t *matrix_b_lens = matrix_b_lens_init;
    size_t matrix_b_lens_len = 2;
    double matrix_c_0[4] = {11.0, 12.0, 13.0, 14.0};
    double matrix_c_1[4] = {21.0, 22.0, 23.0, 24.0};
    double matrix_c_2[4] = {31.0, 32.0, 33.0, 34.0};
    double matrix_c_3[4] = {41.0, 42.0, 43.0, 44.0};
    double *matrix_c_init[4] = {matrix_c_0, matrix_c_1, matrix_c_2, matrix_c_3};
    double **matrix_c = matrix_c_init;
    size_t matrix_c_len = 4;
    size_t matrix_c_lens_init[4] = {4, 4, 4, 4};
    size_t *matrix_c_lens = matrix_c_lens_init;
    size_t matrix_c_lens_len = 4;
    long long matrix_d_0[3] = {3.0, 0.0, 2.0};
    long long matrix_d_1[3] = {2.0, 0.0, -2.0};
    long long matrix_d_2[3] = {0.0, 1.0, 1.0};
    long long *matrix_d_init[3] = {matrix_d_0, matrix_d_1, matrix_d_2};
    long long **matrix_d = matrix_d_init;
    size_t matrix_d_len = 3;
    size_t matrix_d_lens_init[3] = {3, 3, 3};
    size_t *matrix_d_lens = matrix_d_lens_init;
    size_t matrix_d_lens_len = 3;
    puts(str_concat(str_concat("Add Operation, add(matrix_a, matrix_b) = ", ({double **__tmp7 = add(({double*** tmp = malloc(2 * sizeof(double**)); tmp[0] = matrix_a; tmp[1] = matrix_b; tmp;}), 2, ({size_t *tmp = malloc(2 * sizeof(size_t)); tmp[0] = 0; tmp[1] = 0; tmp;}), 2); char *__res = str_list_list_double(__tmp7, add_len, add_lens); __res;})), " \n"));
    puts(str_concat(str_concat("Multiply Operation, multiply(matrix_a, matrix_b) = ", ({double **__tmp8 = multiply(matrix_a, matrix_a_len, matrix_a_lens, matrix_a_len, matrix_b, matrix_b_len, matrix_b_lens, matrix_b_len); char *__res = str_list_list_double(__tmp8, multiply_len, multiply_lens); __res;})), " \n"));
    puts(str_concat(str_concat("Identity: ", ({double **__tmp9 = identity(5LL); char *__res = str_list_list_double(__tmp9, identity_len, identity_lens); __res;})), "\n"));
    puts(str_concat(str_concat(str_concat(str_concat("Minor of ", str_list_list_double(matrix_c, matrix_c_len, matrix_c_lens)), " = "), ({double **__tmp10 = minor(matrix_c, matrix_c_len, matrix_c_lens, matrix_c_len, 1LL, 2LL); char *__res = str_list_list_double(__tmp10, minor_len, minor_lens); __res;})), " \n"));
    puts(str_concat(str_concat(str_concat(str_concat("Determinant of ", str_list_list_double(matrix_b, matrix_b_len, matrix_b_lens)), " = "), str_float(determinant(matrix_b, matrix_b_len, matrix_b_lens, matrix_b_len))), " \n"));
    puts(str_concat(str_concat(str_concat(str_concat("Inverse of ", str_list_list_int(matrix_d, matrix_d_len, matrix_d_lens)), " = "), ({double **__tmp11 = inverse(matrix_d, matrix_d_len, matrix_d_lens, matrix_d_len); char *__res = str_list_list_double(__tmp11, inverse_len, inverse_lens); __res;})), "\n"));
}

int main(void) {
    {
        long long __start = _now();
        user_main();
        long long __end = _now();
        long long __dur_us = (__end - __start) / 1000;
        long long __mem_bytes = _mem();
        printf("{\n  \"duration_us\": %-lld,\n  \"memory_bytes\": %-lld,\n  \"name\": \"main\"\n}\n", __dur_us, __mem_bytes);
    }
    return 0;
}
