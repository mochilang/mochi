// Generated by Mochi 0.10.32 on 2025-08-19 17:31 +0700
#include <stdio.h>
#include <string.h>
#include <stdlib.h>
#include <unistd.h>
#include <malloc.h>


size_t append_len;
static long long** list_append_intptr(long long **arr, size_t *len, long long *val) {
    arr = realloc(arr, (*len + 1) * sizeof(long long*));
    arr[*len] = val;
    (*len)++;
    return arr;
}

static size_t* list_append_szt(size_t *arr, size_t *len, size_t val) {
    arr = realloc(arr, (*len + 1) * sizeof(size_t));
    arr[*len] = val;
    (*len)++;
    return arr;
}

#include <time.h>
static int seeded_now = 0;
static long long now_seed = 0;
static long long _now(void) {
    if (!seeded_now) {
        const char *s = getenv("MOCHI_NOW_SEED");
        if (s && *s) {
            now_seed = atoll(s);
            seeded_now = 1;
        }
    }
    if (seeded_now) {
        now_seed = (now_seed * 1664525 + 1013904223) % 2147483647;
        return now_seed;
    }
    struct timespec ts;
    clock_gettime(CLOCK_REALTIME, &ts);
    return (long long)(ts.tv_sec * 1000000000LL + ts.tv_nsec);
}

static long long _mem(void) {
    long long size = 0, rss = 0;
    FILE *f = fopen("/proc/self/statm", "r");
    if (f) {
        if (fscanf(f, "%lld %lld", &size, &rss) != 2) rss = 0;
        fclose(f);
    }
    return rss * (long long)sysconf(_SC_PAGESIZE);
}

static void panic(const char *msg) {
    fputs(msg, stderr);
    fputc('\n', stderr);
    exit(1);
}

static long long* list_append_long_long(long long *arr, size_t *len, long long val) {
    arr = realloc(arr, (*len + 1) * sizeof(long long));
    arr[*len] = val;
    (*len)++;
    return arr;
}

long long sample_0[2] = {1LL, 1LL};
long long sample_1[2] = {1LL, 1LL};
long long *sample_init[2] = {sample_0, sample_1};
long long **sample = sample_init;
size_t sample_len = 2;
size_t sample_lens_init[2] = {2, 2};
size_t *sample_lens = sample_lens_init;
size_t sample_lens_len = 2;

long long update_area_of_max_square(long long row, long long col, long long rows, long long cols, long long * * mat, size_t mat_len, size_t* mat_lens, size_t mat_lens_len, long long * largest_square_area, size_t largest_square_area_len);
long long largest_square_area_in_matrix_top_down(long long rows, long long cols, long long * * mat, size_t mat_len, size_t* mat_lens, size_t mat_lens_len);
long long update_area_of_max_square_with_dp(long long row, long long col, long long rows, long long cols, long long * * mat, size_t mat_len, size_t* mat_lens, size_t mat_lens_len, long long * * dp_array, size_t dp_array_len, size_t* dp_array_lens, size_t dp_array_lens_len, long long * largest_square_area, size_t largest_square_area_len);
long long largest_square_area_in_matrix_top_down_with_dp(long long rows, long long cols, long long * * mat, size_t mat_len, size_t* mat_lens, size_t mat_lens_len);
long long largest_square_area_in_matrix_bottom_up(long long rows, long long cols, long long * * mat, size_t mat_len, size_t* mat_lens, size_t mat_lens_len);
long long largest_square_area_in_matrix_bottom_up_space_optimization(long long rows, long long cols, long long * * mat, size_t mat_len, size_t* mat_lens, size_t mat_lens_len);
int main(void);

long long update_area_of_max_square(long long row, long long col, long long rows, long long cols, long long * * mat, size_t mat_len, size_t* mat_lens, size_t mat_lens_len, long long * largest_square_area, size_t largest_square_area_len) {
    if ((row >= rows) || (col >= cols)) {
        return 0LL;
    }
    long long right = update_area_of_max_square(row, col + 1LL, rows, cols, mat, mat_len, mat_lens, mat_len, largest_square_area, largest_square_area_len);
    long long diagonal = update_area_of_max_square(row + 1LL, col + 1LL, rows, cols, mat, mat_len, mat_lens, mat_len, largest_square_area, largest_square_area_len);
    long long down = update_area_of_max_square(row + 1LL, col, rows, cols, mat, mat_len, mat_lens, mat_len, largest_square_area, largest_square_area_len);
    if (mat[(int)({long long _mochi_idx = row; _mochi_idx < 0 ? mat_len + _mochi_idx : _mochi_idx;})][(int)({long long _mochi_idx = col; _mochi_idx < 0 ? mat_lens[(int)(row)] + _mochi_idx : _mochi_idx;})] == 1LL) {
        long long sub = 0;
        if (sub > largest_square_area[(int)({long long _mochi_idx = 0LL; _mochi_idx < 0 ? largest_square_area_len + _mochi_idx : _mochi_idx;})]) {
            largest_square_area[(int)(0LL)] = sub;
        }
        return sub;
    } else {
        return 0LL;
    }
}

long long largest_square_area_in_matrix_top_down(long long rows, long long cols, long long * * mat, size_t mat_len, size_t* mat_lens, size_t mat_lens_len) {
    long long *largest = NULL;
    size_t largest_len = 0;
    largest = list_append_long_long(largest, &largest_len, 0LL);
    update_area_of_max_square(0LL, 0LL, rows, cols, mat, mat_len, mat_lens, mat_len, largest, largest_len);
    return largest[(int)({long long _mochi_idx = 0LL; _mochi_idx < 0 ? largest_len + _mochi_idx : _mochi_idx;})];
}

long long update_area_of_max_square_with_dp(long long row, long long col, long long rows, long long cols, long long * * mat, size_t mat_len, size_t* mat_lens, size_t mat_lens_len, long long * * dp_array, size_t dp_array_len, size_t* dp_array_lens, size_t dp_array_lens_len, long long * largest_square_area, size_t largest_square_area_len) {
    if ((row >= rows) || (col >= cols)) {
        return 0LL;
    }
    if (dp_array[(int)({long long _mochi_idx = row; _mochi_idx < 0 ? dp_array_len + _mochi_idx : _mochi_idx;})][(int)({long long _mochi_idx = col; _mochi_idx < 0 ? dp_array_lens[(int)(row)] + _mochi_idx : _mochi_idx;})] != -1.0) {
        return dp_array[(int)({long long _mochi_idx = row; _mochi_idx < 0 ? dp_array_len + _mochi_idx : _mochi_idx;})][(int)({long long _mochi_idx = col; _mochi_idx < 0 ? dp_array_lens[(int)(row)] + _mochi_idx : _mochi_idx;})];
    }
    long long right = update_area_of_max_square_with_dp(row, col + 1LL, rows, cols, mat, mat_len, mat_lens, mat_len, dp_array, dp_array_len, dp_array_lens, dp_array_len, largest_square_area, largest_square_area_len);
    long long diagonal = update_area_of_max_square_with_dp(row + 1LL, col + 1LL, rows, cols, mat, mat_len, mat_lens, mat_len, dp_array, dp_array_len, dp_array_lens, dp_array_len, largest_square_area, largest_square_area_len);
    long long down = update_area_of_max_square_with_dp(row + 1LL, col, rows, cols, mat, mat_len, mat_lens, mat_len, dp_array, dp_array_len, dp_array_lens, dp_array_len, largest_square_area, largest_square_area_len);
    if (mat[(int)({long long _mochi_idx = row; _mochi_idx < 0 ? mat_len + _mochi_idx : _mochi_idx;})][(int)({long long _mochi_idx = col; _mochi_idx < 0 ? mat_lens[(int)(row)] + _mochi_idx : _mochi_idx;})] == 1LL) {
        long long sub = 0;
        if (sub > largest_square_area[(int)({long long _mochi_idx = 0LL; _mochi_idx < 0 ? largest_square_area_len + _mochi_idx : _mochi_idx;})]) {
            largest_square_area[(int)(0LL)] = sub;
        }
        dp_array[(int)(row)][(int)(col)] = sub;
        return sub;
    } else {
        dp_array[(int)(row)][(int)(col)] = 0LL;
        return 0LL;
    }
}

long long largest_square_area_in_matrix_top_down_with_dp(long long rows, long long cols, long long * * mat, size_t mat_len, size_t* mat_lens, size_t mat_lens_len) {
    long long *largest = NULL;
    size_t largest_len = 0;
    largest = list_append_long_long(largest, &largest_len, 0LL);
    long long **dp_array = NULL;
    size_t dp_array_len = 0;
    size_t *dp_array_lens = NULL;
    size_t dp_array_lens_len = 0;
    long long r = 0LL;
    while (r < rows) {
        long long *row_list = NULL;
        size_t row_list_len = 0;
        long long c = 0LL;
        while (c < cols) {
            row_list = list_append_long_long(row_list, &row_list_len, -1.0);
            c = c + 1LL;
        }
        dp_array = list_append_intptr(dp_array, &dp_array_len, row_list);
        dp_array_lens = list_append_szt(dp_array_lens, &dp_array_lens_len, row_list_len);
        r = r + 1LL;
    }
    update_area_of_max_square_with_dp(0LL, 0LL, rows, cols, mat, mat_len, mat_lens, mat_len, dp_array, dp_array_len, dp_array_lens, dp_array_len, largest, largest_len);
    return largest[(int)({long long _mochi_idx = 0LL; _mochi_idx < 0 ? largest_len + _mochi_idx : _mochi_idx;})];
}

long long largest_square_area_in_matrix_bottom_up(long long rows, long long cols, long long * * mat, size_t mat_len, size_t* mat_lens, size_t mat_lens_len) {
    long long **dp_array = NULL;
    size_t dp_array_len = 0;
    size_t *dp_array_lens = NULL;
    size_t dp_array_lens_len = 0;
    long long r = 0LL;
    while (r <= rows) {
        long long *row_list = NULL;
        size_t row_list_len = 0;
        long long c = 0LL;
        while (c <= cols) {
            row_list = list_append_long_long(row_list, &row_list_len, 0LL);
            c = c + 1LL;
        }
        dp_array = list_append_intptr(dp_array, &dp_array_len, row_list);
        dp_array_lens = list_append_szt(dp_array_lens, &dp_array_lens_len, row_list_len);
        r = r + 1LL;
    }
    long long largest = 0LL;
    long long row = rows - 1LL;
    while (row >= 0LL) {
        long long col = cols - 1LL;
        while (col >= 0LL) {
            long long right = dp_array[(int)({long long _mochi_idx = row; _mochi_idx < 0 ? dp_array_len + _mochi_idx : _mochi_idx;})][(int)({long long _mochi_idx = col + 1LL; _mochi_idx < 0 ? dp_array_lens[(int)(row)] + _mochi_idx : _mochi_idx;})];
            long long diagonal = dp_array[(int)({long long _mochi_idx = row + 1LL; _mochi_idx < 0 ? dp_array_len + _mochi_idx : _mochi_idx;})][(int)({long long _mochi_idx = col + 1LL; _mochi_idx < 0 ? dp_array_lens[(int)(row + 1LL)] + _mochi_idx : _mochi_idx;})];
            long long bottom = dp_array[(int)({long long _mochi_idx = row + 1LL; _mochi_idx < 0 ? dp_array_len + _mochi_idx : _mochi_idx;})][(int)({long long _mochi_idx = col; _mochi_idx < 0 ? dp_array_lens[(int)(row + 1LL)] + _mochi_idx : _mochi_idx;})];
            if (mat[(int)({long long _mochi_idx = row; _mochi_idx < 0 ? mat_len + _mochi_idx : _mochi_idx;})][(int)({long long _mochi_idx = col; _mochi_idx < 0 ? mat_lens[(int)(row)] + _mochi_idx : _mochi_idx;})] == 1LL) {
                long long value = 0;
                dp_array[(int)(row)][(int)(col)] = value;
                if (value > largest) {
                    largest = value;
                }
            } else {
                dp_array[(int)(row)][(int)(col)] = 0LL;
            }
            col = col - 1LL;
        }
        row = row - 1LL;
    }
    return largest;
}

long long largest_square_area_in_matrix_bottom_up_space_optimization(long long rows, long long cols, long long * * mat, size_t mat_len, size_t* mat_lens, size_t mat_lens_len) {
    long long *current_row = NULL;
    size_t current_row_len = 0;
    long long i = 0LL;
    while (i <= cols) {
        current_row = list_append_long_long(current_row, &current_row_len, 0LL);
        i = i + 1LL;
    }
    long long *next_row = NULL;
    size_t next_row_len = 0;
    long long j = 0LL;
    while (j <= cols) {
        next_row = list_append_long_long(next_row, &next_row_len, 0LL);
        j = j + 1LL;
    }
    long long largest = 0LL;
    long long row = rows - 1LL;
    while (row >= 0LL) {
        long long col = cols - 1LL;
        while (col >= 0LL) {
            long long right = current_row[(int)({long long _mochi_idx = col + 1LL; _mochi_idx < 0 ? current_row_len + _mochi_idx : _mochi_idx;})];
            long long diagonal = next_row[(int)({long long _mochi_idx = col + 1LL; _mochi_idx < 0 ? next_row_len + _mochi_idx : _mochi_idx;})];
            long long bottom = next_row[(int)({long long _mochi_idx = col; _mochi_idx < 0 ? next_row_len + _mochi_idx : _mochi_idx;})];
            if (mat[(int)({long long _mochi_idx = row; _mochi_idx < 0 ? mat_len + _mochi_idx : _mochi_idx;})][(int)({long long _mochi_idx = col; _mochi_idx < 0 ? mat_lens[(int)(row)] + _mochi_idx : _mochi_idx;})] == 1LL) {
                long long value = 0;
                current_row[(int)(col)] = value;
                if (value > largest) {
                    largest = value;
                }
            } else {
                current_row[(int)(col)] = 0LL;
            }
            col = col - 1LL;
        }
        next_row = current_row;
        next_row_len = current_row_len;
        current_row = NULL;
        current_row_len = 0;
        long long t = 0LL;
        while (t <= cols) {
            current_row = list_append_long_long(current_row, &current_row_len, 0LL);
            t = t + 1LL;
        }
        row = row - 1LL;
    }
    return largest;
}

int main(void) {
    {
        long long __start = _now();
        printf("%d\n", largest_square_area_in_matrix_top_down(2LL, 2LL, sample, sample_len, sample_lens, sample_len));
        printf("%d\n", largest_square_area_in_matrix_top_down_with_dp(2LL, 2LL, sample, sample_len, sample_lens, sample_len));
        printf("%d\n", largest_square_area_in_matrix_bottom_up(2LL, 2LL, sample, sample_len, sample_lens, sample_len));
        printf("%d\n", largest_square_area_in_matrix_bottom_up_space_optimization(2LL, 2LL, sample, sample_len, sample_lens, sample_len));
        long long __end = _now();
        long long __dur_us = (__end - __start) / 1000;
        long long __mem_bytes = _mem();
        printf("{\n  \"duration_us\": %-lld,\n  \"memory_bytes\": %-lld,\n  \"name\": \"main\"\n}\n", __dur_us, __mem_bytes);
    }
    return 0;
}
