// Generated by Mochi 0.10.32 on 2025-08-11 17:23 +0700
#include <stdio.h>
#include <string.h>
#include <stdlib.h>
#include <unistd.h>
#include <malloc.h>

size_t binary_search_insertion_from_len;
size_t binary_search_insertion_len;
size_t merge_len;
size_t *merge_lens;
size_t sortlist_2d_len;
size_t *sortlist_2d_lens;
size_t merge_insertion_sort_len;

static char* str_int(long long v) {
    char buf[32];
    snprintf(buf, sizeof(buf), "%lld", v);
    return strdup(buf);
}

static char* str_list_int(const long long *arr, size_t len) {
    size_t cap = len * 32 + 2;
    char *buf = malloc(cap);
    size_t pos = 0;
    buf[pos++] = '[';
    for (size_t i = 0; i < len; i++) {
        char tmp[32];
        snprintf(tmp, sizeof(tmp), "%d", arr[i]);
        size_t n = strlen(tmp);
        if (pos + n + 2 >= cap) { cap = cap * 2 + n + 2; buf = realloc(buf, cap); }
        memcpy(buf + pos, tmp, n);
        pos += n;
        if (i + 1 < len) buf[pos++] = ' ';
    }
    buf[pos++] = ']';
    buf[pos] = 0;
    return buf;
}

static long long** list_append_intptr(long long **arr, size_t *len, long long *val) {
    arr = realloc(arr, (*len + 1) * sizeof(long long*));
    arr[*len] = val;
    (*len)++;
    return arr;
}

static size_t* list_append_szt(size_t *arr, size_t *len, size_t val) {
    arr = realloc(arr, (*len + 1) * sizeof(size_t));
    arr[*len] = val;
    (*len)++;
    return arr;
}

#include <time.h>
#include <stdlib.h>
static int seeded_now = 0;
static long long now_seed = 0;
static long long _now(void) {
    if (!seeded_now) {
        const char *s = getenv("MOCHI_NOW_SEED");
        if (s && *s) {
            now_seed = atoll(s);
            seeded_now = 1;
        }
    }
    if (seeded_now) {
        now_seed = (now_seed * 1664525 + 1013904223) % 2147483647;
        return now_seed;
    }
    struct timespec ts;
    clock_gettime(CLOCK_REALTIME, &ts);
    return (long long)(ts.tv_sec * 1000000000LL + ts.tv_nsec);
}

static long long _mem(void) {
    long long size = 0, rss = 0;
    FILE *f = fopen("/proc/self/statm", "r");
    if (f) {
        if (fscanf(f, "%lld %lld", &size, &rss) != 2) rss = 0;
        fclose(f);
    }
    return rss * (long long)sysconf(_SC_PAGESIZE);
}

static void panic(const char *msg) {
    fputs(msg, stderr);
    fputc('\n', stderr);
    exit(1);
}

static long long* list_append_long_long(long long *arr, size_t *len, long long val) {
    arr = realloc(arr, (*len + 1) * sizeof(long long));
    arr[*len] = val;
    (*len)++;
    return arr;
}

static long long** list_append_long_longptr(long long **arr, size_t *len, long long *val) {
    arr = realloc(arr, (*len + 1) * sizeof(long long*));
    arr[*len] = val;
    (*len)++;
    return arr;
}

long long * binary_search_insertion_from(long long * sorted_list, size_t sorted_list_len, long long item, long long start);
long long * binary_search_insertion(long long * sorted_list, size_t sorted_list_len, long long item);
long long * * merge(long long * * left, size_t left_len, size_t* left_lens, size_t left_lens_len, long long * * right, size_t right_len, size_t* right_lens, size_t right_lens_len);
long long * * sortlist_2d(long long * * list_2d, size_t list_2d_len, size_t* list_2d_lens, size_t list_2d_lens_len);
long long * merge_insertion_sort(long long * collection, size_t collection_len);
void user_main();
int main(void);

long long * binary_search_insertion_from(long long * sorted_list, size_t sorted_list_len, long long item, long long start) {
    long long left = start;
    long long right = sorted_list_len - 1LL;
    while (left <= right) {
        long long middle = (left + right) / 2LL;
        if (left == right) {
            if (sorted_list[(int)({long long _mochi_idx = middle; _mochi_idx < 0 ? sorted_list_len + _mochi_idx : _mochi_idx;})] < item) {
                left = middle + 1LL;
            }
            break;
        } else {
            if (sorted_list[(int)({long long _mochi_idx = middle; _mochi_idx < 0 ? sorted_list_len + _mochi_idx : _mochi_idx;})] < item) {
                left = middle + 1LL;
            } else {
                right = middle - 1LL;
            }
        }
    }
    long long *result = NULL;
    size_t result_len = 0;
    long long i = 0LL;
    while (i < left) {
        result = list_append_long_long(result, &result_len, sorted_list[(int)({long long _mochi_idx = i; _mochi_idx < 0 ? sorted_list_len + _mochi_idx : _mochi_idx;})]);
        i = i + 1LL;
    }
    result = list_append_long_long(result, &result_len, item);
    while (i < sorted_list_len) {
        result = list_append_long_long(result, &result_len, sorted_list[(int)({long long _mochi_idx = i; _mochi_idx < 0 ? sorted_list_len + _mochi_idx : _mochi_idx;})]);
        i = i + 1LL;
    }
    return binary_search_insertion_from_len = result_len, result;
}

long long * binary_search_insertion(long long * sorted_list, size_t sorted_list_len, long long item) {
    {
        long long* __ret4 = binary_search_insertion_from(sorted_list, sorted_list_len, item, 0LL);
        binary_search_insertion_len = binary_search_insertion_from_len;
        return __ret4;
    }
}

long long * * merge(long long * * left, size_t left_len, size_t* left_lens, size_t left_lens_len, long long * * right, size_t right_len, size_t* right_lens, size_t right_lens_len) {
    long long **result = NULL;
    size_t result_len = 0;
    size_t *result_lens = NULL;
    size_t result_lens_len = 0;
    long long i = 0LL;
    long long j = 0LL;
    while ((i < left_len) && (j < right_len)) {
        if (left[(int)({long long _mochi_idx = i; _mochi_idx < 0 ? left_len + _mochi_idx : _mochi_idx;})][(int)({long long _mochi_idx = 0LL; _mochi_idx < 0 ? left_lens[i] + _mochi_idx : _mochi_idx;})] < right[(int)({long long _mochi_idx = j; _mochi_idx < 0 ? right_len + _mochi_idx : _mochi_idx;})][(int)({long long _mochi_idx = 0LL; _mochi_idx < 0 ? right_lens[j] + _mochi_idx : _mochi_idx;})]) {
            result = list_append_long_longptr(result, &result_len, left[(int)({long long _mochi_idx = i; _mochi_idx < 0 ? left_len + _mochi_idx : _mochi_idx;})]);
            result_lens = list_append_szt(result_lens, &result_lens_len, left_lens[i]);
            i = i + 1LL;
        } else {
            result = list_append_long_longptr(result, &result_len, right[(int)({long long _mochi_idx = j; _mochi_idx < 0 ? right_len + _mochi_idx : _mochi_idx;})]);
            result_lens = list_append_szt(result_lens, &result_lens_len, right_lens[j]);
            j = j + 1LL;
        }
    }
    while (i < left_len) {
        result = list_append_long_longptr(result, &result_len, left[(int)({long long _mochi_idx = i; _mochi_idx < 0 ? left_len + _mochi_idx : _mochi_idx;})]);
        result_lens = list_append_szt(result_lens, &result_lens_len, left_lens[i]);
        i = i + 1LL;
    }
    while (j < right_len) {
        result = list_append_long_longptr(result, &result_len, right[(int)({long long _mochi_idx = j; _mochi_idx < 0 ? right_len + _mochi_idx : _mochi_idx;})]);
        result_lens = list_append_szt(result_lens, &result_lens_len, right_lens[j]);
        j = j + 1LL;
    }
    return merge_lens = result_lens, merge_len = result_len, result;
}

long long * * sortlist_2d(long long * * list_2d, size_t list_2d_len, size_t* list_2d_lens, size_t list_2d_lens_len) {
    long long length = list_2d_len;
    if (length <= 1LL) {
        return sortlist_2d_lens = list_2d_lens, sortlist_2d_len = list_2d_len, list_2d;
    }
    long long middle = length / 2LL;
    long long **left = NULL;
    size_t left_len = 0;
    size_t *left_lens = NULL;
    size_t left_lens_len = 0;
    long long i = 0LL;
    while (i < middle) {
        left = list_append_long_longptr(left, &left_len, list_2d[(int)({long long _mochi_idx = i; _mochi_idx < 0 ? list_2d_len + _mochi_idx : _mochi_idx;})]);
        left_lens = list_append_szt(left_lens, &left_lens_len, list_2d_lens[i]);
        i = i + 1LL;
    }
    long long **right = NULL;
    size_t right_len = 0;
    size_t *right_lens = NULL;
    size_t right_lens_len = 0;
    long long j = middle;
    while (j < length) {
        right = list_append_long_longptr(right, &right_len, list_2d[(int)({long long _mochi_idx = j; _mochi_idx < 0 ? list_2d_len + _mochi_idx : _mochi_idx;})]);
        right_lens = list_append_szt(right_lens, &right_lens_len, list_2d_lens[j]);
        j = j + 1LL;
    }
    {
        long long** __ret5 = ({long long** __tmp6 = sortlist_2d(left, left_len, left_lens, left_len); merge(__tmp6, sortlist_2d_len, sortlist_2d_lens, sortlist_2d_len, sortlist_2d(right, right_len, right_lens, right_len), sortlist_2d_len, sortlist_2d_lens, sortlist_2d_len);});
        sortlist_2d_lens = merge_lens;
sortlist_2d_len = merge_len;
        return __ret5;
    }
}

long long * merge_insertion_sort(long long * collection, size_t collection_len) {
    if (collection_len <= 1LL) {
        return merge_insertion_sort_len = collection_len, collection;
    }
    long long **two_paired_list = NULL;
    size_t two_paired_list_len = 0;
    size_t *two_paired_list_lens = NULL;
    size_t two_paired_list_lens_len = 0;
    long long has_last_odd_item = 0LL;
    long long i = 0LL;
    while (i < collection_len) {
        if (i == (collection_len - 1LL)) {
            has_last_odd_item = 1LL;
        } else {
            long long a = collection[(int)({long long _mochi_idx = i; _mochi_idx < 0 ? collection_len + _mochi_idx : _mochi_idx;})];
            long long b = collection[(int)({long long _mochi_idx = i + 1LL; _mochi_idx < 0 ? collection_len + _mochi_idx : _mochi_idx;})];
            if (a < b) {
                two_paired_list = list_append_long_longptr(two_paired_list, &two_paired_list_len, ({long long *tmp = malloc(2 * sizeof(long long)); tmp[0] = a; tmp[1] = b; tmp;}));
                two_paired_list_lens = list_append_szt(two_paired_list_lens, &two_paired_list_lens_len, 2);
            } else {
                two_paired_list = list_append_long_longptr(two_paired_list, &two_paired_list_len, ({long long *tmp = malloc(2 * sizeof(long long)); tmp[0] = b; tmp[1] = a; tmp;}));
                two_paired_list_lens = list_append_szt(two_paired_list_lens, &two_paired_list_lens_len, 2);
            }
        }
        i = i + 2LL;
    }
    long long **sorted_list_2d = sortlist_2d(two_paired_list, two_paired_list_len, two_paired_list_lens, two_paired_list_len);
    size_t sorted_list_2d_len = sortlist_2d_len;
    size_t *sorted_list_2d_lens = sortlist_2d_lens;
    size_t sorted_list_2d_lens_len = sortlist_2d_len;
    long long *result = NULL;
    size_t result_len = 0;
    i = 0LL;
    while (i < sorted_list_2d_len) {
        result = list_append_long_long(result, &result_len, sorted_list_2d[(int)({long long _mochi_idx = i; _mochi_idx < 0 ? sorted_list_2d_len + _mochi_idx : _mochi_idx;})][(int)({long long _mochi_idx = 0LL; _mochi_idx < 0 ? sorted_list_2d_lens[i] + _mochi_idx : _mochi_idx;})]);
        i = i + 1LL;
    }
    result = list_append_long_long(result, &result_len, sorted_list_2d[(int)({long long _mochi_idx = sorted_list_2d_len - 1LL; _mochi_idx < 0 ? sorted_list_2d_len + _mochi_idx : _mochi_idx;})][(int)({long long _mochi_idx = 1LL; _mochi_idx < 0 ? sorted_list_2d_lens[sorted_list_2d_len - 1LL] + _mochi_idx : _mochi_idx;})]);
    if (has_last_odd_item) {
        result = binary_search_insertion(result, result_len, collection[(int)({long long _mochi_idx = collection_len - 1LL; _mochi_idx < 0 ? collection_len + _mochi_idx : _mochi_idx;})]);
        result_len = binary_search_insertion_len;
    }
    long long inserted_before = 0LL;
    long long idx = 0LL;
    while (idx < (sorted_list_2d_len - 1LL)) {
        if (has_last_odd_item && (result[(int)({long long _mochi_idx = idx; _mochi_idx < 0 ? result_len + _mochi_idx : _mochi_idx;})] == collection[(int)({long long _mochi_idx = collection_len - 1LL; _mochi_idx < 0 ? collection_len + _mochi_idx : _mochi_idx;})])) {
            inserted_before = 1LL;
        }
        long long pivot = sorted_list_2d[(int)({long long _mochi_idx = idx; _mochi_idx < 0 ? sorted_list_2d_len + _mochi_idx : _mochi_idx;})][(int)({long long _mochi_idx = 1LL; _mochi_idx < 0 ? sorted_list_2d_lens[idx] + _mochi_idx : _mochi_idx;})];
        if (inserted_before) {
            result = binary_search_insertion_from(result, result_len, pivot, idx + 2LL);
            result_len = binary_search_insertion_from_len;
        } else {
            result = binary_search_insertion_from(result, result_len, pivot, idx + 1LL);
            result_len = binary_search_insertion_from_len;
        }
        idx = idx + 1LL;
    }
    return merge_insertion_sort_len = result_len, result;
}

void user_main() {
    long long *example1 = NULL;
    size_t example1_len = 0;
    example1 = list_append_long_long(example1, &example1_len, 0LL);
    example1 = list_append_long_long(example1, &example1_len, 5LL);
    example1 = list_append_long_long(example1, &example1_len, 3LL);
    example1 = list_append_long_long(example1, &example1_len, 2LL);
    example1 = list_append_long_long(example1, &example1_len, 2LL);
    long long *example2 = NULL;
    size_t example2_len = 0;
    example2 = list_append_long_long(example2, &example2_len, 99LL);
    long long *example3 = NULL;
    size_t example3_len = 0;
    example3 = list_append_long_long(example3, &example3_len, -2LL);
    example3 = list_append_long_long(example3, &example3_len, -5LL);
    example3 = list_append_long_long(example3, &example3_len, -45LL);
    puts(({long long *__tmp7 = merge_insertion_sort(example1, example1_len); char *__res = str_list_int(__tmp7, merge_insertion_sort_len); __res;}));
    puts(({long long *__tmp8 = merge_insertion_sort(example2, example2_len); char *__res = str_list_int(__tmp8, merge_insertion_sort_len); __res;}));
    puts(({long long *__tmp9 = merge_insertion_sort(example3, example3_len); char *__res = str_list_int(__tmp9, merge_insertion_sort_len); __res;}));
}

int main(void) {
    {
        long long __start = _now();
        user_main();
        long long __end = _now();
        long long __dur_us = (__end - __start) / 1000;
        long long __mem_bytes = _mem();
        printf("{\n  \"duration_us\": %-lld,\n  \"memory_bytes\": %-lld,\n  \"name\": \"main\"\n}\n", __dur_us, __mem_bytes);
    }
    return 0;
}
