{
  "functions": [
    {
      "name": "main",
      "params": [],
      "ret": "void",
      "body": [
        "  let people: list\u003cPeople\u003e = [People(name: \"Alice\", age: 30, city: \"Paris\"), People(name: \"Bob\", age: 15, city: \"Hanoi\"), People(name: \"Charlie\", age: 65, city: \"Paris\"), People(name: \"Diana\", age: 45, city: \"Hanoi\"), People(name: \"Eve\", age: 70, city: \"Paris\"), People(name: \"Frank\", age: 22, city: \"Hanoi\")]",
        "  let stats: list\u003cS1\u003e = (() {",
        "  let groups = \u003cString, Map\u003cString, dynamic\u003e\u003e{}",
        "  for (var person in people) {",
        "    let key = person.city",
        "    let ks = key.toString()",
        "    let g = groups[ks]",
        "    if (g == null) {",
        "      let g = {'key': key, 'items': []}",
        "      groups[ks] = g",
        "    }",
        "    (g['items'] as List).add(person)",
        "  }",
        "  let _list = groups.values.toList()",
        "  let res = \u003cS1\u003e[]",
        "  for (var g in _list) {",
        "    res.add(S1(city: g[\"key\"], count: g[\"items\"].length, avg_age: [for (var p in g[\"items\"]) p.age].isEmpty ? 0 : ([for (var p in g[\"items\"]) p.age].reduce((a, b) =\u003e a + b) / [for (var p in g[\"items\"]) p.age].length)))",
        "  }",
        "  return res",
        "  })();",
        "  print(\"--- People grouped by city ---\")",
        "  for (var s in stats) {",
        "    print([s.city, \": count =\", s.count, \", avg_age =\", s.avg_age].join(\" \"))",
        "  }"
      ],
      "start": 16,
      "end": 41
    }
  ],
  "classes": [
    {
      "name": "S1",
      "fields": [
        {
          "name": "city",
          "type": "dynamic"
        },
        {
          "name": "count",
          "type": "int"
        },
        {
          "name": "avg_age",
          "type": "num"
        }
      ],
      "start": 2,
      "end": 7,
      "doc": "Generated by Mochi transpiler"
    },
    {
      "name": "People",
      "fields": [
        {
          "name": "name",
          "type": "String"
        },
        {
          "name": "age",
          "type": "int"
        },
        {
          "name": "city",
          "type": "String"
        }
      ],
      "start": 8,
      "end": 14
    }
  ]
}
