# Generated by Mochi transpiler v0.10.34 on 2025-07-21 23:34 +0700
ItemsItem = Struct.new(:cat, :val, keyword_init: true)
items = [ItemsItem.new(cat: "a", val: 3), ItemsItem.new(cat: "a", val: 1), ItemsItem.new(cat: "b", val: 5), ItemsItem.new(cat: "b", val: 2)]
Grouped = Struct.new(:cat, :total, keyword_init: true)
grouped = (begin
  groups = {}
  items.each do |i|
    k = i["cat"]
    groups[k] ||= []
    groups[k] << i
  end
    result = []
  groups.each do |k, items|
    g = { "key" => k, "items" => items }
    result << Grouped.new(cat: g["key"], total: (begin
      _res = []
      g["items"].each do |x|
        _res << x["val"]
      end
    _res
  end).sum)
end
result
end)
puts(("[" + (grouped).map{ |x| if x.is_a?(String) then '\'' + x + '\'' elsif x.respond_to?(:to_h) then '{' + x.to_h.map{ |k,v| "'#{k}': #{v.is_a?(String) ? '\'' + v + '\'' : v.to_s}" }.join(', ') + '}' else x.to_s end }.join(', ') + "]"))
