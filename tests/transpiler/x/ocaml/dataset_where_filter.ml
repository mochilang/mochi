(* Generated by Mochi transpiler v0.10.32 on 2025-07-21 15:18 +0700 *)

let () =
  let people = [[("name", Obj.repr ("Alice")); ("age", Obj.repr (30))]; [("name", Obj.repr ("Bob")); ("age", Obj.repr (15))]; [("name", Obj.repr ("Charlie")); ("age", Obj.repr (65))]; [("name", Obj.repr ("Diana")); ("age", Obj.repr (45))]] in
  let adults = (List.filter_map (fun person -> if ((Obj.magic (List.assoc "age" person)) >= 18) then Some ([("name", Obj.repr ((Obj.magic (List.assoc "name" person)))); ("age", Obj.repr ((Obj.magic (List.assoc "age" person)))); ("is_senior", Obj.repr (((Obj.magic (List.assoc "age" person)) >= 60)))]) else None) people) in
  print_endline (String.concat " " ["--- Adults ---"]);
  List.iter (fun person ->
  print_endline (String.concat " " [(Obj.magic (List.assoc "name" person)); "is"; string_of_int (Obj.magic (List.assoc "age" person)); if (Obj.magic (List.assoc "is_senior" person)) then " (senior)" else ""]);
  ) adults;
