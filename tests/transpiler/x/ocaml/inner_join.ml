(* Generated by Mochi transpiler v0.10.33 on 2025-07-21 16:07 +0700 *)

exception Break
exception Continue

let () =
  let customers = [[("id", Obj.repr (1)); ("name", Obj.repr ("Alice"))]; [("id", Obj.repr (2)); ("name", Obj.repr ("Bob"))]; [("id", Obj.repr (3)); ("name", Obj.repr ("Charlie"))]] in
  let orders = [[("id", Obj.repr (100)); ("customerId", Obj.repr (1)); ("total", Obj.repr (250))]; [("id", Obj.repr (101)); ("customerId", Obj.repr (2)); ("total", Obj.repr (125))]; [("id", Obj.repr (102)); ("customerId", Obj.repr (1)); ("total", Obj.repr (300))]; [("id", Obj.repr (103)); ("customerId", Obj.repr (4)); ("total", Obj.repr (80))]] in
  let result = (List.concat (List.map (fun o -> (List.filter_map (fun c -> if ((Obj.magic (List.assoc "customerId" o)) == (Obj.magic (List.assoc "id" c))) then Some ([("orderId", Obj.repr ((Obj.magic (List.assoc "id" o)))); ("customerName", Obj.repr ((Obj.magic (List.assoc "name" c)))); ("total", Obj.repr ((Obj.magic (List.assoc "total" o))))]) else None) customers)) orders)) in
  print_endline (String.concat " " ["--- Orders with customer info ---"]);
  (try List.iter (fun entry ->
    try
  print_endline (String.concat " " ["Order"; string_of_int (Obj.magic (List.assoc "orderId" entry)); "by"; (Obj.magic (List.assoc "customerName" entry)); "- $"; string_of_int (Obj.magic (List.assoc "total" entry))]);
    with Continue -> ()) result with Break -> ())
