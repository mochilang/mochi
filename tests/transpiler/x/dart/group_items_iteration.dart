// Generated by Mochi transpiler
import 'dart:convert';

void json(dynamic v) {
  var e = const JsonEncoder.withIndent('  ');
  print(e.convert(v));
}

class Data {
  final String tag;
  final int val;
  const Data({required this.tag, required this.val});
  Map<String, dynamic> toJson() => {"tag": tag, "val": val};
}

void main() {
  final List<Data> data = [Data(tag: "a", val: 1), Data(tag: "a", val: 2), Data(tag: "b", val: 3)];
  final List<Map<String, dynamic>> groups = (() {
  var _groups = <String, Map<String, dynamic>>{};
  var _order = <String>[];
  for (var d in data) {
    var _key = d.tag;
    var _ks = _key.toString();
    var _g = _groups[_ks];
    if (_g == null) {
      _g = {'key': _key, 'items': []};
      _groups[_ks] = _g;
      _order.add(_ks);
    }
    (_g['items'] as List).add(d);
  }
  var _res = <Map<String, dynamic>>[];
  for (var ks in _order) {
    var g = _groups[ks]!;
    _res.add(g);
  }
  return _res;
})();;
  List<dynamic> tmp = [];
  for (var g in groups) {
    int total = 0;
    for (var x in g["items"]) {
    total = (total + x.val);
  }
    tmp = [...tmp, {"tag": g["key"], "total": total}];
  }
  final List<dynamic> result = (List.of([for (var r in tmp) r])..sort(((a, b) => a.tag.compareTo(b.tag))));
  print("[" + result.join(', ') + "]");
}
