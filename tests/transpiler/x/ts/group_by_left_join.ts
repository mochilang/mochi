// Generated by Mochi v0.10.33 on 2025-07-21 18:23:26 GMT+7

export interface Customer { id: number; name: string }
export interface Order { id: number; customerId: number }
export interface Result { name: any; count: number }
const customers: Customer[] = [{id: 1, name: "Alice"}, {id: 2, name: "Bob"}, {id: 3, name: "Charlie"}];
const orders: Order[] = [{id: 100, customerId: 1}, {id: 101, customerId: 1}, {id: 102, customerId: 2}];
const stats: Record<string, any>[] = (() => {
  const _groups: Record<string, {key: any; items: any[]}> = {}
  const _order: string[] = []
  let _items = customers.map(v => [v])
  { const _joined = []
    const _arr = orders
    for (const _left of _items) {
      const [c] = _left;
      let _m = false;
      for (let _ri=0; _ri < _arr.length; _ri++) {
        const o = _arr[_ri];
        if (!((o["customerId"] == c["id"]))) continue;
        _m = true; _joined.push([..._left, o]) }
      if (!_m) _joined.push([..._left, null])
    }
    _items = _joined;
  }
  for (const _it of _items) {
    const [c, o] = _it;
    const _k = c["name"]
    const _ks = JSON.stringify(_k)
    let _g = _groups[_ks]
    if (!_g) { _g = {key: _k, items: []}; _groups[_ks] = _g; _order.push(_ks) }
    _g.items.push({c, o})
  }
  const result: Result[] = []
  for (const ks of _order) {
    const g = _groups[ks]
    result.push({name: g["key"], count: (Array.isArray((() => {
  const result = []
  for (const r of g["items"]) {
    if (r["o"]) {
      result.push(r)
    }
  }
  const out = result
  return out
})()) || typeof (() => {
  const result = []
  for (const r of g["items"]) {
    if (r["o"]) {
      result.push(r)
    }
  }
  const out = result
  return out
})() === 'string' ? (() => {
  const result = []
  for (const r of g["items"]) {
    if (r["o"]) {
      result.push(r)
    }
  }
  const out = result
  return out
})().length : Object.keys((() => {
  const result = []
  for (const r of g["items"]) {
    if (r["o"]) {
      result.push(r)
    }
  }
  const out = result
  return out
})() ?? {}).length)})
  }
  return result
})();
console.log(["--- Group Left Join ---"].map(v => v === null ? 'nil' : typeof v === 'object' ? JSON.stringify(v).replace(/:/g, ': ').replace(/,/g, ', ') : v).join(' ').trimEnd());
for (const s of stats) {
  console.log([s["name"], "orders:", s["count"]].map(v => v === null ? 'nil' : typeof v === 'object' ? JSON.stringify(v).replace(/:/g, ': ').replace(/,/g, ', ') : v).join(' ').trimEnd());
}
