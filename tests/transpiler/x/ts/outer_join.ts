// Generated by Mochi v0.10.32 on 2025-07-20 18:03:15 GMT+7

const customers: { id: number; name: string }[] = [{id: 1, name: "Alice"}, {id: 2, name: "Bob"}, {id: 3, name: "Charlie"}, {id: 4, name: "Diana"}];
const orders: { id: number; customerId: number; total: number }[] = [{id: 100, customerId: 1, total: 250}, {id: 101, customerId: 2, total: 125}, {id: 102, customerId: 1, total: 300}, {id: 103, customerId: 5, total: 80}];
const result: Record<string, Record<string, number>>[] = (() => {
  const _join = (items, arr, on, left, right) => {
    const joined = [];
    if (right && left) {
      const matched = new Array(arr.length).fill(false);
      for (const leftIt of items) {
        let m = false;
        for (let ri=0; ri < arr.length; ri++) {
          const rightIt = arr[ri];
          let keep = true;
          if (on) keep = on(...leftIt, rightIt);
          if (!keep) continue;
          m = true; matched[ri] = true;
          joined.push([...leftIt, rightIt]);
        }
        if (!m) joined.push([...leftIt, null]);
      }
      for (let ri=0; ri < arr.length; ri++) {
        if (!matched[ri]) {
          const undef = Array(items[0]?.length || 0).fill(null);
          joined.push([...undef, arr[ri]]);
        }
      }
    } else if (right) {
      for (const rightIt of arr) {
        let m = false;
        for (const leftIt of items) {
          let keep = true;
          if (on) keep = on(...leftIt, rightIt);
          if (!keep) continue;
          m = true; joined.push([...leftIt, rightIt]);
        }
        if (!m) {
          const undef = Array(items[0]?.length || 0).fill(null);
          joined.push([...undef, rightIt]);
        }
      }
    } else {
      for (const leftIt of items) {
        let m = false;
        for (const rightIt of arr) {
          let keep = true;
          if (on) keep = on(...leftIt, rightIt);
          if (!keep) continue;
          m = true; joined.push([...leftIt, rightIt]);
        }
        if (left && !m) joined.push([...leftIt, null]);
      }
    }
    return joined;
  }
  let _items = orders.map(v => [v])
  _items = _join(_items, customers, (o, c) => ((o["customerId"] == c["id"])), true, true)
  let _rows = _items
  const result = []
  for (const r of _rows) { const [o, c] = r; result.push({order: o, customer: c}) }
  return result
})();
console.log("--- Outer Join using syntax ---");
for (const row of result) {
  if (row["order"]) {
    if (row["customer"]) {
      console.log("Order", row["order"]["id"], "by", row["customer"]["name"], "- $", row["order"]["total"]);
    } else {
      console.log("Order", row["order"]["id"], "by", "Unknown", "- $", row["order"]["total"]);
    }
  } else {
    console.log("Customer", row["customer"]["name"], "has no orders");
  }
}
