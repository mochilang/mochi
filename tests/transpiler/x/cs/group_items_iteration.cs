// Generated by Mochi
using System;
using System.Collections.Generic;
using System.Linq;

class Program {
    static Dictionary<string, object>[] data = new[]{new Dictionary<string, object>{{"tag", "a"}, {"val", 1}}, new Dictionary<string, object>{{"tag", "a"}, {"val", 2}}, new Dictionary<string, object>{{"tag", "b"}, {"val", 3}}};
    static Dictionary<string, object>[][] groups = (from d in data group d by ((dynamic)(d["tag"])) into gTmp let g = new { key = gTmp.Key, items = gTmp.ToArray() } select g).ToArray();
    static object[] tmp = new[]{};
    static int total = 0;
    static [] result = (from r in tmp orderby r.tag select r).ToArray();
    static void Main() {
        foreach (var g in groups) {
    foreach (var x in g.items) {
    total = (total + x.val);
}
    tmp = (tmp.Append(new Dictionary<string, object>{{"tag", g.key}, {"total", total}}).ToArray());
}
        Console.WriteLine(result);
    }
}
