# Code generated by Mochi transpiler.
# Version 0.10.35, generated on 2025-07-22 12:16 +0700
from __future__ import annotations
from dataclasses import dataclass
from typing import List, Dict

@dataclass
class GenType1:
    id: int
    name: str

customers = [GenType1(1, "Alice"), GenType1(2, "Bob"), GenType1(3, "Charlie")]
@dataclass
class GenType2:
    id: int
    customerId: int

orders = [GenType2(100, 1), GenType2(101, 1), GenType2(102, 2)]
@dataclass
class StatsGroup:
    key: str
    items: list

@dataclass
class GenType3:
    c: any
    o: any

_stats_groups = {}
for c in customers:
    for o in [o for o in orders if o.customerId == c.id] or [None]:
        _g = _stats_groups.setdefault(c.name, StatsGroup(c.name, []))
        _g.items.append(GenType3(c, o))
@dataclass
class GenType5:
    name: str
    count: int

stats = [GenType5(g.key, len([r for r in g.items if r.o])) for g in _stats_groups.values()]
print("--- Group Left Join ---")
for s in stats:
    print(s.name, "orders:", s.count)
