# Code generated by Mochi transpiler.
# Version 0.10.36, generated on 2025-07-22 17:46 +0700
from __future__ import annotations
from dataclasses import dataclass
from typing import List, Dict

@dataclass
class Customer:
    id: int
    name: str

customers = [Customer(1, "Alice"), Customer(2, "Bob"), Customer(3, "Charlie")]
@dataclass
class Order:
    id: int
    customerId: int

orders = [Order(100, 1), Order(101, 1), Order(102, 2)]
@dataclass
class StatsGroup:
    key: str
    items: list

@dataclass
class StatsRow:
    c: any
    o: any

_stats_groups = {}
for c in customers:
    for o in [o for o in orders if o.customerId == c.id] or [None]:
        _g = _stats_groups.setdefault(c.name, StatsGroup(c.name, []))
        _g.items.append(StatsRow(c, o))
@dataclass
class Stat:
    name: str
    count: int

stats = [Stat(g.key, len([r for r in g.items if r.o])) for g in _stats_groups.values()]
print("--- Group Left Join ---")
for s in stats:
    print(s.name, "orders:", s.count)
