# Generated by Mochi transpiler v0.10.32 on 2025-07-21 15:12 +0700
nation = [{"n_nationkey": 1, "n_name": "BRAZIL"}]
customer = [{"c_custkey": 1, "c_name": "Alice", "c_acctbal": 100.0, "c_nationkey": 1, "c_address": "123 St", "c_phone": "123-456", "c_comment": "Loyal"}]
orders = [{"o_orderkey": 1000, "o_custkey": 1, "o_orderdate": "1993-10-15"}, {"o_orderkey": 2000, "o_custkey": 1, "o_orderdate": "1994-01-02"}]
lineitem = [{"l_orderkey": 1000, "l_returnflag": "R", "l_extendedprice": 1000.0, "l_discount": 0.1}, {"l_orderkey": 2000, "l_returnflag": "N", "l_extendedprice": 500.0, "l_discount": 0.0}]
start_date = "1993-10-01"
end_date = "1994-01-01"
_result_groups = {}
for c in customer:
    for o in [o for o in orders if o["o_custkey"] == c["c_custkey"]]:
        for l in [l for l in lineitem if l["l_orderkey"] == o["o_orderkey"]]:
            for n in [n for n in nation if n["n_nationkey"] == c["c_nationkey"]]:
                if o["o_orderdate"] >= start_date and o["o_orderdate"] < end_date and l["l_returnflag"] == "R":
                    _g = _result_groups.setdefault(tuple([c["c_custkey"], c["c_name"], c["c_acctbal"], c["c_address"], c["c_phone"], c["c_comment"], n["n_name"]]), {"key": {"c_custkey": c["c_custkey"], "c_name": c["c_name"], "c_acctbal": c["c_acctbal"], "c_address": c["c_address"], "c_phone": c["c_phone"], "c_comment": c["c_comment"], "n_name": n["n_name"]}, "items": []})
                    _g["items"].append({"c": c, "o": o, "l": l, "n": n})
result = []
for g in _result_groups.values():
    result.append({"c_custkey": g["key"]["c_custkey"], "c_name": g["key"]["c_name"], "revenue": sum([x["l"]["l_extendedprice"] * (1 - x["l"]["l_discount"]) for x in g["items"]]), "c_acctbal": g["key"]["c_acctbal"], "n_name": g["key"]["n_name"], "c_address": g["key"]["c_address"], "c_phone": g["key"]["c_phone"], "c_comment": g["key"]["c_comment"]})
print(result)
