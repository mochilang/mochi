# Code generated by Mochi v0.10.34 - DO NOT EDIT
from dataclasses import dataclass
from typing import List, Dict

@dataclass
class People:
    name: str
    age: int
    city: str

people = [People("Alice", 30, "Paris"), People("Bob", 15, "Hanoi"), People("Charlie", 65, "Paris"), People("Diana", 45, "Hanoi"), People("Eve", 70, "Paris"), People("Frank", 22, "Hanoi")]

@dataclass
class StatGroup:
    key: any
    items: List[People]

_stats_groups: Dict[str, StatGroup] = {}
for person in people:
    g = _stats_groups.setdefault(person.city, StatGroup(person.city, []))
    g.items.append(person)

@dataclass
class Stat:
    city: any
    count: any
    avg_age: any

stats = []
for g in _stats_groups.values():
    avg_age = sum([p.age for p in g.items]) / len(g.items) if g.items else 0.0
    stats.append(Stat(g.key, len(g.items), avg_age))
print("--- People grouped by city ---")
for s in stats:
    print(" ".join(str(x) for x in [s.city, ": count =", s.count, ", avg_age =", s.avg_age]).rstrip())
