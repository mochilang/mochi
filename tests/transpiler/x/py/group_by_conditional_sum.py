# Code generated by Mochi v0.10.34 - DO NOT EDIT
from dataclasses import dataclass
from typing import List, Dict

items = [{"cat": "a", "val": 10, "flag": True}, {"cat": "a", "val": 5, "flag": False}, {"cat": "b", "val": 20, "flag": True}]
_result_groups = {}
for i in items:
    _g = _result_groups.setdefault(i["cat"], {"key": i["cat"], "items": []})
    _g["items"].append(i)
@dataclass
class Result:
    cat: any
    share: any

result = [Result(g["key"], sum([(x["val"] if x["flag"] else 0) for x in g["items"]]) / sum([x["val"] for x in g["items"]])) for g in _result_groups.values()]
print(result)
