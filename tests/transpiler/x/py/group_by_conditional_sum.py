# Generated by Mochi transpiler v0.10.32 on 2025-07-21 15:12 +0700
items = [{"cat": "a", "val": 10, "flag": True}, {"cat": "a", "val": 5, "flag": False}, {"cat": "b", "val": 20, "flag": True}]
_result_groups = {}
for i in items:
    _g = _result_groups.setdefault(i["cat"], {"key": i["cat"], "items": []})
    _g["items"].append(i)
result = []
for g in _result_groups.values():
    result.append({"cat": g["key"], "share": sum([(x["val"] if x["flag"] else 0) for x in g["items"]]) // sum([x["val"] for x in g["items"]])})
print(result)
