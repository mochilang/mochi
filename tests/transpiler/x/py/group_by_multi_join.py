# Code generated by Mochi v0.10.34 - DO NOT EDIT
from collections import defaultdict
from dataclasses import dataclass
from typing import List, Dict

nations = [{"id": 1, "name": "A"}, {"id": 2, "name": "B"}]
suppliers = [{"id": 1, "nation": 1}, {"id": 2, "nation": 2}]
partsupp = [{"part": 100, "supplier": 1, "cost": 10.0, "qty": 2}, {"part": 100, "supplier": 2, "cost": 20.0, "qty": 1}, {"part": 200, "supplier": 1, "cost": 5.0, "qty": 3}]
filtered = [{"part": ps["part"], "value": ps["cost"] * ps["qty"]} for ps in partsupp for s in suppliers for n in nations if s["id"] == ps["supplier"] and n["id"] == s["nation"] and n["name"] == "A"]
@dataclass
class Grouped:
    part: any
    total: any

_grouped_groups = defaultdict(float)
for x in filtered:
    _grouped_groups[x["part"]] += x["value"]
grouped = []
for kv in _grouped_groups.items():
    k = kv[0]
    v = kv[1]
    grouped.append(Grouped(part=k, total=v))
print(grouped)
