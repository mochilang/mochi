# Generated by Mochi transpiler v0.10.32 on 2025-07-21 07:08 +0700
import json

nations = [{"id": 1, "name": "A"}, {"id": 2, "name": "B"}]
suppliers = [{"id": 1, "nation": 1}, {"id": 2, "nation": 2}]
partsupp = [{"part": 100, "supplier": 1, "cost": 10.0, "qty": 2}, {"part": 100, "supplier": 2, "cost": 20.0, "qty": 1}, {"part": 200, "supplier": 1, "cost": 5.0, "qty": 3}]
filtered = [{"part": ps["part"], "value": ps["cost"] * ps["qty"]} for ps in partsupp for s in suppliers for n in nations if s["id"] == ps["supplier"] and n["id"] == s["nation"] and n["name"] == "A"]
_grouped_groups = {}
for x in filtered:
    _g = _grouped_groups.setdefault(x["part"], {"key": x["part"], "items": []})
    _g["items"].append(x)
grouped = []
for g in _grouped_groups.values():
    grouped.append({"part": g["key"], "total": sum([r["value"] for r in g["items"]])})
print(json.dumps(grouped, indent=2))
