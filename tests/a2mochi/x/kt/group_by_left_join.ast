(program
  (let customers
    (list
      (map
        (entry (selector id) (int 1))
        (entry (selector name) (string Alice))
      )
      (map
        (entry (selector id) (int 2))
        (entry (selector name) (string Bob))
      )
      (map
        (entry (selector id) (int 3))
        (entry (selector name) (string Charlie))
      )
    )
  )
  (let orders
    (list
      (map
        (entry (selector id) (int 100))
        (entry (selector customerId) (int 1))
      )
      (map
        (entry (selector id) (int 101))
        (entry (selector customerId) (int 1))
      )
      (map
        (entry (selector id) (int 102))
        (entry (selector customerId) (int 2))
      )
    )
  )
  (let stats
    (query c
      (source (selector customers))
      (left_join o
        (source (selector orders))
        (on
          (binary ==
            (selector customerId (selector o))
            (selector id (selector c))
          )
        )
      )
      (group_by
        (selector name (selector c))
        (into g)
      )
      (select
        (map
          (entry
            (selector name)
            (selector key (selector g))
          )
          (entry
            (selector count)
            (call count
              (query r
                (source (selector g))
                (where
                  (selector o (selector r))
                )
                (select (selector r))
              )
            )
          )
        )
      )
    )
  )
  (call print (string "--- Group Left Join ---"))
  (for s
    (in (selector stats))
    (block
      (call print
        (selector name (selector s))
        (string "orders:")
        (selector count (selector s))
      )
    )
  )
)
