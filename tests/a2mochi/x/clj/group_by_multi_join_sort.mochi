// Generated by Mochi v0.10.48 on 2025-07-30 00:02:08 GMT+7
[defrecord, Lineitem, [l_orderkey, l_returnflag, l_extendedprice, l_discount]]
[defrecord, Orders, [o_orderkey, o_custkey, o_orderdate]]
[defrecord, Customer, [c_custkey, c_name, c_acctbal, c_nationkey, c_address, c_phone, c_comment]]
[defrecord, Nation, [n_nationkey, n_name]]
let nation
let customer
let orders
let lineitem
let start_date = _1993_10_01
let end_date = _1994_01_01
let result = [for, [g, [sort_by, [fn, [g], _(sum([for, [x, [items, g]], ([l_extendedprice, [l, x]] * (1 - [l_discount, [l, x]]))]))], [for, g]]], {c_acctbal: [c_acctbal, [key, g]], c_address: [c_address, [key, g]], c_comment: [c_comment, [key, g]], c_custkey: [c_custkey, [key, g]], c_name: [c_name, [key, g]], c_phone: [c_phone, [key, g]], n_name: [n_name, [key, g]], revenue: sum([for, [x, [items, g]], ([l_extendedprice, [l, x]] * (1 - [l_discount, [l, x]]))])}]
fun main() {
  print(result)
}
main()
