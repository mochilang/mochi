# [Mobiles](https://www.spoj.com/problems/MOBILE2)

## Problem Summary
Given a description of a mobile composed of rods and toys, determine the minimum number of left/right swaps of subtrees needed to obtain a configuration where
1. all toys are at one of two adjacent levels (depth difference ≤ 1), and
2. whenever two toys differ in level, the lower toy appears to the left of the higher one.
If no reconfiguration satisfies these conditions, output `-1`.

## Algorithm
1. Store the children of each rod. Because child rods have larger indices, process the rods in reverse order (from n down to 1).
2. For each rod compute information about its subtree:
   - `minDepth` and `maxDepth` of any toy below the rod.
   - minimum number of swaps needed to satisfy the conditions within the subtree, or mark the subtree impossible.
   - For a toy directly attached to a rod, `minDepth = maxDepth = 1` and `cost = 0`.
3. For each rod combine the information from its two children.  Consider both orientations: original and swapped.
   A configuration is valid when
   - `maxDepth - minDepth ≤ 1` across both subtrees, and
   - every leaf on the left is at least as deep as every leaf on the right.
   The cheaper valid orientation becomes the rod's result, adding `1` to the cost if a swap is used.
4. After processing all rods, the root's cost is the answer; if its subtree is impossible output `-1`.

This dynamic program runs in `O(n)` time and uses `O(n)` memory.
