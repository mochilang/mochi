# [Frequent values](https://www.spoj.com/problems/FREQUENT)

## Problem Summary
Given a non-decreasing sequence of integers and many range queries `i j`, for each query find the count of the most frequent value within the subarray `a_i..a_j`.

## Algorithm
1. Preprocess the array into runs of equal numbers. For each index, store the run it belongs to, and for each run store its start, end and length.
2. Build a segment tree over the run lengths to answer maximum queries for complete runs entirely inside a query range.
3. To answer a query `(l,r)`:
   - If `l` and `r` are in the same run, the answer is `r-l+1`.
   - Otherwise compute the tail of the left run and the head of the right run.
   - Query the segment tree for the maximum run length between the runs containing `l` and `r`.
   - The result is the maximum of these three values.

This preprocessing is `O(n)` and each query runs in `O(log n)` time.
