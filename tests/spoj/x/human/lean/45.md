# COMMEDIA - Commedia dell Arte

Given a 3D sliding puzzle of size `M` (up to 100) containing tiles `1..M^3-1` and one blank `0`,
we must determine whether a given configuration can reach the solved state
where tile `z*M^2 + y*M + x + 1` is at coordinates `(x,y,z)` and `(M-1,M-1,M-1)` is blank.

## Algorithm

We treat the puzzle as a permutation of `M^3` items, including the blank tile.
Let `n = M^3`. We flatten the input layers in row-major order and build an array `perm`
where `perm[i]` is the solved index of the tile currently at position `i`
(`tile k` maps to `k-1`, while the blank maps to `n-1`).

The parity of this permutation (even or odd) is computed via cycle decomposition:
```
visited := array[n] of false
swaps := 0
for each index i not visited:
    follow the cycle starting at i, marking visited
    swaps += cycle_length - 1
odd := swaps mod 2 = 1
```
Let `(x,y,z)` be the coordinates of the blank (0-based) obtained from its index.
A known invariant for sliding puzzles states that
```
(parity + x + y + z) mod 2 = (M - 1) mod 2
```
for any reachable configuration. We verify this equality to decide solvability.

## Correctness

- Each move swaps the blank with an adjacent tile, toggling permutation parity and the sum `x+y+z`.
- The solved state has parity `0` and blank at `(M-1,M-1,M-1)`, giving invariant `(M-1) mod 2`.
- Because every valid move preserves this invariant, any configuration satisfying the equality is reachable.
- If the equality fails, the invariant differs from the solved state, so the configuration is unreachable.

## Complexity

Let `n = M^3` (â‰¤ 10^6).
The cycle decomposition visits each position once, yielding `O(n)` time and `O(n)` space.
