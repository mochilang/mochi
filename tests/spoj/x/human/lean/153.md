# SPOJ SCALES - Balancing the Stone

We are given a stone of weight `W` on the left pan and `N` weights of powers of two
`1, 2, 4, ..., 2^{N-1}`.  Each weight can be placed on the left pan, on the right pan
or not used.  We must count how many assignments balance the scales, modulo `D`.

Let `a_i` denote the placement of weight `2^i` where `a_i = -1` for the left,
`0` if unused and `1` for the right.  The balance condition is

```
Σ a_i 2^i = W
```

Processing bits from least to most significant we keep track of the carry between
positions.  The carry after bit `i` can only be `-1`, `0` or `1` and we maintain three
counters `(dp₋₁, dp₀, dp₁)` for the number of ways to reach each carry.  For each
incoming bit `b`:

- If `b = 0` then
  `dp₋₁' = dp₋₁`,
  `dp₀' = dp₋₁ + dp₀ + dp₁`,
  `dp₁' = dp₁`.
- If `b = 1` then
  `dp₋₁' = dp₋₁ + dp₀`,
  `dp₀' = dp₀ + dp₁`,
  `dp₁' = 0`.

All arithmetic is performed modulo `D`.  After processing all `N` bits the answer is
`dp₀`, the number of ways ending with zero carry.
