# [EQU2 - Yet Another Equation](https://www.spoj.com/problems/EQU2/)

The task is to find the smallest positive integers `x` and `y` solving the Pell
equation

```
x^2 - n*y^2 = 1
```

for a given non-square integer `n` (2 ≤ n ≤ 1000).  The minimal solution is the
fundamental solution of the Pell equation and can be obtained from the continued
fraction expansion of `√n`.

Algorithm outline:

1. Compute the continued fraction expansion of `√n` using the standard recurrence
   `m_{k+1} = d_k*a_k - m_k`, `d_{k+1} = (n - m_{k+1}^2) / d_k`,
   `a_{k+1} = ⌊(a0 + m_{k+1}) / d_{k+1}⌋`, where `a0 = ⌊√n⌋`.
2. Iterate convergents `(p_k, q_k)` with
   `p_{k+1} = a_{k+1}*p_k + p_{k-1}` and `q_{k+1} = a_{k+1}*q_k + q_{k-1}`
   starting from `(p_0,q_0) = (a0,1)` and `(p_{-1},q_{-1}) = (1,0)`.
3. The first convergent satisfying `p_k^2 - n*q_k^2 = 1` is the required pair `(x, y)`.

This method finishes quickly because the period of the continued fraction for
`√n` is small for `n ≤ 1000`, yet it can produce very large numbers, hence the
implementation uses arbitrary-precision integers.
