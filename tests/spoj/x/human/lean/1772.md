# [Find The Determinant II](https://www.spoj.com/problems/DETER2)

## Problem Summary
For given integers \(N\) and \(k\), consider the \(N \times N\) matrix with entries
\(m_{ij} = \gcd(i,j)^k\).  For each test case print the determinant of this matrix
modulo `1000003`.

## Algorithm
1. A known result states that the determinant of this "GCD matrix" is
   \(\prod_{i=1}^{N} J_k(i)\), where \(J_k\) is the Jordan totient function of order \(k\).
2. Using \(J_k(n) = n^k \prod_{p\mid n} (1 - p^{-k})\) we can rewrite the determinant as
   \((N!)^k \prod_{p \le N} (1 - p^{-k})^{\lfloor N/p \rfloor}\).
3. Precompute all primes up to \(N\) with a sieve and factorials modulo `1000003`.
4. For each prime \(p\) contributing to the product compute `term = (p^k - 1)/p^k` modulo
   `1000003` using fast exponentiation and modular inverses, then multiply `term^(N/p)`
   into the result.
5. Finally multiply by `(N!)^k` modulo `1000003` and output the answer.

The sieve and factorial precomputation are \(O(N)\).  Each test case then processes each
prime once and uses logarithmic-time exponentiation, giving an overall complexity of
approximately \(O(N + \pi(N) \log k)\).
