# [Angels and Devils](https://www.spoj.com/problems/ANGELS/)

## Problem Summary
Given an \(X \times Y\) grid, each cell is either:
- `H`: empty heavenly room with transparent walls,
- `A`: heavenly room already occupied by an angel (opaque walls), or
- `D`: a room captured by the Devil (unusable).

We must place as many fighters as possible on `H` cells so that no two fighters can see each other horizontally or vertically.
Sight stops at `A` or `D` cells. Determine the maximal number of fighters for each test case.

## Algorithm
1. **Horizontal segments:** For each row, scan left to right and assign an id to every maximal contiguous run of `H` cells, skipping over `A` and `D` cells which break visibility.
2. **Vertical segments:** Scan each column to assign ids to vertical runs of `H` cells using the same rule.
3. **Graph construction:** Every `H` cell belongs to exactly one horizontal and one vertical segment. Add an edge between these segment ids; selecting that cell corresponds to matching the two segments.
4. **Maximum matching:** The problem reduces to finding the largest set of edges with unique endpoints, i.e. a maximum bipartite matching. We run a DFS-based augmenting path algorithm over the graph.
5. The number of matched pairs equals the maximum number of fighters that can be placed.

The grid has at most \(300 \times 300\) cells. Both the number of segments and edges are linear in the number of `H` cells, so the matching algorithm runs fast enough for the constraints.
