# [The Explosion](https://www.spoj.com/problems/EXPLOSN/)

## Problem Summary
Each of the `N` detained people names exactly one person as a perpetrator. Innocent people always tell the truth, so if someone is innocent then the person they name must be guilty. Perpetrators may name anyone. Find the smallest possible number of perpetrators consistent with all testimonies.

## Algorithm
1. Model testimonies as a directed graph where there is an edge `i -> P[i]`. Every node has out-degree one, so each component is a directed cycle with trees feeding into the cycle.
2. Build reverse adjacency lists and indegree counts. Repeatedly remove nodes with indegree zero (Kahn's algorithm), computing for each removed node two values:
   * `dp0[u]` – minimum perpetrators in its subtree when `u` is innocent.
   * `dp1[u]` – minimum when `u` is guilty.
   For a node `u`, `dp0[u]` is the sum of `dp1` of its children, while `dp1[u]` is `1` plus the sum of `min(dp0, dp1)` of its children.
3. Remaining nodes lie on cycles. For each cycle node, incorporate contributions from its already processed tree children.
4. For every cycle, solve a weighted vertex-cover on the cycle using dynamic programming with two cases: the first node selected or not. Add the smaller result to the answer.
5. Output the total over all cycles.

This approach runs in `O(N)` time per test case and uses linear memory.
