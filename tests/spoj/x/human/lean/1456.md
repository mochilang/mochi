# LOSTCT - The Secret of a Lost City

The input string is a valid IPA expression built from nouns, verbs and adverbs.
The grammar is

```
<IPA>        ::= <sentence>{<sentence>}
<sentence>   ::= <noun phrase>{<verb phrase><noun phrase>}[<verb phrase>]
<noun phrase>::= <noun> | [<adverb>]<noun phrase>
<verb phrase>::= <verb> | [<adverb>]<verb phrase>
```

A noun phrase is a chain of adverbs followed by a noun and a verb phrase is a
chain of adverbs followed by a verb.  A sentence is a noun phrase followed by
zero or more `(verb phrase, noun phrase)` pairs and an optional final verb
phrase.

We must split the given word stream into dictionary words so that the whole
string becomes several sentences; among all valid splittings, first minimize the
number of sentences and then the total number of words.

## Algorithm

Dynamic programming with memoization is used.

* `parseNP(i)` and `parseVP(i)` return all end positions reachable from index
  `i` when parsing a noun phrase or verb phrase and the minimal number of words
  needed.  They check every dictionary word that matches at position `i` and
  recurse when an adverb is consumed.
* `tailPart(i)` parses the part after the first noun phrase of a sentence,
  handling `(VP NP)*[VP]`.
* `sentencePart(i)` combines a noun phrase with `tailPart` to obtain every
  possible end of a sentence starting at `i` and its word count.
* `solve(i)` gives the optimal pair `(sentences, words)` for the suffix starting
  at `i` by trying all sentences from `sentencePart(i)` and combining with
  `solve(j)` for the remainder.  Pairs are compared lexicographically.

Each helper caches its results in a `HashMap`, so every substring index is
processed only once.  The overall complexity is polynomial in the string length
(≤ 5000) and the dictionary size (≤ 1000).
