# [KPMAZE - Maze](https://www.spoj.com/problems/KPMAZE/)

## Problem Summary
We are given an \(H \times W\) grid (with \(1 \leq H,W \leq 5\)).
Some adjacent cells are already separated by walls.
We may add additional walls but cannot remove existing ones.
A maze is *correct* when for every pair of cells there is exactly one path between them,
meaning the adjacency graph of the cells is a tree.
Count how many different correct mazes can be obtained by adding walls.

## Algorithm
1. Number the \(N = H \times W\) cells and construct the grid graph where edges join orthogonally adjacent cells.
   Remove edges for all existing walls.
2. The number of ways to add walls so that the maze becomes correct equals the number of spanning trees of this graph.
3. Build the Laplacian matrix of the graph and compute any \((N-1) \times (N-1)\) minor determinant (Kirchhoff's matrix-tree theorem).
4. Output the resulting determinant, which equals the number of spanning trees and hence the count of valid mazes.

The grid contains at most 25 cells, so the \(O(N^3)\) Gaussian elimination to compute the determinant is easily fast enough.
