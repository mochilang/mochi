# The Zebra Crossing (ZEBRA)

[Problem link](https://www.spoj.com/problems/ZEBRA/)

## Algorithm

1. For each pedestrian we compute the line of travel.  A person starting at
   `x` and walking at an angle `a` crosses the street of width `w` and ends at
   `x + w * tan(a)`.
2. To collide with another person we must have the same vertical speed.  Hence
   we can only collide with pedestrians sharing the same crossing time `t`.
3. Group pedestrians by `t`.  If `w > v*t` the vertical speed would exceed the
   allowed speed `v`, therefore that group is ignored.
4. For groups where `v*t = w` we can only move vertically.  Each pedestrian
   defines an interval on the horizontal axis between the start and end
   positions.  We may collide if our vertical line falls inside this interval.
   The answer for such a group is the maximum number of intervals having a
   common point, computed with a sweep line.
5. For all other valid groups the horizontal displacement is unrestricted for
   the constraints of the problem and we can collide with everyone in the
   group.  The answer for the test case is the maximum among all groups.

## Correctness

- Pedestrians with different crossing times have different vertical speeds;
  thus a collision cannot occur.  Grouping by `t` is therefore required and
  sufficient.
- If `v*t = w`, the only possible movement is a vertical line.  Collisions
  occur iff the line lies between the starting and ending positions of a
  pedestrian.  Counting the maximum overlap of these intervals gives the number
  of people we can collide with for that group.
- If `v*t > w`, we can choose an angle that allows any horizontal movement
  while still respecting the speed limit.  Hence we can collide with every
  pedestrian in that group.
- Taking the maximum over all groups yields the maximum possible number of
  collisions overall.

## Complexity

Let `n` be the number of pedestrians and `g` the size of a group with
identical `t`.

- Building the groups runs in `O(n)`.
- For the vertical case we sort `g` intervals and sweep them, which costs
  `O(g log g)`.
- For all other groups the result is obtained in `O(1)`.

The total complexity is dominated by the vertical groups and is at most
`O(n log n)`.
