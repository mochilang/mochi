# [Traveling by Stagecoach](https://www.spoj.com/problems/TRSTAGE)

## Problem Summary
Given a road network of up to 30 cities and at most eight stagecoach tickets each specifying the number of horses (speed), find the minimum travel time from start city `a` to destination city `b`. Each ticket may be used at most once and only one ticket can be used per road. Travel time for an edge equals its length divided by the horses on the ticket used. If the destination is unreachable, output `Impossible`.

## Algorithm
1. Parse the number of tickets `n`, cities `m`, roads `p`, start `a` and goal `b` for each dataset. Stop when all are zero.
2. Store ticket speeds in an array and build an undirected adjacency list for the roads.
3. Run Dijkstra on an expanded state space where each state is `(city, usedMask)`:
   - `usedMask` encodes which of the `n` tickets have been consumed.
   - There are `m × 2^n` states. Distances are stored in an array indexed by this pair.
   - Transitions: for every road `(u,v,length)` and every unused ticket `i`, we can move from `(u,mask)` to `(v,mask ∪ {i})` with cost `length / ticket[i]`.
   - A simple list-based priority queue is sufficient due to the small state space.
4. After Dijkstra finishes, inspect all states `(b,mask)` and take the minimum distance over all masks. If no finite distance exists, report `Impossible`.

## Complexity
Let `N = m × 2^n` be the number of states. Each state explores up to `deg(u) × remainingTickets` edges. With `m ≤ 30` and `n ≤ 8`, the total complexity is `O(N × n + E × n)` which is well below limits.
