# [Is it prime?](https://www.spoj.com/problems/PON)

## Problem Summary
Given up to 500 integers `2 ≤ N ≤ 2^63 − 1`, determine for each whether it is prime. Output `"YES"` if the number is prime and `"NO"` otherwise.

## Algorithm
We apply a deterministic Miller–Rabin primality test suitable for 64‑bit numbers:

1. Handle trivial cases: numbers < 2 are composite, and even numbers are composite unless they equal 2.
2. Express `n − 1` as `d * 2^s` with `d` odd.
3. For each base `a` in `[2, 3, 5, 7, 11, 13]`:
   - If `a ≥ n`, stop; `n` is prime.
   - Compute `x = a^d mod n` using fast exponentiation.
   - If `x` is `1` or `n − 1`, continue with the next base.
   - Otherwise square `x` repeatedly up to `s − 1` times; if any square equals `n − 1`, continue, otherwise `n` is composite.
4. If no base witnesses compositeness, `n` is prime.

The selected bases guarantee correctness for numbers below `2^63`.

## Complexity
Modular exponentiation runs in `O(log n)` time, and we use a constant number of bases. Overall the algorithm runs in `O(log^3 n)` per test case considering big integer multiplication, which is easily fast enough for the constraints.
