# [GENETIC - Genetic Code](https://www.spoj.com/problems/GENETIC/)

We must output a length `n` genome over the alphabet `{N, O, P}` such that no two adjacent subsegments are equal.  This is a *square-free* word, also known as a Thue sequence.  Any valid genome may be printed.

## Algorithm

A classic infinite square-free word over three symbols is generated by the morphism
```
0 → 012
1 → 02
2 → 1
```
Starting from the word `0` and repeatedly applying the morphism yields longer and longer square-free words.  After reaching length at least `n`, the first `n` characters of the word form a valid genome.

We map digits to letters with `0 → N`, `1 → O`, and `2 → P`.

## Complexity

Let `L` be the smallest power-of-three length produced that is at least `n`.  Each expansion step processes the entire current word, so the running time is `O(L)` and the final length satisfies `L < 3·n`.  With `n ≤ 5000` this is easily fast enough.
