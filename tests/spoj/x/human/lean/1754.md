# DIVSUM2 - Divisor Summation (Hard)

Given up to 500 queries asking for the sum of proper divisors of \(n\) where
\(1 \le n \le 10^{16}\).

For each number we factorise it into primes.  If
\(n = p_1^{a_1} p_2^{a_2} \cdots p_k^{a_k}\) then the sum of all divisors is

\[
\prod_{i=1}^k \frac{p_i^{a_i+1} - 1}{p_i-1}.
\]

The sum of proper divisors is this value minus \(n\) itself.

We trial divide starting from 2.  When a prime factor \(p\) is found we remove
all its powers while accumulating the corresponding geometric series
\(1 + p + p^2 + \cdots + p^{a}\).  Once \(i^2 > m\) the remaining \(m\) is
itself prime.  The approach runs in roughly \(O(\sqrt{n})\) time and is fast
enough for the limits.
