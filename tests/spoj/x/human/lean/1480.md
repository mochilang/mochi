# PT07D - Let us count 1 2 3

We are given queries asking for the number of trees of various types with `n`
vertices, modulo a prime `p`.

1. **Labeled unrooted trees**: Cayley's formula gives `n^{n-2}`.
2. **Labeled rooted trees**: Cayley's formula for rooted trees gives
   `n^{n-1}`.
3. **Unlabeled rooted trees**: Let `a[n]` be the number of unlabeled rooted
   trees with `n` nodes (OEIS A000081).  For `n ≥ 2`:

   ```
   a[n] = (1/(n-1)) * sum_{k=1}^{n-1} b[k] * a[n-k]
   b[k] = sum_{d | k} d * a[d]
   ```

   We maintain arrays `a` and `b` modulo `p`.  After computing `a[m]` we update
   `b` for all multiples of `m`.  Division uses the modular inverse of `n-1`
   since `p` is prime and `n ≤ p`.

4. **Unlabeled unrooted trees**: Let `u[n]` be the answer (OEIS A000055).  Using
   the rooted counts:

   ```
   s = sum_{k=1}^{n-1} a[k] * a[n-k]
   u[n] = a[n] - s/2 + (n even ? a[n/2]/2 : 0)
   ```

   Division by `2` is implemented via the modular inverse of `2`; when `p = 2`
   the constraints give `n ≤ 2`, so the answer is simply `1`.

Fast modular exponentiation is used for the labeled cases and for computing
modular inverses.
