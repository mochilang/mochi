# [Help the problem setter](https://www.spoj.com/problems/HELP/)

## Problem Summary
Given a binary search tree with nodes labeled `1..n`, assign integer access frequencies so that the provided tree is the unique optimal BST. Each test case lists the left and right child of every node (or `-1` for empty) followed by `0` to terminate input. For each test case output the frequencies for nodes `1..n`.

## Algorithm
We assign frequencies bottom-up:

1. The root is the node that never appears as a child.
2. Recursively determine frequencies for the children.
3. A leaf receives frequency `1`.
4. A node with only one child receives twice the child's frequency, ensuring the parent is strictly more probable than the subtree beneath it and thus cannot be profitably rotated.
5. A node with two children receives the maximum of its children's frequencies; this keeps it no heavier than necessary while maintaining optimality.

This guarantees that nodes with a single child are heavier than that child, preventing alternate structures from achieving lower expected cost, while nodes with two children have weight comparable to their heavier child. Frequencies never exceed `2^63` for `n â‰¤ 50`.
