# [Birthday](https://www.spoj.com/problems/BIRTHDAY/)

## Problem Summary
There are `n` children sitting around a circular table in the initial order `1..n`.
We are given a permutation `p` describing the desired cyclic order of the children.
When the children simultaneously move to their new seats they may walk left or
right around the circle. The cost (``mess``) is the sum of the distances each
child moves. We must determine the minimum possible mess over all ways to
simultaneously move the children.

## Algorithm
1. Compute `pos[x]`, the index of child `x` in the permutation `p`.
2. For each child `x`, compute `shift_x = (x-1 - pos[x]) mod n`. This is the
   rotation that would align child `x` without moving.
3. The total mess for rotation `s` is the sum of circular distances between `s`
   and all `shift_x`. The cost function is piecewise linear with slope changes
   at specific points.
4. Using a difference array of length `n` we accumulate the slope changes:
   - Add `+2` to the derivative on interval `[shift_x, shift_x + floor(n/2))`.
   - If `n` is odd, also add `+1` on `[shift_x + floor(n/2), shift_x + floor(n/2) + 1)`.
   The baseline derivative is `-n` everywhere.
5. The cost for rotation `0` is `sum min(shift_x, n - shift_x)`.
   Traverse `s = 0..n-1`, updating the cost using the derivative to find the
   minimal value.

The algorithm runs in `O(n)` time with `O(n)` additional space, meeting the
constraints `n â‰¤ 50000`.
