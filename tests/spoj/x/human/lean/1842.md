# Lineland Airport (SPOJ LINELAND)

## Algorithm

The landscape is given as a polyline through `N` points. Between two
consecutive points the height changes linearly. For an airstrip of
length `L` at position `[a, a+L]` the amount of rock to remove is the
area between the terrain and the lowest height inside the interval. If
`m` is this minimum height and `I(a)` denotes the integral of the
terrain height from `0` to `a`, then

```
removed(a) = ∫_{a}^{a+L} y(x) dx − L * m = L * (avg_y − m)
```

Thus we have to minimise the difference between the average and the
minimum height over any interval of width `L`.

Observations:

* For a fixed interval the minimum height is attained at one of the
  interval's endpoints or at a vertex inside the interval.
* As the interval slides, the set of candidate minima changes only when
  the left or the right endpoint passes a vertex. Therefore it suffices
  to consider intervals whose start is at some vertex `xi` or at
  `xj − L` for another vertex `xj`.
* The integral of the terrain can be computed in `O(1)` for any `x`
  using prefix trapezoid areas.

For every candidate start `a` with `a ≥ x0` and `a+L ≤ xN` we

1. compute the integral `∫_{a}^{a+L} y(x) dx` via the prefix areas,
2. find the minimum height among the two endpoints and all vertices
   inside the interval, and
3. evaluate `removed(a)`.

The answer is the minimal value over all candidates.

The number of vertices is at most 500, hence there are at most 1000
candidates and each evaluation scans at most 500 vertices – easily fast
enough.

## Correctness

We prove that the algorithm outputs the minimal amount of rock that must
be removed.

*The minimum lies at endpoints or vertices.* Between two consecutive
input points the terrain is linear. A linear function restricted to an
interval attains its minimum at one of the endpoints. Therefore the
minimum terrain height over `[a,a+L]` must equal the height at one of
its endpoints or at an input vertex inside it.

*Considering only vertex-aligned intervals is sufficient.* While the
interval slides without its endpoints crossing a vertex, the set of
candidate minima does not change and both the integral and the minimum
height vary linearly with the start position. A linear function over an
interval attains its minimum at one of the interval's boundaries. Hence
the optimal interval starts either at a vertex `xi` or at some `xj − L`.

*Correctness of the computed area.* For any start `a` we evaluate the
integral exactly using prefix trapezoid sums and subtract `L` times the
minimum height found among the candidates, which equals
`∫_{a}^{a+L} (y(x) − m) dx`. This is exactly the amount of rock that
needs to be removed to obtain a flat strip of length `L`.

Since the algorithm checks all candidate intervals that could contain
the optimum and for each computes the exact removal area, the smallest
value returned is the minimal possible area.

## Complexity Analysis

Let `N ≤ 500` be the number of points. We examine at most `2N` candidate
start positions. For each candidate we may scan all `N` points, yielding
an overall time complexity of `O(N^2)` and `O(N)` memory for storing the
polyline and prefix areas.

## Reference

- [SPOJ - LINELAND](https://www.spoj.com/problems/LINELAND/)
