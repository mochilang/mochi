# [Fencing in the Sheep](https://www.spoj.com/problems/FSHEEP/)

## Problem Summary
Given a simple polygon that is star‑shaped with respect to the origin, each test case provides the fence's vertices in counter‑clockwise order and a list of sheep positions. For every sheep we must decide whether its point lies inside or on the boundary of the polygon and count all such sheep.

## Algorithm
1. **Preprocess the polygon**
   - Read all vertices, storing their coordinates and the angle of each vertex from the origin using `atan2`.
   - Ensure the angle sequence is non‑decreasing: whenever a vertex has a smaller angle than the previous one, add `2π` until the sequence is sorted.
   - Append the first angle plus `2π` to ease wrap‑around queries.
   - For every edge store its vector `(dx, dy)` and the cross product `cross(p, q)` where `p` and `q` are consecutive vertices.
2. **Classify each sheep**
   - Compute the sheep's angle `θ`. Shift it by multiples of `2π` so that `angles[0] ≤ θ < angles[n]`.
   - Binary search in the angle array for the largest index `i` with `angles[i] ≤ θ`. The corresponding edge is between vertices `i` and `i+1`.
   - For the point `(x, y)` compute `c = x * dy_i − y * dx_i` and compare it with the precomputed `cross(p_i, p_{i+1})`. The point is inside or on the fence iff `c ≤ cross(p_i, p_{i+1})`.
3. Sum the number of sheep classified as inside and print the count for the test case.

## Correctness Proof
- The polygon is star‑shaped with respect to the origin, hence every ray from the origin intersects the boundary exactly once. Sorting vertex angles and extending by `2π` maps each ray to the unique edge it crosses.
- For a ray hitting edge `(p, q)`, solving the intersection equation shows that a point `(x, y)` with the same direction is inside the polygon precisely when `x * (qy−py) − y * (qx−px) ≤ cross(p, q)`. Thus the comparison in step 2 correctly classifies each sheep.
- Points on the boundary satisfy the equality case, so they are counted as required.
Therefore the algorithm counts exactly the sheep inside or on the fence.

## Complexity Analysis
Let `n` be the number of fence vertices and `m` the number of sheep. Preprocessing the polygon is `O(n)`. Each sheep is processed with a binary search over the angles array, costing `O(log n)` time. Overall complexity per test case is `O(n + m log n)`.
