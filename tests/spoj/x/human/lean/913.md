# QTREE2 - Query on a tree II

We are given a weighted tree and must answer two operations:

* `DIST a b` – total length of the path between nodes `a` and `b`.
* `KTH a b k` – the `k`‑th node on the path from `a` to `b` (1-indexed).

## Algorithm

1. Build an adjacency list of the tree.
2. Run a depth‑first search from node `1` to compute for every node:
   * its depth,
   * distance from the root,
   * its immediate parent.
3. Using the parents, build a binary lifting table `up[v][j]` storing the
   `2^j`‑th ancestor of each node. This allows jumping upward in `O(log N)`.
4. To find the lowest common ancestor (LCA) of two nodes, lift the deeper
   node to the depth of the other and then jump both up, highest power first,
   until they meet.
5. Distance is `dist[a] + dist[b] - 2 * dist[LCA(a,b)]`.
6. For `KTH`, compare `k` with the number of edges from `a` to the LCA.
   If the node lies on the upward path from `a`, lift `a` accordingly.
   Otherwise continue from `b` upward by the remaining steps.

The preprocessing takes `O(N log N)` time and each query is answered in
`O(log N)` time.
