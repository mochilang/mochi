# [Ticket to Ride](https://www.spoj.com/problems/TICKET)

Connect four pairs of cities on a weighted undirected map with minimum total cost. Each pair must be connected by a path of claimed routes; paths for different pairs may share edges.

## Algorithm

1. Read the graph and the four city pairs. Pre-compute all-pairs shortest paths using Floyd–Warshall (`n ≤ 30`).
2. Number the eight terminals (two per pair). Use dynamic programming over subsets to compute the minimum cost to connect any subset of terminals in one component (Steiner tree DP).
   - `dp[mask][v]` = minimum cost of a Steiner tree for terminals in `mask` that ends at node `v`.
   - Combine two non-empty submasks and relax costs across the graph using the precomputed distances.
3. For each subset of terminals, store the best tree cost (minimum over end vertices).
4. A second DP considers the four pairs. For every subset of pairs, try splitting it into a non-empty subsubset whose terminals are connected together plus the remaining pairs. This covers all partitions of the pairs into connected components.
5. The answer is the DP value for all four pairs.

This approach enumerates at most `2^8` terminal subsets and `2^4` pair subsets, so it comfortably meets the limits.
