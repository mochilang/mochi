# Yet Another Equation

We must find the smallest positive solution $(x, y)$ to the Pell equation
$x^2 - n y^2 = 1$ for $2 \le n \le 1000$.

The fundamental solution is obtained from the continued fraction expansion of
$\sqrt{n}$.  We compute the sequence of convergents
$\frac{p_k}{q_k}$ using the standard recurrence for Pell's equation:

- $m_0 = 0,\ d_0 = 1,\ a_0 = \lfloor\sqrt{n}\rfloor$
- $m_{k+1} = d_k a_k - m_k$
- $d_{k+1} = \frac{n - m_{k+1}^2}{d_k}$
- $a_{k+1} = \left\lfloor\frac{a_0 + m_{k+1}}{d_{k+1}}\right\rfloor$
- $p_{k+1} = a_{k+1} p_k + p_{k-1}$, \quad $q_{k+1} = a_{k+1} q_k + q_{k-1}$

We iterate until a convergent satisfies $p_k^2 - n q_k^2 = 1$; this first
occurrence yields the minimal $(x, y)$.  All arithmetic on $p_k$ and $q_k$ uses
arbitrary-precision integers.
