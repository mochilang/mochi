# PERIOD - Period

[Problem on SPOJ](https://www.spoj.com/problems/PERIOD/)

For every prefix of the string `S` we need to determine whether it can be expressed as repetitions of some smaller substring. The length of the prefix is `i` and we want the largest `K > 1` such that the prefix equals `A` repeated `K` times where `A` has length `i / K`.

## Algorithm

We use the prefix-function from the Knuth–Morris–Pratt algorithm:

1. For the whole string compute `pi[i]` – the length of the longest proper prefix which is also a suffix of `S[0..i]`.
2. For each prefix length `L = i + 1` (since `pi` is 0-based) compute `p = L - pi[i]`. If `L` is divisible by `p` and the quotient `K = L / p` is greater than 1, the prefix is periodic with period `K`.
3. Output `L` and `K` for every prefix that satisfies the above condition.

The prefix function can be computed in `O(N)` time and memory, therefore the whole solution runs in `O(N)` per test case.

## Correctness

The prefix function `pi[i]` stores the maximum `x < L` such that the first `x` characters of the string equal the last `x` characters of the prefix of length `L`. If `L` is composed of repeats of a smaller substring of length `p`, then the last `L - p` characters equal the first `L - p` characters, so `pi[i] = L - p`. Rearranging gives `p = L - pi[i]`. If `L` is divisible by `p` and the quotient is greater than 1, then the prefix is exactly repetitions of a substring of length `p`.

## Complexity

Let `N` be the length of `S` (up to 1e6). Computing the prefix function takes `O(N)` time and `O(N)` space. The final scan over the prefix function is also `O(N)`, so the total complexity per test case is `O(N)`.

