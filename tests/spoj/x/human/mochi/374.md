# [Count maximum matrices](https://www.spoj.com/problems/MATRIX/)

## Problem Summary
Given an M×N binary matrix, consider every submatrix. The value of a submatrix is the number of ones on its border minus the number of zeros on its border. Let W be the maximum value among all submatrices and S the number of submatrices attaining W.

## Algorithm
1. Convert each cell to +1 for 1 and -1 for 0 so a rectangle's value becomes the sum of these values over its perimeter.
2. Precompute column prefix sums to query vertical border sums quickly.
3. For every pair of rows `(r1, r2)`:
   - For each column `j` compute `tb[j]` = value contributed by the top and bottom cells and `vert[j]` = sum of values between `r1` and `r2` in column `j`.
   - Build prefix sums of `tb` and scan columns from left to right, keeping the best left column contribution `vert[k] - prefix[k-1]` and its count.
   - For each right column `j` compute the best rectangle ending at `j` using this maximum and update the global maximum `W` and count `S`. Single-column rectangles are handled separately.
4. The scan is `O(N)` for fixed rows, giving total complexity `O(M^2 · N)`.

## Complexity
`O(M^2 · N)` time and `O(N)` extra space.
