# [Blue Mary Needs Help Again](https://www.spoj.com/problems/CASHIER/)

## Problem Summary
Maintain a dynamic multiset of worker wages with the following operations:

- `I x` – add a worker with wage `x` if `x \ge MIN`.
- `A x` – increase all wages by `x`.
- `S x` – decrease all wages by `x` and remove any worker whose wage falls below `MIN`.
- `F k` – report the wage of the worker with the k-th highest wage or `-1` if fewer than `k` workers exist.

After processing `M` commands output the number of workers removed during `S` operations.

## Algorithm
Use a Fenwick tree (binary indexed tree) to store counts of wage values relative to a global offset.

- Keep an `offset` that records the cumulative increases and decreases.
- Each inserted wage is stored as `base = wage - offset` so global updates do not touch the tree.
- `A`/`S` adjust `offset`. After an `S` operation remove all entries with `base + offset < MIN` by advancing a pointer and
  deleting their counts from the tree. Track how many workers are removed.
- To answer `F k`, compute the `(total - k + 1)`-th smallest stored `base` using the Fenwick tree and convert it back to an actual wage: `base + offset`.

The tree supports `O(log N)` updates and queries. Because only a limited range of wages is possible, an array-sized Fenwick tree is sufficient.

## Complexity
- Insertion, removal, and k-th query: `O(log W)` where `W` is the wage range (≤ 400000 in this problem).
- Overall memory usage: `O(W)`.
