# [Find The Determinant II](https://www.spoj.com/problems/DETER2/)

## Problem Summary
For each test case given integers `N` and `k`, form an `N × N` matrix with entries `m[i][j] = gcd(i,j)^k`.  Output the determinant of this matrix modulo `1000003`.

## Algorithm
1. For a matrix with entries `g(gcd(i,j))`, the determinant equals `∏_{n=1}^{N} (f * μ)(n)` where `μ` is the Möbius function and `f * μ` denotes Dirichlet convolution.  When `g(n)=n^k`, this convolution is the Jordan totient `J_k(n)`.
2. Thus the determinant is `∏_{n=1}^{N} J_k(n)`.
3. Use the formula `J_k(n) = n^k ∏_{p|n} (1 - p^{-k})` to rewrite
   `det = (N!)^k · ∏_{p≤N} (1 - p^{-k})^{⌊N/p⌋}`.
4. Precompute factorials modulo `1000003` up to the maximum `N` and generate all primes ≤ `N` using the sieve of Eratosthenes.
5. For each test case:
   - `res = pow(fact[N], k) mod 1000003`.
   - For each prime `p ≤ N`: multiply `res` by `(1 - p^{-k})^{⌊N/p⌋}` modulo `1000003` using modular exponentiation and inverses.
6. Print `res` for each test case.

This runs in `O(N log log N + π(N) log k)` per test case, which is feasible for `N ≤ 10^6` and `k ≤ 10^9`.
