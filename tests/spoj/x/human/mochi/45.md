# [Commedia dell' Arte](https://www.spoj.com/problems/COMMEDIA/)

## Problem Summary
Given an $M\times M\times M$ sliding puzzle containing tiles $1\ldots M^3-1$ and one empty slot (0), decide whether the puzzle can be solved to the ordered configuration using legal moves (sliding a neighbouring tile into the empty position).

## Algorithm
1. Read $M$ and the $M^3$ numbers describing the puzzle layers from top to bottom.
2. Treat the blank as tile number $M^3$ and flatten the cube into a oneâ€‘dimensional array in that order.
3. Compute the parity of this permutation using cycle decomposition.
4. From the blank index compute its coordinates $(x,y,z)$.
5. The puzzle is solvable iff
   $$(\text{parity} \oplus ((x+y+z) \bmod 2)) = ((M-1) \bmod 2).$$
6. Output the corresponding sentence.

Each move swaps the blank with a neighbour, toggling both the permutation parity and the parity of $x+y+z$; thus the XOR of these parities is invariant and must match the solved state.
