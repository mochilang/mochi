# [Divisor Summation (Hard)](https://www.spoj.com/problems/DIVSUM2/)

## Problem Summary
For each given integer $n$ ($1 \le n \le 10^{16}$) output the sum of all proper divisors of $n$.
A proper divisor is any divisor smaller than $n$. Exactly 500 test cases are provided.

## Algorithm
1. For each input $n$:
   - If $n = 1$, the result is $0$.
   - Factorise $n$ by trial division. For each prime factor $p$ with exponent $k$, compute the geometric series
     $1 + p + p^2 + \cdots + p^k$ and multiply it into a running product.
   - After processing all prime factors, if a prime factor greater than $\sqrt{n}$ remains, multiply by $(1 + \text{remaining})$.
2. The product of these sums gives $\sigma(n)$, the sum of all divisors of $n$.
3. Subtract $n$ to obtain the sum of proper divisors.

This approach runs in $O(\sqrt{n})$ per test case and is efficient enough for the problem limits.
