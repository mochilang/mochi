# [Sequence Partitioning II](https://www.spoj.com/problems/SEQPAR2/)

## Problem Summary
Given a sequence of N pairs (A_i, B_i) and a limit, split the sequence into contiguous parts.
For every pair in an earlier part its B must be greater than every A in later parts, and the sum of the maxima of A within each part must not exceed the given limit. Let S_i be the sum of B in part i. Find a partition that minimizes the maximum S_i.

## Algorithm
1. Precompute suffix maxima of A to know the largest A value to the right of any position.
2. Binary search on the answer X, the allowed maximum sum of B in a part.
3. To check a candidate X, greedily scan the sequence from left to right, building the longest possible part while
   keeping the running sum of B \le X and tracking the part's minimum B and maximum A.
   - If adding the next pair would exceed X, close the current part.
   - After including an element, if the part's minimum B is \le the maximum A of the remaining suffix, close the part as well.
   - Accumulate the sum of part maxima; if this total exceeds the limit, X is infeasible.
4. If the scan finishes without exceeding the limit, X is feasible. Binary search yields the minimal X.

This runs in O(N log sum(B)) time.
