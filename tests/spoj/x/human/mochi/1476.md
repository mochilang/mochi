# [Maximum Profit](https://www.spoj.com/problems/PROFIT/)

## Problem Summary
CS&T can install some of `n` service stations, paying cost `Pi` for station `i`. There are `m` user groups; group `j` uses stations `Aj` and `Bj` and yields profit `Cj` only if **both** stations are installed. Choose stations to maximize total profit.

## Algorithm
1. Reduce to a maximum-weight closure problem and solve via max flow.
2. Build a flow network with source `S` and sink `T`:
   * For each group `j`, add a node `Gj` and edge `S -> Gj` with capacity `Cj`.
   * Add edges `Gj -> Aj` and `Gj -> Bj` with infinite capacity (forces selecting both stations to keep the profit).
   * For each station `i`, add edge `Si -> T` with capacity `Pi` representing its installation cost.
3. Let `sumC` be the total of all `Cj`. The minimum `S-T` cut of this graph equals the costs of discarded profits plus chosen stations. Compute the max flow `F` using Dinic's algorithm and the answer is `sumC - F`.

With `n ≤ 5000` and `m ≤ 50000`, the graph has up to ~55k nodes and 150k edges, which Dinic's algorithm handles efficiently.
