# [The Archipelago](https://www.spoj.com/problems/ARCHPLG/)

## Problem Summary
Given a collection of rectangular islands, some rectangles inside each island are forbidden to enter. Each island also contains several named terminals, and there are ferry connections between terminals of different islands. Starting from one terminal, find a fastest route to another terminal using ferries and walking, where walking time equals the Euclidean length and is rounded up to the nearest integer. The route should be printed as the total travel time followed by the sequence of terminals and intermediate turning points of the walking paths.

## Algorithm
1. **Per island visibility graph**
   - For every island gather all terminal positions and the four corners of each restricted rectangle.
   - Connect two points with an edge if the straight segment joining them does not pass through the interior of any rectangle.
   - Run Dijkstra on this visibility graph for each pair of terminals to obtain the minimal walking distance and the actual corner sequence used.

2. **Global terminal graph**
   - Create a graph whose nodes are all terminals across all islands.
   - Add an edge between two terminals on the same island with weight equal to the ceiling of the walking distance computed above. Store the path’s corner sequence for reconstruction.
   - Add edges for every ferry connection with their given travel time.

3. **Route search**
   - Run Dijkstra from the start terminal to the goal terminal in the global graph.
   - Reconstruct the route: for consecutive terminals on the same island, expand the stored corner sequence between them; for ferry legs simply list the terminal names.

This visibility‑graph approach yields an optimal route respecting forbidden rectangles and ferry times.
