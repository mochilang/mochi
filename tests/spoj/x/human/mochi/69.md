# [Moulds](https://www.spoj.com/problems/MOULDS/)

## Problem Summary
A cutting device with a 1×1×30 mm blade starts 1 mm above the north‑west corner of a 250×250×30 mm block. A program consisting of commands:

- `^d` — move vertically by `d` millimetres (down if `d > 0`, up if `d < 0`).
- `@D d` — move `d` millimetres horizontally in direction `D` (`N`, `S`, `E`, `W`).
- Commands may be grouped inside brackets `[ ... ]` with each command terminated by `;`.

For each program, compute the volume in cubic millimetres of material removed from the block.

## Algorithm
1. Parse the command block recursively. Each `[ ... ]` expands to a sequence of commands.
2. Track current blade position `(x, y)` and the depth `z` of the blade's bottom relative to the top surface (start `z = -1`).
3. Maintain a map recording which 1×1×1 mm cells inside the 250×250×30 block have already been removed. When a new cell is encountered, increment the volume counter.
4. For `^d`:
   - Update `z += d`.
   - If moving downward (`d > 0`), mark every cell at `(x, y)` whose depth lies between the previous and new `z` values.
5. For `@D d`:
   - Determine step direction from `D` and sign of `d`.
   - Move one millimetre at a time, updating `(x, y)` and marking all cells vertically covered by the blade at each intermediate position.
6. After processing all commands, output the accumulated volume.

The grid contains at most 250×250×30 cells and command length is limited, so the simulation runs in at most a few million operations.
