# [Submatrix of submatrix](https://www.spoj.com/problems/MATRIX2/)

## Problem Summary
Given an \(N \times M\) matrix of integers generated from the first column, find an \(A \times B\) submatrix \(Q\) and a \(C \times D\) submatrix \(K\) fully inside \(Q\) (not touching the border) that maximize the difference \(\text{sum}(Q) - \text{sum}(K)\).

## Algorithm
1. Construct the full matrix using the provided recurrence from the first column values.
2. Build a 2D prefix-sum array to query sums of arbitrary submatrices in constant time.
3. If either \(C\) or \(D\) is zero, there is no inner submatrix, so simply take the maximum sum of any \(A \times B\) submatrix.
4. Otherwise:
   - Precompute sums of all \(C \times D\) submatrices using the prefix sums.
   - Use two passes of monotonic queues to obtain, for every position of an \(A \times B\) submatrix \(Q\), the minimum sum of a \(C \times D\) submatrix inside \(Q\): first compute vertical sliding minima with window height \(A-C-1\), then horizontal sliding minima with window width \(B-D-1\).
   - For each \(Q\), compute its sum via prefix sums and subtract the precomputed minimal inner sum. Keep the maximum difference.

The approach runs in \(O(NM)\) time and requires \(O(NM)\) memory.
