# MAWORK - Men at work

[Problem statement](https://www.spoj.com/problems/MAWORK/)

## Algorithm

We are given an `N x N` grid (`N <= 25`). Each cell is initially either open `.` or blocked `*`.  For every cell a digit `p` (0-9) specifies the duration of its working/rest periods:

* if `p = 0` the cell never changes its initial state,
* otherwise the cell alternates between blocked and open every `p` time units, starting with the state given at time `0`.

At time `t` we may move to any of the four neighbouring cells or stay in place, but we must be on an open cell at both time `t` and `t+1`.  Each move costs one time unit.  We must find the minimum time to travel from `(0,0)` to `(N-1,N-1)`.

The pattern of every cell is periodic with period `2p`.  The lcm of all periods is at most `5040`, so the entire grid repeats every `cycle` time units.  Therefore it is sufficient to search the state space `(row, col, time mod cycle)`.

We perform a breadth‑first search:

1. Compute `cycle` as the lcm of all `2p` values (`cycle = 1` if all `p = 0`).
2. Maintain a queue of states `(r, c, t)` and a visited array indexed by `(r, c, t mod cycle)`.
3. Start from `(0,0,0)` if the starting cell is open.
4. Repeatedly pop from the queue, exploring the five possible moves (four directions and staying in place).
   Push the next state if the destination cell is open at `t+1` and it hasn't been visited with that time remainder.
5. When `(N-1,N-1)` is dequeued, the current time is the answer.  If the queue becomes empty, output `NO`.

## Correctness

The grid configuration repeats every `cycle` time units.  By considering time modulo `cycle`, any state occurring after that time will already have been seen.  The BFS explores states in non‑decreasing order of time, so the first time the target cell is reached is the shortest possible travel time.  All moves are only to cells confirmed to be open at the moment of arrival, thus any path found is valid.  If BFS ends without reaching the target, no sequence of valid moves can connect home to work.

## Complexity Analysis

Let `cycle` be the lcm of all `2p` values (`cycle <= 5040`).
The BFS visits at most `N * N * cycle` states.  For each state we examine up to five moves.
Therefore the time complexity is `O(N^2 * cycle)` and the same bound holds for memory usage.

