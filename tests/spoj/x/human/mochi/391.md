# [Railroads](https://www.spoj.com/problems/RAILROAD/)

## Problem Summary
Given train schedules for several cities, find the route that allows Jill to travel from a starting city to a destination as early as possible.  If several connections arrive at the same earliest time, choose the one that leaves the starting city as late as possible.  Trains can be changed instantly and only depart/arrive at listed times.

## Algorithm
1. **Event graph construction**
   - Each timetable entry `(city, time)` becomes an event node.
   - For every consecutive stop in a train's route add a directed edge to the next stop.
   - For each city, sort its events by time and link consecutive events to allow waiting until the next departure.
   - A virtual event at the start time in the starting city is inserted so waiting from the given time is possible.
2. **Modified Dijkstra search**
   - Run Dijkstra on the event graph where the key is the arrival time of nodes.
   - Each state also tracks the departure time from the starting city.  This value is set when leaving the starting city for the first time and is propagated along the path.
   - When relaxing edges, update a node if we can reach it with the same arrival time but a later departure from the start.
3. **Result extraction**
   - Among all events in the destination city reachable on the same day, choose the one with the earliest arrival; break ties by larger departure time.

The graph has at most `1000 * 100` events, and each edge is processed once by Dijkstra, giving a time complexity of roughly `O(E log V)`.
