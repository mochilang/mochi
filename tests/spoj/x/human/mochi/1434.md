# KPEQU - Equation

[Problem statement](https://www.spoj.com/problems/KPEQU/)

## Algorithm

We need the number of positive integer pairs \((X,Y)\) satisfying

\[ \frac{1}{N!} = \frac{1}{X} + \frac{1}{Y}. \]

Rearranging gives

\[ (X - N!)(Y - N!) = (N!)^2. \]

Every divisor \(d\) of \((N!)^2\) yields a solution
\(X = N! + d\) and \(Y = N! + \frac{(N!)^2}{d}\).
Thus the answer equals the number of positive divisors of \((N!)^2\).

For each prime \(p \le N\), the exponent of \(p\) in \(N!\) is

\[ e_p = \sum_{k\ge1} \left\lfloor \frac{N}{p^k} \right\rfloor. \]

Then \((N!)^2\) has exponent \(2e_p\) of \(p\), so the divisor count is

\[ \prod_{p\le N} (2e_p + 1). \]

We sieve primes up to 10\^4, compute each \(e_p\) using repeated division,
and multiply the factors using arbitrary-precision integers.
The algorithm runs in roughly \(O(N \log \log N)\) per test case due to the prime sieve and exponent calculations.
