# [Triple-Free Sets](https://www.spoj.com/problems/TFSETS/)

## Problem Summary
Count the number of subsets of {1..n} that never contain both x and 2x or both x and 3x. For each test case (n up to 100000) output the count modulo 1,000,000,001.

## Algorithm
1. Numbers split into independent components r·2^a·3^b where r is not divisible by 2 or 3.
2. For a component with bound m = floor(n/r), the valid subsets equal the number of independent sets in the grid of powers {2^a·3^b ≤ m}. These counts H(m) depend only on m and change only when m itself is of the form 2^a·3^b.
3. Precompute H(t) for all t = 2^a·3^b ≤ 100000 and embed them in the program.
4. For each n, group integers by equal quotient q = floor(n / x). For each group, compute how many r in the group are coprime with 6 and multiply the result by H(q) raised to that count.
5. Use fast modular exponentiation and inclusion–exclusion to count numbers coprime with 6.

## Complexity
Precomputation is constant. Each test case runs in O(√n) time.
