# [Farmer](https://www.spoj.com/problems/FARMER/)

## Problem Summary
Given several fields (circular) and strips (linear) of cypress trees with olive trees between consecutive cypresses, the farmer's son may choose exactly `Q` cypress trees. He inherits every olive tree between any two consecutive cypresses he selects. In a strip or partially selected field, choosing `k` cypresses yields `k-1` olives. Selecting all `N` cypresses of a field yields `N` olives. Determine the maximum number of olive trees obtainable.

## Algorithm
We model the choice as a knapsack over the number of selected cypress trees.

1. For each field of size `N`:
   - Option `k=0`: `0` olives.
   - For `1 <= k < N`: `k-1` olives.
   - For `k = N`: `N` olives.
2. For each strip of size `R`:
   - Option `k=0`: `0` olives.
   - For `1 <= k <= R`: `k-1` olives.
3. Maintain `dp[i]` = maximum olives obtainable using exactly `i` cypress trees. Initialize `dp[0] = 0`, others to `-inf`.
4. For every component, update `dp` in reverse order to prevent reuse:
   - For each allowed `k`, if `dp[i]` is valid and `i+k <= Q`, update `dp[i+k]` with the candidate value.
5. After processing all components, `dp[Q]` is the answer.

The complexity is `O((M+K)*Q*max_size)` which is sufficient for the provided test cases.
