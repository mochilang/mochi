# SPOJ 1810 - Nuclear Plants (ORZ)

The rectangular plain of size `n x m` may contain circular exclusion zones
around nuclear plants. Small plants forbid a circle of radius `0.58` km
and large plants forbid radius `1.31` km.  We must compute the arable
area of the rectangle after removing the union of all forbidden discs.

## Algorithm

We integrate along the x-axis the length of the vertical sections that are
covered by at least one circle.  Let `F(x)` be the total length of the union
of circle intersections with the vertical line at position `x` (clipped to
`0 <= y <= m`).  Then the forbidden area inside the rectangle is
`âˆ«_0^n F(x) dx`.

To evaluate `F(x)` we:

1. For each circle, if `|x - cx| < r`, compute the vertical interval
   `[cy - sqrt(r^2 - (x-cx)^2), cy + sqrt(r^2 - (x-cx)^2)]` and clip it to
   `[0, m]`.
2. Sort all intervals by start and merge overlapping ones to obtain their
   union length.

The integral of `F(x)` over `[0,n]` is performed using an adaptive Simpson's
method with absolute error `1e-4`, which is sufficient to keep the final
area within `0.01` of the exact value.  The final result is
`n*m - forbiddenArea` formatted to two decimals.

## Complexity

Let `c` be the number of circles (`<= 200`).  Evaluating `F(x)` costs
`O(c log c)` for sorting the intervals.  Adaptive Simpson requires a few
thousand evaluations in practice, so the overall time is easily within the
limits.  Memory usage is `O(c)`.

