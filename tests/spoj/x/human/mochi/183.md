# [Corporative Network](https://www.spoj.com/problems/CORNET/)

## Problem Summary
Maintain clusters of enterprises. Initially each enterprise is its own cluster and center. Two commands are supported:
- `E I`: report the total length from enterprise `I` to its cluster's center.
- `I I J`: connect center `I` to enterprise `J` in another cluster using a line of length `|I-J| mod 1000`, merging the clusters and keeping `J`'s center.
Input ends with command `O` for each test case.

## Algorithm
Use a weighted disjoint-set union (union-find) structure storing for each node its parent and the distance to that parent.
1. Initialize `parent[i]=i` and `dist[i]=0` for all enterprises.
2. `find(x)` follows parent links to the root, accumulating distances and applying path compression so `dist[x]` becomes the distance to the root.
3. For `E I`, call `find(I)` and output `dist[I]`.
4. For `I I J`, set `parent[I]=J` and `dist[I]=|I-J| mod 1000`.
This allows all operations in nearly constant time with `O(N)` memory.
