# [Brackets](https://www.spoj.com/problems/BRCKTS/)

## Problem Summary
We are given a parenthesis string of length up to 30,000. For each test case a
sequence of operations follows:

- `k > 0`: toggle the `k`-th character between `(` and `)`.
- `k = 0`: check whether the current string is a correct bracket expression.

There are ten test cases (no explicit count). For each check operation we output
`YES` or `NO`, preceded by `Test i:` for the current test case.

## Algorithm
Treat `(` as `+1` and `)` as `-1` and maintain these values in a segment tree.
Each node stores two integers:

- `sum`: total sum of its range.
- `min`: smallest prefix sum within the range.

Building the tree sets leaves according to the initial string and combines
children with:

```
sum = left.sum + right.sum
min = min(left.min, left.sum + right.min)
```

To toggle a bracket we update a single leaf and recompute its ancestors.
The whole string is a correct bracket expression iff `sum == 0` and `min >= 0`
for the root.

Building costs `O(n)` and each update or check runs in `O(log n)`, easily
handling the constraints.
