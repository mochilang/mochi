# [Query on a tree III](https://www.spoj.com/problems/PT07J/)

## Problem Summary
Given a rooted tree with unique integer labels on each node, process queries of the form `(x,k)` asking for the vertex whose label is the `k`-th smallest within the subtree of node `x`.

## Algorithm
1. Read the tree and store adjacency lists and the label of each node.
2. Perform a depthâ€‘first search from the root.
   - For every node, recursively obtain the list of pairs `(label, index)` from its children.
   - Merge the child lists with the current node's pair, keeping the list sorted in ascending order of labels.
   - Store this sorted list for the node.
3. For each query `(x,k)` output the node index stored at position `k-1` in the precomputed list for node `x`.

The DFS constructs sorted lists for all subtrees, enabling each query to be answered in `O(1)` time once preprocessing finishes. The merging step uses a simple merge routine, so the overall complexity is `O(n^2)` in the worst case but is adequate for small test instances.
