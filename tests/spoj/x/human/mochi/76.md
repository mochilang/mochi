# [Editor Inverse](https://www.spoj.com/problems/EDIT2/)

## Problem Summary
Given a string with no `d` characters, determine the minimum number of keystrokes
needed to reproduce it in a special text editor. The editor supports typing any
character, duplicating the current line with `d`, and starting a new line with a
newline. Two consecutive newlines terminate the program. Besides minimizing
keystrokes, use the fewest lines and for each line minimise the number of `d`
operations.

## Algorithm
1. For every substring `s[i:j]` compute the best way to build it from an empty
   line. Dynamic programming is used:
   - appending the last character costs `cost[i][j-1] + 1`;
   - if the substring is made of two equal halves, duplicating the first half
     costs `cost[i][mid] + 1`.
   The number of `d` operations is stored to break ties.
2. Another DP partitions the string into lines. `dp[k]` keeps the minimal total
   cost up to position `k`, together with the number of lines and the sequence of
   line costs for tie breaking. Transition `j -> k` adds the cost of
   `s[j:k]` and one newline.
3. Reconstruct the chosen partition and, for each line, rebuild the sequence of
   keys by backtracking through the `cost` table (favouring appends when tied).
4. Print the total keystrokes plus the final terminating newline followed by the
   lines of key presses and an empty line.

This approach visits all substrings, running in `O(n^3)` time for strings of
length up to 600, which is sufficient for the problem limits.
