# [Number of quite different words](https://www.spoj.com/problems/NUMQDW/)

## Problem Summary
Given an alphabet of the first `c` uppercase letters and a word `w`, count the number of length-`n` words that have no common subsequence of length greater than one with `w`. Output the count modulo 4242.

## Algorithm
1. Scan `w` and record for every ordered pair of letters `(a,b)` whether `a` appears before `b` in `w`. This also records `(a,a)` if a letter repeats.
2. Treat states as subsets of letters already used (at most `2^c` states). From state `S` we may append letter `b` only if:
   - For every `a` in `S`, the pair `(a,b)` was **not** seen in step 1.
   - If `b` is already in `S` and `(b,b)` was seen, we cannot use `b` again.
   The transition goes to `S ∪ {b}`.
3. Build the `2^c × 2^c` transition matrix `M` counting valid moves. The number of valid words of length `n` is the sum of components of `v₀ · Mⁿ`, where `v₀` is `[1,0,…,0]`.
4. Exponentiate `M` with fast exponentiation; each multiplication and vector product is done modulo 4242.

## Complexity
At most `64` states. Matrix multiplication is `O(64³)` and executed `O(log n)` times.
