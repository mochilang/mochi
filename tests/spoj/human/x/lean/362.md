# Ignore the Garbage

[SPOJ Problem](https://www.spoj.com/problems/IGARB/)

## Algorithm

We look at the display upside‑down.  A number is valid only if every digit
remains a digit after rotating the display by 180°:
`0 ↔ 0`, `1 ↔ 1`, `2 ↔ 2`, `5 ↔ 5`, `6 ↔ 9`, `8 ↔ 8`, `9 ↔ 6`.
When the display counts upwards from 1 we only see numbers composed of
these seven digits.  They appear in strictly increasing order, therefore the
set of valid numbers is identical to all positive integers written with this
digit set.

For the *K*-th number we do not simulate all numbers.  Instead we treat the
sequence like a base‑7 counter:

1. The first digit has six possibilities (`1,2,5,6,8,9`), every following digit
   has seven possibilities (including `0`).  For each length `L` there are
   `6·7^(L‑1)` numbers.  We find the smallest `L` such that the cumulative count
   reaches `K` and obtain a zero‑based index inside this block.
2. Convert the index to base‑7 and map digits to the digit set, producing the
   actual number on the display.
3. To get what we read, reverse the digits and replace `6`↔`9` according to the
   rotation mapping.  Leading zeroes are preserved.

## Correctness

We prove the algorithm outputs the *K*-th readable number.

*Lemma 1.* Every displayed number counted in the process uses only digits from
`{0,1,2,5,6,8,9}`.

*Proof.* Any number containing `3,4,7` becomes meaningless after rotation and is
skipped.  Thus only the seven listed digits remain. ∎

*Lemma 2.* For length `L` there are exactly `6·7^(L‑1)` valid numbers.

*Proof.* The first digit cannot be `0`, giving six choices.  Each of the
remaining `L‑1` positions may use any of the seven valid digits, so the total is
`6·7^(L‑1)`. ∎

*Lemma 3.* The procedure in step 1 selects the correct length and index for the
* K*-th number.

*Proof.* By Lemma 2 the cumulative counts up to length `L` exactly cover the
first numbers of the sequence.  Subtracting these counts from `K` leaves the
position inside the block of length `L`. ∎

*Lemma 4.* Converting the index to base‑7 and mapping digits produces the actual
number with that index.

*Proof.* Enumerating all length‑`L` numbers in lexicographic order corresponds to
a base‑7 counter where digits are replaced by the valid digit set.  Therefore
the mapping yields the exact `K`‑th displayed number. ∎

*Lemma 5.* Reversing the digits and applying the rotation mapping yields the
visible number when the display is viewed upside‑down.

*Proof.* Rotating by 180° reverses digit order and substitutes each digit with
its partner (`6`↔`9`).  Applying these operations recreates exactly what is read
on the display. ∎

*Theorem.* The algorithm outputs the *K*-th valid number shown on the upside‑down
display.

*Proof.* Combining Lemmas 3–5, the algorithm constructs the actual number with
index `K` and transforms it to the viewed number, hence the output is exactly
the *K*-th readable number. ∎

## Complexity Analysis

Let `L` be the number of digits of the answer.  Finding `L` iterates at most `L`
times and each step uses big‑integer arithmetic.  Building the digits and
rotating them also run in `O(L)` time.  Therefore the overall complexity is
`O(L)` with `L ≤ log_7(K) + 1`.

## References

- 7‑segment digit rotations
- Base‑k combinatorial generation
