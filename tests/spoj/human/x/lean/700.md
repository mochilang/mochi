# SPOJ BPRED - Branch Prediction

Given a simple program consisting of `N` labeled instructions. Each instruction
has a **branch label**. Execution starts at label `start`. For a general
instruction:

- with probability `P` control jumps to its branch label,
- with probability `1-P` control proceeds to the next instruction in the file.

The last instruction is always `end`, which terminates execution. When the
instruction `start` is executed control always goes to the next instruction,
and `end` always finishes. The task is to compute the expected number of times a
target label `L` is executed.

## Algorithm

1. Map every label to its line index and build arrays of current labels and
   branch targets.
2. For each line `i` with label `s_i` we write a linear equation for the
   expected executions `E_i` when control reaches this line:
   - if `s_i = end` then `E_i = [s_i = L]`;
   - if `s_i = start` then `E_i - E_{i+1} = [s_i = L]`;
   - otherwise `E_i - P·E_{b_i} - (1-P)·E_{i+1} = [s_i = L]`,
     where `b_i` is the index of the branch target and `[s_i = L]` is `1` when
     `s_i` equals the target label and `0` otherwise.
3. This yields a system of `N` linear equations which we solve via Gaussian
   elimination over floating point numbers.
4. The required expectation is `E_start`.

The result is printed with five digits after the decimal point.
