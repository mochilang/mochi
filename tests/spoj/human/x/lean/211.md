# [PRIMIT - Primitivus recurencis](https://www.spoj.com/problems/PRIMIT/)

Given a set of directed edges `(l, r)`, we need the shortest sequence of
numbers where each edge appears as a consecutive pair at least once. Extra
pairs not in the set may appear.

## Algorithm

- Build a directed graph with vertices `1..1000`.
- Track `in` and `out` degree for each vertex and union them in a DSU to
  determine weakly connected components containing edges.
- For every component:
  - Let `P` be the sum over its vertices of `max(0, out - in)`.
  - Additional edges needed inside the component = `max(0, P - 1)`.
- Let `c` be the number of components with at least one edge.
- The minimal sequence length equals `n + c + Σ max(0, P - 1)` where `n` is
  the number of features (edges).

## Correctness

The DSU groups edges by component. In any component the surplus of outgoing
degree `P` determines how many edges must be repeated to obtain an Euler
trail; a trail can start and end at vertices with surplus and deficit, hence
only `P - 1` repeats are necessary. Concatenating components requires `c - 1`
extra connecting edges, which together with the `+1` for the starting vertex
results in the formula above.

## Complexity

`O(n α(V))` where `n` is the number of features and `α` is the inverse Ackermann
function from DSU operations. The limits `l, r ≤ 1000` keep arrays small.
