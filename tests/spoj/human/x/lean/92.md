# [Cutting off Squares](https://www.spoj.com/problems/CUTSQRS)

## Problem Summary
Players alternately cut off one or more squares of size `a×a` from a rectangle `a×b` (`a ≤ b`). Each move removes `m` such squares where `1 ≤ m ≤ ⌊b/a⌋`. The player who removes the last piece wins. For each starting pair `(a, b)`, Michael wants to know:

* the number of different possible game sequences,
* how many of these sequences end with the starting player winning,
* whether the starting player can force a win regardless of the opponent.

We must output the total number of characters needed to write these three values (numbers are written in decimal without spaces, and the word "first" or "second").

## Algorithm
1. Run the Euclidean algorithm on `(a, b)` obtaining quotients `q1, q2, …, qn`.
2. The number of possible game sequences is `2^(Σqi − n)`, because each quotient `qi` can be split into any composition of positive integers.
3. If `Σqi − n > 0`, exactly half of these sequences end with the starting player; otherwise both totals are `1`.
4. Determine whether the starting player has a forced win using the standard strategy for Euclid's game: while `b % a ≠ 0` and `b / a = 1`, replace `(a, b)` with `(b − a, a)` and swap turns. If at any moment `b % a = 0` or `b / a ≥ 2`, the current player wins.
5. Convert `2^e` to its number of decimal digits using `⌊e·log10(2)⌋ + 1` (we use a high-precision rational approximation of `log10(2)`), and sum digit counts plus `5` for "first" or `6` for "second".

## Complexity
The Euclidean algorithm runs in `O(log(max(a, b)))` steps. All other operations are arithmetic on integers of the same magnitude, so the overall complexity is `O(log(max(a, b)))`.
