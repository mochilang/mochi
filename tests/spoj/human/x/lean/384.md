# SPOJ FOOL solution in Lean

We parse the word using a small recursive descent parser.  Because the alphabet
(`{`, `}`, `,`) overlaps with the syntax itself, the grammar is ambiguous and we
need backtracking.

For a list of characters we define four mutually recursive functions:

- `parseSet` parses a set starting with `{` and returns all possible remainders
  after the closing `}`.
- `parseElementList` either leaves the list unchanged (empty set) or delegates to
  `parseList` for nonâ€‘empty lists.
- `parseList` parses an element and, if a comma follows, continues with another
  element.
- `parseElement` treats a leading `{` either as another set or as the atom `{`;
  `}` and `,` are always valid atoms.

Each function returns every possible suffix after a successful parse.  The input
word represents a set when at least one parse consumes all characters.  Lines
are processed individually and the result is printed in the required format.
