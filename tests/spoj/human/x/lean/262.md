# CONNECT - Connections

Source: https://www.spoj.com/problems/CONNECT/

## Algorithm

The task is to answer queries asking for the length of the k-th shortest path
between two nodes in a directed graph. Edge weights are positive and cycles are
allowed. Each query uses k up to 100 and the number of vertices is at most 100,
so we can enumerate k shortest paths using a modified Dijkstra.

For a fixed source `s` and a limit `maxK`, we keep for each vertex how many
paths have been produced so far. A min-heap stores pairs `(distance, node)`. When
we pop `(d, u)` from the heap:

1. If we already produced `maxK` distances for `u` we discard it.
2. Otherwise we record `d` as the next shortest distance to `u` and push
   `(d + w, v)` for every edge `u → v` provided that `v` still needs more
   distances.

Because all weights are positive, distances are generated in nondecreasing
order. The i‑th time we pop `u` we obtain the i‑th shortest distance from `s` to
`u`. We stop when the heap becomes empty or every node has been popped `maxK`
times.

For each test case we gather queries, group them by their source and run the
procedure once per source with `maxK` equal to the maximum `k` among its
queries. The resulting lists of distances let us answer each query directly.

## Complexity

Let `n` be the number of vertices and `m` the number of edges. For a source we
may pop each vertex up to `maxK` times. Every pop expands all outgoing edges.
The time complexity is `O(maxK * m log m)` for one source, which is fast enough
for the limits. Memory usage is `O(n * maxK)`.
