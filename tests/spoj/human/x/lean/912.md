# Submatrix of submatrix (MATRIX2)

We are given an $N\times M$ matrix $P$ with values in $[1,100]$ generated from the
first column by
\[
P[i][j] = (P[i][j-1]\cdot 71 + 17) \bmod 100 + 1.
\]
For each test case we must choose an $A\times B$ submatrix $Q$ and inside it a
$C\times D$ submatrix $K$ that is strictly inside $Q$ (i.e. there is at least
one row and column of margin) so that $\text{sum}(Q)-\text{sum}(K)$ is
maximized.

## Algorithm

1. Build the entire matrix from the given first column and compute a 2â€‘D prefix
   sum table.  This allows the sum of any submatrix to be obtained in constant
time.
2. Compute the sums of all possible $C\times D$ submatrices.  Using a
   monotonic deque we slide a window of width $B-D-1$ horizontally to get the
   minimum $C\times D$ sum for every position in each row, then slide vertically
   with height $A-C-1$ to obtain for every possible $A\times B$ submatrix the
   minimum sum of a valid inner $C\times D$ submatrix.
3. For every $A\times B$ submatrix compute its sum via the prefix table and
   subtract the precomputed minimal inner sum.  Track the maximum difference.

The time complexity is $O(NM)$ and all arrays are at most $1000\times1000$ so
the solution fits easily in memory.
