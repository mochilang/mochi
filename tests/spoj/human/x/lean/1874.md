# SPOJ BWHEELER - Burrows Wheeler Precompression

[Problem Link](https://www.spoj.com/problems/BWHEELER/)

We are given the row number `R` of the original string in the sorted matrix of all rotations and the last column string produced by the Burrowsâ€“Wheeler transform. The task is to recover the original string.

## Algorithm

1. Let `L` be the last column and `n = |L|`.
2. Form the first column `F` by sorting `L`.
3. For each character `c`, record the list of indices where `c` appears in `F`.
4. Scan `L` from left to right and for each character pick the next index from the corresponding list in `F`; this builds an array `lf` mapping each row to the row that precedes it in the original string.
5. Starting from row `R-1`, follow `lf` backwards `n` times, collecting the characters from `L` to reconstruct the string in reverse.
6. Output the recovered string.

Sorting dominates the runtime, giving `O(n log n)` complexity with `n \le 1000`.
