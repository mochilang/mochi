# [Summing to a Square Prime](https://www.spoj.com/problems/CZ_PROB1/)

## Problem Summary
For each test case we are given two integers `n` and `k`. Let `S_P2` be the
sequence of primes that can be written as the sum of two squares. We must find
the `n`‑th element `s = S_P2(n)` and output `p(s, k)`, the number of unordered
partitions of `s` where no part exceeds `k`.

## Algorithm
- A prime belongs to `S_P2` iff it equals `2` or is congruent to `1 (mod 4)`.
  Using a sieve of Eratosthenes up to `8000`, collect the first 500 such primes.
- Precompute partition counts `dp[a][b]` for `0 ≤ a ≤ 8000` and `1 ≤ b ≤ 3`
  using the recurrence
  `dp[a][b] = dp[a][b-1] + dp[a-b][b]` (if `a ≥ b`) with base `dp[0][b] = 1`.
- For each query, retrieve `s = S_P2(n)` and print `dp[s][k]`.

This runs in `O(limit * k)` preprocessing (`limit = 8000`, `k ≤ 3`) and answers
queries in constant time.
