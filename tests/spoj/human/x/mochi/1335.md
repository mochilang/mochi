# [King Ping](https://www.spoj.com/problems/KINGPIN/)

## Problem Summary
Given a W×H grid of cells with K existing walls separating adjacent cells, count how many different mazes can be completed by adding more walls (without removing any) such that there is exactly one simple path between every pair of cells.

## Algorithm
1. Treat each cell as a node in a graph with edges between orthogonal neighbors. Remove edges specified by existing walls.
2. Build the graph's Laplacian matrix: diagonal entries are node degrees; `-1` marks an edge between nodes, `0` otherwise.
3. Apply Kirchhoff's Matrix-Tree Theorem: delete one row and column of the Laplacian and compute the determinant of the remaining matrix.
4. Compute the determinant using the fraction-free Bareiss algorithm with big integers to avoid overflow. The absolute value of this determinant is the number of spanning trees (valid mazes).

The grid has at most 25 cells, so the matrix is at most 24×24 and the algorithm runs in `O(n^3)` time.
