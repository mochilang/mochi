// Solution for SPOJ COMMEDIA - Commedia dell' Arte
// https://www.spoj.com/problems/COMMEDIA/

let digits = {
  "0":0,"1":1,"2":2,"3":3,"4":4,
  "5":5,"6":6,"7":7,"8":8,"9":9,
}

fun parseIntStr(str: string): int {
  var i = 0
  var n = 0
  while i < len(str) {
    n = n * 10 + (digits[str[i:i+1]] as int)
    i = i + 1
  }
  return n
}

fun makeBoolList(n: int): list<bool> {
  var lst: list<bool> = []
  var i = 0
  while i < n {
    lst = append(lst, false)
    i = i + 1
  }
  return lst
}

fun main() {
  let tStr = input()
  if tStr == "" { return }
  let t = parseIntStr(tStr)
  for _ in 0..t {
    let m = parseIntStr(input())
    let total = m * m * m
    var perm: list<int> = []
    var blank = 0
    var count = 0
    var layer = 0
    while layer < m {
      let line = input()
      var idx = 0
      var num = 0
      var has = false
      while idx < len(line) {
        let ch = line[idx:idx+1]
        if ch == " " {
          if has {
            if num == 0 { perm = append(perm, total); blank = count } else { perm = append(perm, num) }
            count = count + 1
            num = 0
            has = false
          }
        } else {
          num = num * 10 + (digits[ch] as int)
          has = true
        }
        idx = idx + 1
      }
      if has {
        if num == 0 { perm = append(perm, total); blank = count } else { perm = append(perm, num) }
        count = count + 1
      }
      layer = layer + 1
    }
    var visited = makeBoolList(total)
    var parity = 0
    var i = 0
    while i < total {
      if (visited[i] as bool) == false {
        var j = i
        var cycleLen = 0
        while (visited[j] as bool) == false {
          visited[j] = true
          j = (perm[j] as int) - 1
          cycleLen = cycleLen + 1
        }
        parity = (parity + ((cycleLen - 1) % 2)) % 2
      }
      i = i + 1
    }
    let x = blank % m
    let y = (blank / m) % m
    let z = blank / (m * m)
    if ((parity + ((x + y + z) % 2)) % 2) == ((m - 1) % 2) {
      print("Puzzle can be solved.")
    } else {
      print("Puzzle is unsolvable.")
    }
  }
}

main()
