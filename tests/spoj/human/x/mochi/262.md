# SPOJ CONNECT - Connections

## Algorithm

1. Build adjacency lists for the directed graph.
2. Collect all source towns appearing in the queries.
3. For each required source, run a modified Dijkstra that tracks up to 100 shortest path lengths to every node:
   - Maintain for each node a sorted list of its best distances (max length 100).
   - Use a min-heap of `(distance, node)` states.
   - When a new distance to a node improves its list, push it into the heap.
4. After preprocessing, answer each query using the precomputed distance lists; if a node has fewer than `k` distances, output `-1`.

## Correctness

The algorithm explores paths in nondecreasing order of total length thanks to the min-heap. Each time a shorter path to a node is found, it is inserted into that node's list and propagated to neighbors. Because a node keeps only the 100 smallest distances, every possible route considered for propagation is a candidate for one of the first 100 shortest paths. Therefore after processing, each node's list contains its first 100 shortest route lengths from the source. For any query `(c, d, k)`, the k-th shortest path length from `c` to `d` is exactly the `k`-th entry of the list; if it does not exist, no such route exists.

## Complexity

Let `n` be the number of towns and `m` the number of roads. For each source we process at most 100 distances per node. The modified Dijkstra runs in `O(m * 100 log(m))` time and uses `O(n * 100)` memory. Given `n ≤ 100` and `k ≤ 100`, this comfortably meets the problem limits.

