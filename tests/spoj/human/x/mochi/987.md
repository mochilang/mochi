# [MOBILE - Mobile](https://www.spoj.com/problems/MOBILE)

Manfred lists for every pair of CDs the height of the lowest bar that holds
them both.  For the matrix to correspond to a valid mobile, these heights must
form an **ultrametric**: for every triple of CDs the largest two heights among
the three pairs are equal.

## Algorithm

1. Read the \(N \times N\) matrix and verify basic properties: zero diagonal,
   symmetry and entries in \((0, 2048)\).
2. Bucket all pairs by their height (the matrix values are < 2048).
3. Use a disjoint set union (union-find) structure.  For each height `h` in
   ascending order, merge the clusters connected by pairs of that height.
   Before merging two clusters we check that every cross pair between them has
   distance `h`; if any differs, the matrix is invalid.
4. If all merges succeed the matrix is ultrametric and the mobile can be built.

Each pair is examined at most once, giving \(O(N^2)\) time and memory.
