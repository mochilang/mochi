# [Flat broken lines](https://www.spoj.com/problems/FLBRKLIN/)

## Problem Summary
Given up to 30,000 points with integer coordinates, a **flat broken line** is a polyline drawn from left to right where every segment's slope is between `-1` and `1`. A point is covered if it lies on the polyline. Determine the minimal number of flat broken lines needed to cover all points.

## Algorithm
1. For each point `(x, y)` compute
   - `a = y - x`
   - `b = y + x`
   A segment from point `i` to `j` is valid iff `a_j \le a_i` and `b_j \ge b_i`, so in any valid polyline `a` decreases while `b` increases.
2. Sort all points by decreasing `a` and, when `a` is equal, by increasing `b`.
3. Process the sorted points and greedily partition them into the fewest chains where `b` is non-decreasing:
   - Maintain a list of chain tails (their last `b` values) in **descending** order.
   - For each `b`, binary search the first tail `\le b` and replace it with `b`.
   - If no such tail exists, start a new chain by appending `b`.
4. After all points are processed, the number of tails equals the minimal number of flat broken lines.

The sorting step is `O(n log n)` and each point update performs a binary search on the current number of chains, also giving `O(n log n)` time and `O(n)` memory.
