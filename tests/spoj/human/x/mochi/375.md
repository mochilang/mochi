# [Query on a tree](https://www.spoj.com/problems/QTREE/)

## Problem Summary
Given a tree with weighted edges, support two online operations:
1. `CHANGE i ti` – update the weight of the `i`-th edge to `ti`.
2. `QUERY a b` – report the maximum edge weight along the simple path between
   nodes `a` and `b`.
Each test case ends with the token `DONE`.

## Algorithm
1. **Heavy-Light Decomposition**
   * Run a DFS from the root to compute parent, depth, subtree size and the
     heavy child of every node while mapping each edge to its deeper endpoint.
   * Decompose the tree into heavy paths and assign each node a position in a
     linear base array; the value at a node's position represents the weight of
     the edge connecting it to its parent.
2. **Segment Tree**
   * Build a segment tree over the base array supporting point updates and
     range maximum queries.
3. **Processing Operations**
   * `CHANGE`: update the segment tree at the position corresponding to the
     deeper endpoint of the specified edge.
   * `QUERY`: climb from both nodes towards the root, jumping along heavy
     paths. For each segment, query the segment tree and keep the maximum value.
     Once both nodes are on the same heavy path, perform a final query between
     their positions (excluding the LCA node).

This approach provides `O(log N)` time per operation, satisfying the problem
constraints for `N ≤ 10^4`.
