# [Substitution Cipher](https://www.spoj.com/problems/SCYPHER/)

## Problem Summary
Given several encrypted dictionary words produced from lexicographically sorted plain words using an unknown substitution cipher over the first A lowercase letters, determine if the substitution is uniquely determined. If so, decrypt the provided message; otherwise report that the message cannot be decrypted.

## Algorithm
1. For each pair of consecutive encrypted words, find the first position where they differ. Add a directed edge from the letter in the first word to the letter in the second word. If the later word is a prefix of the earlier word, the input is inconsistent.
2. Perform Kahn's topological sort on the A letters while enforcing uniqueness: at every step there must be exactly one node with zero in-degree. A cycle or multiple choices imply the message cannot be decrypted uniquely.
3. If a unique order is obtained for all letters, map the first letter in the order to 'a', the second to 'b', etc., yielding the substitution table.
4. Translate the encrypted message using this table, leaving characters outside the alphabet unchanged.

The procedure runs in O(AÂ² + total input size).
