# SPOJ 1839 - Compact Book Storage

We must split the books into three non-empty shelves.  Each shelf height is
defined by the tallest book placed on it and the shelf width is the sum of the
thicknesses of the books in that shelf.  The bookcase area is therefore
`max(widths) * (h1 + h2 + h3)` where `widths` are the three shelf widths and
`hi` are the maximum heights on each shelf.  We search for the partition that
minimises this area.

## Algorithm

1. Read all books and sort them in decreasing order of height.  When processing
   books in this order the first book assigned to a shelf fixes the height of
   that shelf; later books placed on that shelf never increase the height.
2. Use dynamic programming on the accumulated thickness placed on the first two
   shelves.  Let `dp[w1][w2]` be the minimal sum of shelf heights after
   distributing the processed books such that shelf one uses width `w1` and
   shelf two uses width `w2`.  The third shelf width is implicit: `w3 = total -
   w1 - w2`.
3. For each book with thickness `t` and height `h` update the DP by trying to
   place the book on each shelf.  When a shelf is used for the first time we add
   `h` to the cost because that book becomes the tallest on that shelf.
4. After processing all books iterate over all states with nonâ€“zero widths for
   the three shelves.  Compute `width = max(w1, w2, w3)` and area `width * cost`;
   keep the minimum.

The thickness of each book is at most 30 and there are at most 70 books, so the
maximum width considered is only 2100.  The DP table therefore fits easily in
memory and runs quickly.

## Correctness

The DP considers every possible distribution of books among the three shelves
because for each book we try all three choices.  Heights are accounted for by
processing books in descending order and adding the height when a shelf receives
its first book.  Thus `dp[w1][w2]` holds the minimal sum of the three shelf
heights achievable with the given widths.  At the end we evaluate every valid
combination of widths, guaranteeing that the minimal area is found.

## Complexity Analysis

Let `S` be the total thickness of all books (at most 2100).  The DP uses a
`S x S` table and processes each book once, leading to a time complexity of
`O(n * S^2)` and a memory usage of `O(S^2)`.  With the problem constraints this
is easily within the limits.

