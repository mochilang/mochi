# [Land for Motorways](https://www.spoj.com/problems/MLAND/)

## Problem Summary
Given \(n\) cities and \(m\) possible roads, the cost of road \(i\) at time \(t\) is \(a_i t + b_i\). We may choose any real time \(t\) in \([t_1,t_2]\); at that moment prices are frozen and we buy a set of roads of minimum total cost connecting all cities (a minimum spanning tree). We act as an intermediary earning a commission proportional to that total cost, so we want the time that maximizes this minimal cost (if negative, choose the least negative cost). Output the earliest optimal time and the corresponding cost, both with three decimals.

## Algorithm
1. For a given time \(t\) compute the MST cost and the slope:
   - Evaluate each edge's weight \(w_i(t) = a_i t + b_i\).
   - Keep the cheapest edge between each pair of cities and run Prim's algorithm, tracking both the weight and its slope.
   - The MST cost is the sum of selected weights and the derivative is the sum of their slopes.
2. The MST cost function is a concave piecewise‑linear function of \(t\) whose derivative is the slope from step 1 and is non‑increasing.  
   - If slopes at both \(t_1\) and \(t_2\) are non‑positive, the maximum is at \(t_1\).  
   - If both are non‑negative, the maximum is at \(t_2\).  
   - Otherwise, the slope crosses zero inside the interval. Perform a binary search for the earliest \(t\) where the slope \(\le 0\).
3. Recompute the MST cost at the selected \(t\) and format time and cost to three decimals.

This needs about 80 MST evaluations per test case. Each MST handles up to 820 edges and 120 vertices, so the overall complexity is manageable. Memory usage is \(O(n+m)\).
