# [Balancing the Stone](https://www.spoj.com/problems/SCALES)

## Problem Summary
We are given N weights of powers of two (1,2,4,...,2^{N-1}) and a stone of weight W on the left pan. Each weight can be placed on the left, the right, or not used. Count how many placements balance the scale, i.e. the total weight on the right equals the left (stone plus left weights). Output the count modulo D. The weight W is provided as an L-bit binary string with L ≤ N.

## Algorithm
For each weight 2^i choose a coefficient c_i from {-1,0,1} representing placing the weight on the left (-1), unused (0), or on the right (+1). We need assignments such that Σ c_i·2^i = W. Process bits from least significant to most significant with dynamic programming on a carry value c in {-1,0,1} representing excess carried to the next bit.

At bit i with target bit w_i, try all three choices d ∈ {-1,0,1}. If `(c + d - w_i)` is even and the next carry `nc = (c + d - w_i) / 2` lies in {-1,0,1}, accumulate the number of ways into state `nc`. Start with carry 0. Bits beyond L use w_i = 0. After processing N bits the answer is the number of ways with final carry 0 modulo D.

The dynamic program uses constant memory and runs in O(N) time.
