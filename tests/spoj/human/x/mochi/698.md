# [Plane Hopping](https://www.spoj.com/problems/PLHOP/)

## Problem Summary
Given an integer `K` and an `NÃ—N` matrix of ticket costs between every pair of cities (including self-loops), compute for each pair `(i, j)` the minimal cost to travel from city `i` to city `j` using at least `K` flights. Multiple test cases are provided.

## Algorithm
1. Because all costs are non-negative, the cheapest route with at least `K` flights is the cheapest route with exactly `K` flights.
2. Model the flights as a matrix `A`. Use min-plus matrix multiplication where `C[i][j] = min_k (A[i][k] + B[k][j])` to combine paths.
3. Compute `A^K` under this multiplication using exponentiation by squaring:
   - Start with the min-plus identity matrix (0 on the diagonal, `INF` elsewhere).
   - While `K > 0`, if `K` is odd multiply the result by the current base, then square the base and halve `K`.
4. The resulting matrix contains the minimal costs after exactly `K` flights; output it for each test case.

This approach runs in `O(N^3 log K)` time and uses `O(N^2)` space.
