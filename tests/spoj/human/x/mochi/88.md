# [Which is Next](https://www.spoj.com/problems/TREE2/)

## Problem Summary
Given the identifier of a binary tree, where the identifier uniquely encodes the tree structure, output the identifier of the tree that immediately follows it in lexicographic order among all trees of the same size. If the tree is the last one for its size, the successor is the first tree of that size.

## Algorithm
1. **Determine tree size** from the identifier `n` by counting its binary length (`floor(log2(n)) + 1`). A leaf has size 1 and identifier 0.
2. **Generate all identifiers** for binary trees of that size using recursion:
   - For each odd left size `l` and corresponding right size `r = size - 1 - l`, combine every left tree value `lv` with every right tree value `rv`.
   - The identifier for a tree with subtrees `lv` and `rv` is
     `2^{l+r} + 2^{r} * lv + rv`.
   - Results are cached so each size is generated once.
   - The recursion enumerates trees in the order defined by the problem.
3. **Locate the successor** of the given identifier within the generated list and output the next value, wrapping around to the first when needed.

This approach runs in time proportional to the number of binary trees of the treeâ€™s size, which is a Catalan number.
