// Solution for SPOJ TRT - Treats for the Cows
// https://www.spoj.com/problems/TRT/

fun makeZeroMatrix(n: int): list<list<int>> {
  var mat: list<list<int>> = []
  var i = 0
  while i < n {
    var row: list<int> = []
    var j = 0
    while j < n {
      row = append(row, 0)
      j = j + 1
    }
    mat = append(mat, row)
    i = i + 1
  }
  return mat
}

fun main() {
  let nLine = input()
  if nLine == "" { return }
  let n = nLine as int
  var vals: list<int> = []
  var idx = 0
  while idx < n {
    vals = append(vals, (input() as int))
    idx = idx + 1
  }
  var dp = makeZeroMatrix(n)
  var length = 1
  while length <= n {
    let age = n - length + 1
    var i = 0
    while i + length - 1 < n {
      let j = i + length - 1
      if i == j {
        dp[i][j] = age * vals[i]
      } else {
        let left = age * vals[i] + dp[i + 1][j]
        let right = age * vals[j] + dp[i][j - 1]
        if left > right {
          dp[i][j] = left
        } else {
          dp[i][j] = right
        }
      }
      i = i + 1
    }
    length = length + 1
  }
  print(str(dp[0][n - 1]))
}

main()
