# [Prime or Not](https://www.spoj.com/problems/PON/)

## Problem Summary
Given up to 500 integers `N` with `2 \le N < 2^63`, determine for each whether it is a prime number. Output `YES` if prime, otherwise `NO`.

## Algorithm
1. For each `N` handle small primes: if divisible by any of `2,3,5,7,11,13` return composite unless equal.
2. Write `N-1 = d * 2^s` with `d` odd.
3. Perform a deterministic Millerâ€“Rabin test using bases `{2, 325, 9375, 28178, 450775, 9780504, 1795265022}`:
   - Compute `x = a^d mod N`.
   - If `x` is neither `1` nor `N-1`, square `x` up to `s-1` times modulo `N`.
   - If none of the squarings yield `N-1`, `N` is composite.
4. If all bases pass, `N` is prime.

Modular multiplication is done with repeated doubling to avoid overflow for 64-bit values.
