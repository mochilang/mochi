# [Supernumbers](https://www.spoj.com/problems/SUPPER/)

## Problem Summary
Given a permutation of numbers `1..n` (with `n \le 100000`), find all values that belong to at least one longest increasing subsequence of the permutation. For each test case output the count of such values and list them in increasing order.

## Algorithm
1. Traverse the permutation from left to right. Using a Fenwick tree over values `1..n`, compute `L[i]` — the length of the longest increasing subsequence ending at position `i`.
2. Traverse the permutation from right to left. By indexing values in reverse and another Fenwick tree, compute `R[i]` — the length of the LIS starting at position `i`.
3. Let `LIS` be the maximum of `L[i]`. A value `a[i]` is part of some LIS iff `L[i] + R[i] - 1 == LIS`. Mark all such values.
4. Output all marked values in sorted order along with their count.

Each Fenwick tree operation runs in `O(log n)`, giving an overall complexity of `O(n log n)` per test case with linear memory.
