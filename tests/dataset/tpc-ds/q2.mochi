// Minimal schema for TPC-DS Q2
let web_sales = []
let catalog_sales = []
let date_dim = []

let wscs =
  from ws in web_sales
  select {sold_date_sk: ws.ws_sold_date_sk, sales_price: ws.ws_ext_sales_price}
  union all
  from cs in catalog_sales
  select {sold_date_sk: cs.cs_sold_date_sk, sales_price: cs.cs_ext_sales_price}

let wswscs =
  from w in wscs
  join d in date_dim on w.sold_date_sk == d.d_date_sk
  group by {week_seq: d.d_week_seq} into g
  select {
    d_week_seq: g.key.week_seq,
    sun_sales: sum(from x in g where x.day == "Sunday" select x.sales_price),
    mon_sales: sum(from x in g where x.day == "Monday" select x.sales_price),
    tue_sales: sum(from x in g where x.day == "Tuesday" select x.sales_price),
    wed_sales: sum(from x in g where x.day == "Wednesday" select x.sales_price),
    thu_sales: sum(from x in g where x.day == "Thursday" select x.sales_price),
    fri_sales: sum(from x in g where x.day == "Friday" select x.sales_price),
    sat_sales: sum(from x in g where x.day == "Saturday" select x.sales_price)
  }

let result = []
json(result)

test "TPCDS Q2 empty" {
  expect result == []
}
