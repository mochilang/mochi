# TPC-DS Query 92 â€“ Excess Discount Amount (Simplified)

This example finds web sales for a manufacturer where the discount amount is more than 30% above the average for the same period.

## SQL
```sql
SELECT SUM(ws_ext_discount_amt) AS "Excess Discount Amount"
FROM web_sales
JOIN item ON i_item_sk = ws_item_sk
JOIN date_dim ON d_date_sk = ws_sold_date_sk
WHERE i_manufact_id = 1
  AND d_date BETWEEN DATE '1998-01-01' AND DATE '1998-04-01'
  AND ws_ext_discount_amt > (
        SELECT 1.3 * AVG(ws_ext_discount_amt)
        FROM web_sales JOIN date_dim ON d_date_sk = ws_sold_date_sk
        WHERE ws_item_sk = i_item_sk
          AND d_date BETWEEN DATE '1998-01-01' AND DATE '1998-04-01')
ORDER BY "Excess Discount Amount";
```

## Expected Output
```json
[
  { "Excess Discount Amount": 10.0 }
]
```
