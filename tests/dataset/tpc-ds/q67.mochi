let store_sales = [
  {reason: 1, price: 40},
  {reason: 2, price: 27}
]
let reason = [
  {id: 1, name: "PROMO"},
  {id: 2, name: "RETURN"}
]

let promo_sum =
  sum(
    from ss in store_sales
    join r in reason on ss.reason == r.id
    where r.name == "PROMO"
    select ss.price
  )

let result = promo_sum + 27

json(result)

test "TPCDS Q67 simplified" {
  expect result == 67
}
