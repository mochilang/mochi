func main (regs=366)
  // let customer = [
  Const        r0, [{"c_customer_id": 1, "c_customer_sk": 1, "c_first_name": "Alice", "c_last_name": "Smith"}]
  // let date_dim = [
  Const        r1, [{"d_date_sk": 1, "d_year": 1998}, {"d_date_sk": 2, "d_year": 1999}]
  // let store_sales = [
  Const        r2, [{"ss_customer_sk": 1, "ss_net_paid": 100.0, "ss_sold_date_sk": 1}, {"ss_customer_sk": 1, "ss_net_paid": 110.0, "ss_sold_date_sk": 2}]
  // let web_sales = [
  Const        r3, [{"ws_bill_customer_sk": 1, "ws_net_paid": 40.0, "ws_sold_date_sk": 1}, {"ws_bill_customer_sk": 1, "ws_net_paid": 80.0, "ws_sold_date_sk": 2}]
  // from c in customer
  Const        r4, []
  // group by { id: c.c_customer_id, first: c.c_first_name, last: c.c_last_name, year: d.d_year } into g
  Const        r5, "id"
  Const        r6, "c_customer_id"
  Const        r7, "first"
  Const        r8, "c_first_name"
  Const        r9, "last"
  Const        r10, "c_last_name"
  Const        r11, "year"
  Const        r12, "d_year"
  // select { customer_id: g.key.id, customer_first_name: g.key.first, customer_last_name: g.key.last, year: g.key.year, year_total: sum(from x in g select x.ss.ss_net_paid), sale_type: "s" },
  Const        r13, "customer_id"
  Const        r14, "key"
  Const        r15, "customer_first_name"
  Const        r16, "customer_last_name"
  Const        r17, "year_total"
  Const        r18, "ss"
  Const        r19, "ss_net_paid"
  Const        r20, "sale_type"
  // from c in customer
  MakeMap      r21, 0, r0
  Const        r23, []
  Move         r22, r23
  IterPrep     r24, r0
  Len          r25, r24
  Const        r26, 0
  LessInt      r27, r26, r25
  JumpIfFalse  r27, L0
  Index        r28, r24, r26
  Move         r29, r28
  // join ss in store_sales on c.c_customer_sk == ss.ss_customer_sk
  IterPrep     r30, r2
  Len          r31, r30
  Const        r32, 0
  LessInt      r33, r32, r31
  JumpIfFalse  r33, L1
  Index        r34, r30, r32
  Move         r35, r34
  Const        r36, "c_customer_sk"
  Index        r37, r29, r36
  Const        r38, "ss_customer_sk"
  Index        r39, r35, r38
  Equal        r40, r37, r39
  JumpIfFalse  r40, L2
L7:
  // join d in date_dim on d.d_date_sk == ss.ss_sold_date_sk
  IterPrep     r41, r1
  Len          r42, r41
  Const        r43, 0
  LessInt      r44, r43, r42
  JumpIfFalse  r44, L2
  Index        r45, r41, r43
  Move         r46, r45
  Const        r47, "d_date_sk"
  Index        r48, r46, r47
  Const        r49, "ss_sold_date_sk"
  Index        r50, r35, r49
  Equal        r51, r48, r50
  JumpIfFalse  r51, L3
L6:
  // where d.d_year == 1998 || d.d_year == 1999
  Const        r12, "d_year"
  Index        r52, r46, r12
  Const        r53, 1998
  Equal        r54, r52, r53
  Index        r55, r46, r12
  Const        r56, 1999
  Equal        r57, r55, r56
  Move         r58, r54
  JumpIfTrue   r58, L4
  Move         r58, r57
  JumpIfFalse  r58, L3
  // from c in customer
  Const        r59, "c"
  Move         r60, r29
  Const        r18, "ss"
  Move         r61, r35
  Const        r62, "d"
  Move         r63, r46
  Move         r64, r59
  Move         r65, r60
  Move         r66, r18
  Move         r67, r61
L4:
  Move         r68, r62
  Move         r69, r63
  MakeMap      r70, 3, r64
  // group by { id: c.c_customer_id, first: c.c_first_name, last: c.c_last_name, year: d.d_year } into g
  Const        r71, "id"
  Const        r6, "c_customer_id"
  Index        r72, r29, r6
  Const        r73, "first"
  Const        r8, "c_first_name"
  Index        r74, r29, r8
  Const        r75, "last"
  Const        r10, "c_last_name"
  Index        r76, r29, r10
  Const        r77, "year"
  Const        r12, "d_year"
  Index        r78, r46, r12
  Move         r79, r71
  Move         r80, r72
  Move         r81, r73
  Move         r82, r74
  Move         r83, r75
  Move         r84, r76
  Move         r85, r77
  Move         r86, r78
  MakeMap      r87, 4, r79
  Str          r88, r87
  In           r89, r88, r21
  JumpIfTrue   r89, L5
  // from c in customer
  Const        r23, []
  Const        r90, "__group__"
  Const        r91, true
  Const        r14, "key"
  // group by { id: c.c_customer_id, first: c.c_first_name, last: c.c_last_name, year: d.d_year } into g
  Move         r92, r87
  // from c in customer
  Const        r93, "items"
  Move         r94, r23
  Const        r95, "count"
  Const        r96, 0
  Move         r97, r90
  Move         r98, r91
  Move         r99, r14
  Move         r100, r92
  Move         r101, r93
  Move         r102, r94
  Move         r103, r95
  Move         r104, r96
  MakeMap      r105, 4, r97
  SetIndex     r21, r88, r105
  Append       r106, r22, r105
  Move         r22, r106
  Index        r107, r21, r88
  Index        r108, r107, r93
  Append       r109, r108, r70
  SetIndex     r107, r93, r109
  Index        r110, r107, r95
  Const        r111, 1
  AddInt       r112, r110, r111
  SetIndex     r107, r95, r112
  // join d in date_dim on d.d_date_sk == ss.ss_sold_date_sk
  AddInt       r43, r43, r111
  Jump         L6
L5:
  // join ss in store_sales on c.c_customer_sk == ss.ss_customer_sk
  AddInt       r32, r32, r111
  Jump         L7
L3:
  // from c in customer
  Index        r116, r22, r113
  Move         r117, r116
  // select { customer_id: g.key.id, customer_first_name: g.key.first, customer_last_name: g.key.last, year: g.key.year, year_total: sum(from x in g select x.ss.ss_net_paid), sale_type: "s" },
  Const        r118, "customer_id"
L2:
  Const        r14, "key"
  Index        r119, r117, r14
  Const        r5, "id"
L1:
  Index        r120, r119, r5
  Const        r121, "customer_first_name"
  Index        r122, r117, r14
L0:
  Const        r7, "first"
  Index        r123, r122, r7
  Const        r124, "customer_last_name"
L9:
  Index        r125, r117, r14
  Const        r9, "last"
  Index        r126, r125, r9
  Const        r127, "year"
  Index        r128, r117, r14
  Const        r11, "year"
  Index        r129, r128, r11
  Const        r130, "year_total"
  Const        r131, []
  Const        r18, "ss"
  Const        r19, "ss_net_paid"
  IterPrep     r132, r117
  Len          r133, r132
  Const        r96, 0
  Move         r134, r96
  LessInt      r135, r134, r133
  JumpIfFalse  r135, L8
  Index        r136, r132, r134
  Move         r137, r136
  Const        r18, "ss"
  Index        r138, r137, r18
  Const        r19, "ss_net_paid"
  Index        r139, r138, r19
  Append       r140, r131, r139
  Move         r131, r140
  Const        r111, 1
  AddInt       r134, r134, r111
  Move         r145, r120
  Move         r146, r121
  Move         r147, r123
  Move         r148, r124
  Move         r149, r126
  Move         r150, r127
  Move         r151, r129
  Move         r152, r130
  Move         r153, r141
  Move         r154, r142
  Move         r155, r143
  MakeMap      r156, 6, r144
  // from c in customer
  Append       r157, r4, r156
L8:
  Move         r4, r157
  Const        r111, 1
  AddInt       r113, r113, r111
  Jump         L9
