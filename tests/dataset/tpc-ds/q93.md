# TPC-DS Query 93 â€“ Active Sales by Customer (Simplified)

This example calculates the sales amount for each customer after subtracting any returned quantity for a particular reason.

## SQL
```sql
SELECT ss_customer_sk,
       SUM(CASE WHEN sr_return_quantity IS NOT NULL
                 THEN (ss_quantity - sr_return_quantity) * ss_sales_price
                 ELSE ss_quantity * ss_sales_price END) AS sumsales
FROM store_sales
LEFT JOIN store_returns ON sr_item_sk = ss_item_sk
                       AND sr_ticket_number = ss_ticket_number
JOIN reason ON sr_reason_sk = r_reason_sk
WHERE r_reason_desc = 'ReasonA'
GROUP BY ss_customer_sk
ORDER BY sumsales, ss_customer_sk;
```

## Expected Output
```json
[
  { "ss_customer_sk": 1, "sumsales": 5.0 }
]
```
