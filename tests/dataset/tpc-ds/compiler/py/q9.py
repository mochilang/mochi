# Generated by Mochi compiler v0.10.27 on 2025-07-17T17:49:39Z
from __future__ import annotations
import dataclasses
import json


@dataclasses.dataclass
class Auto1:
    bucket1: float
    bucket2: float
    bucket3: float
    bucket4: float
    bucket5: float

    def __getitem__(self, key):
        return getattr(self, key)

    def __contains__(self, key):
        return hasattr(self, key)


@dataclasses.dataclass
class Reason:
    r_reason_sk: int

    def __getitem__(self, key):
        return getattr(self, key)

    def __contains__(self, key):
        return hasattr(self, key)


@dataclasses.dataclass
class StoreSale:
    ss_quantity: int
    ss_ext_discount_amt: float
    ss_net_paid: float

    def __getitem__(self, key):
        return getattr(self, key)

    def __contains__(self, key):
        return hasattr(self, key)


def test_TPCDS_Q9_result():
    assert result == [
        Auto1(bucket1=7.0, bucket2=15.0, bucket3=30.0, bucket4=35.0, bucket5=50.0)
    ]


store_sales = [
    StoreSale(ss_quantity=5, ss_ext_discount_amt=5.0, ss_net_paid=7.0),
    StoreSale(ss_quantity=30, ss_ext_discount_amt=10.0, ss_net_paid=15.0),
    StoreSale(ss_quantity=50, ss_ext_discount_amt=20.0, ss_net_paid=30.0),
    StoreSale(ss_quantity=70, ss_ext_discount_amt=25.0, ss_net_paid=35.0),
    StoreSale(ss_quantity=90, ss_ext_discount_amt=40.0, ss_net_paid=50.0),
]
reason = [Reason(r_reason_sk=1)]
bucket1 = (
    (
        sum(
            [
                s.ss_ext_discount_amt
                for s in store_sales
                if s.ss_quantity >= 1 and s.ss_quantity <= 20
            ]
        )
        / len(
            [
                s.ss_ext_discount_amt
                for s in store_sales
                if s.ss_quantity >= 1 and s.ss_quantity <= 20
            ]
        )
        if [
            s.ss_ext_discount_amt
            for s in store_sales
            if s.ss_quantity >= 1 and s.ss_quantity <= 20
        ]
        else 0
    )
    if len([s for s in store_sales if s.ss_quantity >= 1 and s.ss_quantity <= 20]) > 10
    else (
        sum(
            [
                s.ss_net_paid
                for s in store_sales
                if s.ss_quantity >= 1 and s.ss_quantity <= 20
            ]
        )
        / len(
            [
                s.ss_net_paid
                for s in store_sales
                if s.ss_quantity >= 1 and s.ss_quantity <= 20
            ]
        )
        if [
            s.ss_net_paid
            for s in store_sales
            if s.ss_quantity >= 1 and s.ss_quantity <= 20
        ]
        else 0
    )
)
bucket2 = (
    (
        sum(
            [
                s.ss_ext_discount_amt
                for s in store_sales
                if s.ss_quantity >= 21 and s.ss_quantity <= 40
            ]
        )
        / len(
            [
                s.ss_ext_discount_amt
                for s in store_sales
                if s.ss_quantity >= 21 and s.ss_quantity <= 40
            ]
        )
        if [
            s.ss_ext_discount_amt
            for s in store_sales
            if s.ss_quantity >= 21 and s.ss_quantity <= 40
        ]
        else 0
    )
    if len([s for s in store_sales if s.ss_quantity >= 21 and s.ss_quantity <= 40]) > 20
    else (
        sum(
            [
                s.ss_net_paid
                for s in store_sales
                if s.ss_quantity >= 21 and s.ss_quantity <= 40
            ]
        )
        / len(
            [
                s.ss_net_paid
                for s in store_sales
                if s.ss_quantity >= 21 and s.ss_quantity <= 40
            ]
        )
        if [
            s.ss_net_paid
            for s in store_sales
            if s.ss_quantity >= 21 and s.ss_quantity <= 40
        ]
        else 0
    )
)
bucket3 = (
    (
        sum(
            [
                s.ss_ext_discount_amt
                for s in store_sales
                if s.ss_quantity >= 41 and s.ss_quantity <= 60
            ]
        )
        / len(
            [
                s.ss_ext_discount_amt
                for s in store_sales
                if s.ss_quantity >= 41 and s.ss_quantity <= 60
            ]
        )
        if [
            s.ss_ext_discount_amt
            for s in store_sales
            if s.ss_quantity >= 41 and s.ss_quantity <= 60
        ]
        else 0
    )
    if len([s for s in store_sales if s.ss_quantity >= 41 and s.ss_quantity <= 60]) > 30
    else (
        sum(
            [
                s.ss_net_paid
                for s in store_sales
                if s.ss_quantity >= 41 and s.ss_quantity <= 60
            ]
        )
        / len(
            [
                s.ss_net_paid
                for s in store_sales
                if s.ss_quantity >= 41 and s.ss_quantity <= 60
            ]
        )
        if [
            s.ss_net_paid
            for s in store_sales
            if s.ss_quantity >= 41 and s.ss_quantity <= 60
        ]
        else 0
    )
)
bucket4 = (
    (
        sum(
            [
                s.ss_ext_discount_amt
                for s in store_sales
                if s.ss_quantity >= 61 and s.ss_quantity <= 80
            ]
        )
        / len(
            [
                s.ss_ext_discount_amt
                for s in store_sales
                if s.ss_quantity >= 61 and s.ss_quantity <= 80
            ]
        )
        if [
            s.ss_ext_discount_amt
            for s in store_sales
            if s.ss_quantity >= 61 and s.ss_quantity <= 80
        ]
        else 0
    )
    if len([s for s in store_sales if s.ss_quantity >= 61 and s.ss_quantity <= 80]) > 40
    else (
        sum(
            [
                s.ss_net_paid
                for s in store_sales
                if s.ss_quantity >= 61 and s.ss_quantity <= 80
            ]
        )
        / len(
            [
                s.ss_net_paid
                for s in store_sales
                if s.ss_quantity >= 61 and s.ss_quantity <= 80
            ]
        )
        if [
            s.ss_net_paid
            for s in store_sales
            if s.ss_quantity >= 61 and s.ss_quantity <= 80
        ]
        else 0
    )
)
bucket5 = (
    (
        sum(
            [
                s.ss_ext_discount_amt
                for s in store_sales
                if s.ss_quantity >= 81 and s.ss_quantity <= 100
            ]
        )
        / len(
            [
                s.ss_ext_discount_amt
                for s in store_sales
                if s.ss_quantity >= 81 and s.ss_quantity <= 100
            ]
        )
        if [
            s.ss_ext_discount_amt
            for s in store_sales
            if s.ss_quantity >= 81 and s.ss_quantity <= 100
        ]
        else 0
    )
    if len([s for s in store_sales if s.ss_quantity >= 81 and s.ss_quantity <= 100])
    > 50
    else (
        sum(
            [
                s.ss_net_paid
                for s in store_sales
                if s.ss_quantity >= 81 and s.ss_quantity <= 100
            ]
        )
        / len(
            [
                s.ss_net_paid
                for s in store_sales
                if s.ss_quantity >= 81 and s.ss_quantity <= 100
            ]
        )
        if [
            s.ss_net_paid
            for s in store_sales
            if s.ss_quantity >= 81 and s.ss_quantity <= 100
        ]
        else 0
    )
)
result = [
    Auto1(
        bucket1=bucket1,
        bucket2=bucket2,
        bucket3=bucket3,
        bucket4=bucket4,
        bucket5=bucket5,
    )
    for r in reason
    if r.r_reason_sk == 1
]
print(json.dumps(result, separators=(",", ":"), default=lambda o: vars(o)))
test_TPCDS_Q9_result()
