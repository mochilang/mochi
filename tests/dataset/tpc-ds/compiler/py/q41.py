# Generated by Mochi compiler v0.10.27 on 2025-07-17T17:50:10Z
from __future__ import annotations
import dataclasses
import json


@dataclasses.dataclass
class Item:
    product_name: str
    manufact_id: int
    manufact: int
    category: str
    color: str
    units: str
    size: str

    def __getitem__(self, key):
        return getattr(self, key)

    def __contains__(self, key):
        return hasattr(self, key)


def test_TPCDS_Q41_simplified():
    assert result == ["Blue Shirt", "Red Dress"]


item = [
    Item(
        product_name="Blue Shirt",
        manufact_id=100,
        manufact=1,
        category="Women",
        color="blue",
        units="pack",
        size="M",
    ),
    Item(
        product_name="Red Dress",
        manufact_id=120,
        manufact=1,
        category="Women",
        color="red",
        units="pack",
        size="M",
    ),
    Item(
        product_name="Pants",
        manufact_id=200,
        manufact=2,
        category="Men",
        color="black",
        units="pair",
        size="L",
    ),
]
lower = 100
result = [
    i1.product_name
    for i1 in sorted(
        [
            i1
            for i1 in item
            if (i1.manufact_id >= lower and i1.manufact_id <= lower + 40)
            and len(
                [
                    i2
                    for i2 in item
                    if i2.manufact == i1.manufact and i2.category == i1.category
                ]
            )
            > 1
        ],
        key=lambda i1: i1.product_name,
    )
]
print(json.dumps(result, separators=(",", ":"), default=lambda o: vars(o)))
test_TPCDS_Q41_simplified()
