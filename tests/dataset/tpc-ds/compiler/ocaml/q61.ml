(* Generated by Mochi compiler v0.10.25 on 2025-07-15T04:50:17Z *)
let sum lst = List.fold_left (+) 0 lst
let sum_float lst = List.fold_left (+.) 0.0 lst

type record1 = { mutable promo : bool; mutable price : int }

let sales : record1 list = [{ promo = true; price = 20 };{ promo = true; price = 41 };{ promo = false; price = 39 }]
let promotions : float = (sum_float (let __res0 = ref [] in
  List.iter (fun (s : record1) ->
      if s.promo then
    __res0 := s.price :: !__res0;
  ) sales;
List.rev !__res0)
)
let total : float = (sum_float (let __res1 = ref [] in
  List.iter (fun (s : record1) ->
      __res1 := s.price :: !__res1;
  ) sales;
List.rev !__res1)
)
let result : float = ((promotions *. 100) /. total)

let () =
  json result;
  assert ((result = 61))
