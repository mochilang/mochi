(* Generated by Mochi compiler v0.10.25 on 2025-07-15T04:50:16Z *)
type record1 = { mutable product_name : string; mutable manufact_id : int; mutable manufact : int; mutable category : string; mutable color : string; mutable units : string; mutable size : string }

let item : record1 list = [{ product_name = "Blue Shirt"; manufact_id = 100; manufact = 1; category = "Women"; color = "blue"; units = "pack"; size = "M" };{ product_name = "Red Dress"; manufact_id = 120; manufact = 1; category = "Women"; color = "red"; units = "pack"; size = "M" };{ product_name = "Pants"; manufact_id = 200; manufact = 2; category = "Men"; color = "black"; units = "pair"; size = "L" }]
let lower : int = 100
let result : Obj.t list = (let __res1 = ref [] in
  List.iter (fun (i1 : record1) ->
      if ((((i1.manufact_id >= lower) && (i1.manufact_id <= lower)) + 40) && (List.length (let __res0 = ref [] in
  List.iter (fun (i2 : record1) ->
      if ((i2.manufact = i1.manufact) && (i2.category = i1.category)) then
    __res0 := i2 :: !__res0;
  ) item;
List.rev !__res0)
 > 1)) then
    __res1 := i1.product_name :: !__res1;
  ) item;
List.rev !__res1)


let () =
  json result;
  assert ((result = ["Blue Shirt";"Red Dress"]))
