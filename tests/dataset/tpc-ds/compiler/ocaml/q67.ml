(* Generated by Mochi compiler v0.10.25 on 2025-07-15T04:50:17Z *)
let sum lst = List.fold_left (+) 0 lst
let sum_float lst = List.fold_left (+.) 0.0 lst

type record1 = { mutable reason : int; mutable price : int }
type record2 = { mutable id : int; mutable name : string }

let store_sales : record1 list = [{ reason = 1; price = 40 };{ reason = 2; price = 27 }]
let reason : record2 list = [{ id = 1; name = "PROMO" };{ id = 2; name = "RETURN" }]
let result : float = (sum_float (let __res0 = ref [] in
  List.iter (fun ss ->
    List.iter (fun r ->
      if (ss.reason = r.id) then (
        if (List.mem r.name ["PROMO";"RETURN"]) then __res0 := ss.price :: !__res0;
      )
    ) reason;
  ) store_sales;
  List.rev !__res0)
)

let () =
  json result;
  assert ((result = 67))
