(* Generated by Mochi compiler v0.10.25 on 2025-07-15T04:50:17Z *)
type record1 = { mutable week : int; mutable store : int; mutable amount : float }
type record2 = { mutable s_store_id1 : int; mutable ratio : float }

let sales_year1 : record1 list = [{ week = 1; store = 1; amount = 100. }]
let sales_year2 : record1 list = [{ week = 53; store = 1; amount = 150. }]
let join : record2 list = (let __res0 = ref [] in
  List.iter (fun y1 ->
    List.iter (fun y2 ->
      if (((y1.store = y2.store) && (y1.week = y2.week)) - 52) then (
        __res0 := { s_store_id1 = y1.store; ratio = (y2.amount /. y1.amount) } :: !__res0;
      )
    ) sales_year2;
  ) sales_year1;
  List.rev !__res0)

let result : (string * Obj.t) list list = join

let () =
  json result;
  assert ((result = [{ s_store_id1 = 1; ratio = 1.5 }]))
