// Generated by Mochi compiler v0.10.26 on 2025-07-15T07:51:48Z
// q72.mochi
import java.util.*;

class CsItemSkCsOrderNumberCsQuantityCsSoldDateSkCsShipDateSkCsBillCdemoSkCsBillHdemoSkCsPromoSk {
    int cs_item_sk;
    int cs_order_number;
    int cs_quantity;
    int cs_sold_date_sk;
    int cs_ship_date_sk;
    int cs_bill_cdemo_sk;
    int cs_bill_hdemo_sk;
    Object cs_promo_sk;
    CsItemSkCsOrderNumberCsQuantityCsSoldDateSkCsShipDateSkCsBillCdemoSkCsBillHdemoSkCsPromoSk(int cs_item_sk, int cs_order_number, int cs_quantity, int cs_sold_date_sk, int cs_ship_date_sk, int cs_bill_cdemo_sk, int cs_bill_hdemo_sk, Object cs_promo_sk) {
        this.cs_item_sk = cs_item_sk;
        this.cs_order_number = cs_order_number;
        this.cs_quantity = cs_quantity;
        this.cs_sold_date_sk = cs_sold_date_sk;
        this.cs_ship_date_sk = cs_ship_date_sk;
        this.cs_bill_cdemo_sk = cs_bill_cdemo_sk;
        this.cs_bill_hdemo_sk = cs_bill_hdemo_sk;
        this.cs_promo_sk = cs_promo_sk;
    }
    @Override public boolean equals(Object o) {
        if (this == o) return true;
        if (!(o instanceof CsItemSkCsOrderNumberCsQuantityCsSoldDateSkCsShipDateSkCsBillCdemoSkCsBillHdemoSkCsPromoSk other)) return false;
        return Objects.equals(this.cs_item_sk, other.cs_item_sk) && Objects.equals(this.cs_order_number, other.cs_order_number) && Objects.equals(this.cs_quantity, other.cs_quantity) && Objects.equals(this.cs_sold_date_sk, other.cs_sold_date_sk) && Objects.equals(this.cs_ship_date_sk, other.cs_ship_date_sk) && Objects.equals(this.cs_bill_cdemo_sk, other.cs_bill_cdemo_sk) && Objects.equals(this.cs_bill_hdemo_sk, other.cs_bill_hdemo_sk) && Objects.equals(this.cs_promo_sk, other.cs_promo_sk);
    }
    @Override public int hashCode() {
        return Objects.hash(cs_item_sk, cs_order_number, cs_quantity, cs_sold_date_sk, cs_ship_date_sk, cs_bill_cdemo_sk, cs_bill_hdemo_sk, cs_promo_sk);
    }
    int size() { return 8; }
}
class InvItemSkInvWarehouseSkInvDateSkInvQuantityOnHand {
    int inv_item_sk;
    int inv_warehouse_sk;
    int inv_date_sk;
    int inv_quantity_on_hand;
    InvItemSkInvWarehouseSkInvDateSkInvQuantityOnHand(int inv_item_sk, int inv_warehouse_sk, int inv_date_sk, int inv_quantity_on_hand) {
        this.inv_item_sk = inv_item_sk;
        this.inv_warehouse_sk = inv_warehouse_sk;
        this.inv_date_sk = inv_date_sk;
        this.inv_quantity_on_hand = inv_quantity_on_hand;
    }
    @Override public boolean equals(Object o) {
        if (this == o) return true;
        if (!(o instanceof InvItemSkInvWarehouseSkInvDateSkInvQuantityOnHand other)) return false;
        return Objects.equals(this.inv_item_sk, other.inv_item_sk) && Objects.equals(this.inv_warehouse_sk, other.inv_warehouse_sk) && Objects.equals(this.inv_date_sk, other.inv_date_sk) && Objects.equals(this.inv_quantity_on_hand, other.inv_quantity_on_hand);
    }
    @Override public int hashCode() {
        return Objects.hash(inv_item_sk, inv_warehouse_sk, inv_date_sk, inv_quantity_on_hand);
    }
    int size() { return 4; }
}
class WWarehouseSkWWarehouseName {
    int w_warehouse_sk;
    String w_warehouse_name;
    WWarehouseSkWWarehouseName(int w_warehouse_sk, String w_warehouse_name) {
        this.w_warehouse_sk = w_warehouse_sk;
        this.w_warehouse_name = w_warehouse_name;
    }
    @Override public boolean equals(Object o) {
        if (this == o) return true;
        if (!(o instanceof WWarehouseSkWWarehouseName other)) return false;
        return Objects.equals(this.w_warehouse_sk, other.w_warehouse_sk) && Objects.equals(this.w_warehouse_name, other.w_warehouse_name);
    }
    @Override public int hashCode() {
        return Objects.hash(w_warehouse_sk, w_warehouse_name);
    }
    int size() { return 2; }
}
class IItemSkIItemDesc {
    int i_item_sk;
    String i_item_desc;
    IItemSkIItemDesc(int i_item_sk, String i_item_desc) {
        this.i_item_sk = i_item_sk;
        this.i_item_desc = i_item_desc;
    }
    @Override public boolean equals(Object o) {
        if (this == o) return true;
        if (!(o instanceof IItemSkIItemDesc other)) return false;
        return Objects.equals(this.i_item_sk, other.i_item_sk) && Objects.equals(this.i_item_desc, other.i_item_desc);
    }
    @Override public int hashCode() {
        return Objects.hash(i_item_sk, i_item_desc);
    }
    int size() { return 2; }
}
class CdDemoSkCdMaritalStatus {
    int cd_demo_sk;
    String cd_marital_status;
    CdDemoSkCdMaritalStatus(int cd_demo_sk, String cd_marital_status) {
        this.cd_demo_sk = cd_demo_sk;
        this.cd_marital_status = cd_marital_status;
    }
    @Override public boolean equals(Object o) {
        if (this == o) return true;
        if (!(o instanceof CdDemoSkCdMaritalStatus other)) return false;
        return Objects.equals(this.cd_demo_sk, other.cd_demo_sk) && Objects.equals(this.cd_marital_status, other.cd_marital_status);
    }
    @Override public int hashCode() {
        return Objects.hash(cd_demo_sk, cd_marital_status);
    }
    int size() { return 2; }
}
class HdDemoSkHdBuyPotential {
    int hd_demo_sk;
    String hd_buy_potential;
    HdDemoSkHdBuyPotential(int hd_demo_sk, String hd_buy_potential) {
        this.hd_demo_sk = hd_demo_sk;
        this.hd_buy_potential = hd_buy_potential;
    }
    @Override public boolean equals(Object o) {
        if (this == o) return true;
        if (!(o instanceof HdDemoSkHdBuyPotential other)) return false;
        return Objects.equals(this.hd_demo_sk, other.hd_demo_sk) && Objects.equals(this.hd_buy_potential, other.hd_buy_potential);
    }
    @Override public int hashCode() {
        return Objects.hash(hd_demo_sk, hd_buy_potential);
    }
    int size() { return 2; }
}
class DDateSkDWeekSeqDDateDYear {
    int d_date_sk;
    int d_week_seq;
    int d_date;
    int d_year;
    DDateSkDWeekSeqDDateDYear(int d_date_sk, int d_week_seq, int d_date, int d_year) {
        this.d_date_sk = d_date_sk;
        this.d_week_seq = d_week_seq;
        this.d_date = d_date;
        this.d_year = d_year;
    }
    @Override public boolean equals(Object o) {
        if (this == o) return true;
        if (!(o instanceof DDateSkDWeekSeqDDateDYear other)) return false;
        return Objects.equals(this.d_date_sk, other.d_date_sk) && Objects.equals(this.d_week_seq, other.d_week_seq) && Objects.equals(this.d_date, other.d_date) && Objects.equals(this.d_year, other.d_year);
    }
    @Override public int hashCode() {
        return Objects.hash(d_date_sk, d_week_seq, d_date, d_year);
    }
    int size() { return 4; }
}
class CsInvWICdHdD1D2D3 {
    CsItemSkCsOrderNumberCsQuantityCsSoldDateSkCsShipDateSkCsBillCdemoSkCsBillHdemoSkCsPromoSk cs;
    InvItemSkInvWarehouseSkInvDateSkInvQuantityOnHand inv;
    WWarehouseSkWWarehouseName w;
    IItemSkIItemDesc i;
    CdDemoSkCdMaritalStatus cd;
    HdDemoSkHdBuyPotential hd;
    DDateSkDWeekSeqDDateDYear d1;
    DDateSkDWeekSeqDDateDYear d2;
    DDateSkDWeekSeqDDateDYear d3;
    CsInvWICdHdD1D2D3(CsItemSkCsOrderNumberCsQuantityCsSoldDateSkCsShipDateSkCsBillCdemoSkCsBillHdemoSkCsPromoSk cs, InvItemSkInvWarehouseSkInvDateSkInvQuantityOnHand inv, WWarehouseSkWWarehouseName w, IItemSkIItemDesc i, CdDemoSkCdMaritalStatus cd, HdDemoSkHdBuyPotential hd, DDateSkDWeekSeqDDateDYear d1, DDateSkDWeekSeqDDateDYear d2, DDateSkDWeekSeqDDateDYear d3) {
        this.cs = cs;
        this.inv = inv;
        this.w = w;
        this.i = i;
        this.cd = cd;
        this.hd = hd;
        this.d1 = d1;
        this.d2 = d2;
        this.d3 = d3;
    }
    @Override public boolean equals(Object o) {
        if (this == o) return true;
        if (!(o instanceof CsInvWICdHdD1D2D3 other)) return false;
        return Objects.equals(this.cs, other.cs) && Objects.equals(this.inv, other.inv) && Objects.equals(this.w, other.w) && Objects.equals(this.i, other.i) && Objects.equals(this.cd, other.cd) && Objects.equals(this.hd, other.hd) && Objects.equals(this.d1, other.d1) && Objects.equals(this.d2, other.d2) && Objects.equals(this.d3, other.d3);
    }
    @Override public int hashCode() {
        return Objects.hash(cs, inv, w, i, cd, hd, d1, d2, d3);
    }
    int size() { return 9; }
}
class ItemDescWarehouseWeekSeq {
    String item_desc;
    String warehouse;
    int week_seq;
    ItemDescWarehouseWeekSeq(String item_desc, String warehouse, int week_seq) {
        this.item_desc = item_desc;
        this.warehouse = warehouse;
        this.week_seq = week_seq;
    }
    @Override public boolean equals(Object o) {
        if (this == o) return true;
        if (!(o instanceof ItemDescWarehouseWeekSeq other)) return false;
        return Objects.equals(this.item_desc, other.item_desc) && Objects.equals(this.warehouse, other.warehouse) && Objects.equals(this.week_seq, other.week_seq);
    }
    @Override public int hashCode() {
        return Objects.hash(item_desc, warehouse, week_seq);
    }
    int size() { return 3; }
}
class IItemDescWWarehouseNameDWeekSeqNoPromoPromoTotalCnt {
    String i_item_desc;
    String w_warehouse_name;
    int d_week_seq;
    int no_promo;
    int promo;
    int total_cnt;
    IItemDescWWarehouseNameDWeekSeqNoPromoPromoTotalCnt(String i_item_desc, String w_warehouse_name, int d_week_seq, int no_promo, int promo, int total_cnt) {
        this.i_item_desc = i_item_desc;
        this.w_warehouse_name = w_warehouse_name;
        this.d_week_seq = d_week_seq;
        this.no_promo = no_promo;
        this.promo = promo;
        this.total_cnt = total_cnt;
    }
    @Override public boolean equals(Object o) {
        if (this == o) return true;
        if (!(o instanceof IItemDescWWarehouseNameDWeekSeqNoPromoPromoTotalCnt other)) return false;
        return Objects.equals(this.i_item_desc, other.i_item_desc) && Objects.equals(this.w_warehouse_name, other.w_warehouse_name) && Objects.equals(this.d_week_seq, other.d_week_seq) && Objects.equals(this.no_promo, other.no_promo) && Objects.equals(this.promo, other.promo) && Objects.equals(this.total_cnt, other.total_cnt);
    }
    @Override public int hashCode() {
        return Objects.hash(i_item_desc, w_warehouse_name, d_week_seq, no_promo, promo, total_cnt);
    }
    int size() { return 6; }
}
public class Q72 {
    static class Group<K,V> implements Iterable<V> {
        K key;
        List<V> items;
        Group(K key, List<V> items) { this.key = key; this.items = items; }
        public Iterator<V> iterator() { return items.iterator(); }
        int size() { return items.size(); }
    }
    static Map<String,Object> asMap(Object o) {
        if (o instanceof Map<?,?> mm) {
            LinkedHashMap<String,Object> m = new LinkedHashMap<>();
            for (Map.Entry<?,?> e : mm.entrySet()) m.put(String.valueOf(e.getKey()), e.getValue());
            return m;
        }
        LinkedHashMap<String,Object> m = new LinkedHashMap<>();
        for (var f : o.getClass().getDeclaredFields()) { try { f.setAccessible(true); m.put(f.getName(), f.get(o)); } catch (Exception e) { throw new RuntimeException(e); } }
        return m;
    }
    static void saveJsonl(List<?> list) {
        for (Object obj : list) {
            Map<String,Object> m = asMap(obj);
            List<String> parts = new ArrayList<>();
            for (Map.Entry<?,?> e : m.entrySet()) { parts.add("\"" + e.getKey() + "\":" + e.getValue()); }
            System.out.println("{" + String.join(",", parts) + "}");
        }
    }
    static String toJson(Object o) {
        if (o instanceof Map<?,?> m) {
            StringJoiner j = new StringJoiner(",", "{", "}");
            for (Map.Entry<?,?> e : m.entrySet()) j.add("\"" + e.getKey() + "\":" + toJson(e.getValue()));
            return j.toString();
        } else if (o instanceof Collection<?> c) {
            StringJoiner j = new StringJoiner(",", "[", "]");
            for (var x : c) j.add(toJson(x));
            return j.toString();
        } else if (o instanceof String s) {
            return "\"" + s + "\"";
        } else if (o instanceof Number || o instanceof Boolean || o instanceof Character) {
            return String.valueOf(o);
        } else {
            Map<String,Object> m = asMap(o);
            StringJoiner j = new StringJoiner(",", "{", "}");
            for (Map.Entry<String,Object> e : m.entrySet()) j.add("\"" + e.getKey() + "\":" + toJson(e.getValue()));
            return j.toString();
        }
    }
    static void json(Object o) { System.out.println(toJson(o)); }
    public static void main(String[] args) {
    List<CsItemSkCsOrderNumberCsQuantityCsSoldDateSkCsShipDateSkCsBillCdemoSkCsBillHdemoSkCsPromoSk> catalog_sales = new ArrayList<>(Arrays.asList(new CsItemSkCsOrderNumberCsQuantityCsSoldDateSkCsShipDateSkCsBillCdemoSkCsBillHdemoSkCsPromoSk(1, 1, 1, 1, 3, 1, 1, null)));
    List<InvItemSkInvWarehouseSkInvDateSkInvQuantityOnHand> inventory = new ArrayList<>(Arrays.asList(new InvItemSkInvWarehouseSkInvDateSkInvQuantityOnHand(1, 1, 2, 0)));
    List<WWarehouseSkWWarehouseName> warehouse = new ArrayList<>(Arrays.asList(new WWarehouseSkWWarehouseName(1, "Main")));
    List<IItemSkIItemDesc> item = new ArrayList<>(Arrays.asList(new IItemSkIItemDesc(1, "ItemA")));
    List<CdDemoSkCdMaritalStatus> customer_demographics = new ArrayList<>(Arrays.asList(new CdDemoSkCdMaritalStatus(1, "M")));
    List<HdDemoSkHdBuyPotential> household_demographics = new ArrayList<>(Arrays.asList(new HdDemoSkHdBuyPotential(1, "5001-10000")));
    List<DDateSkDWeekSeqDDateDYear> date_dim = new ArrayList<>(Arrays.asList(new DDateSkDWeekSeqDDateDYear(1, 10, 1, 2000), new DDateSkDWeekSeqDDateDYear(2, 10, 1, 2000), new DDateSkDWeekSeqDDateDYear(3, 10, 7, 2000)));
    List<IItemDescWWarehouseNameDWeekSeqNoPromoPromoTotalCnt> result = (new java.util.function.Supplier<List<IItemDescWWarehouseNameDWeekSeqNoPromoPromoTotalCnt>>(){public List<IItemDescWWarehouseNameDWeekSeqNoPromoPromoTotalCnt> get(){
    List<IItemDescWWarehouseNameDWeekSeqNoPromoPromoTotalCnt> res0 = new ArrayList<>();
    Map<ItemDescWarehouseWeekSeq,List<CsInvWICdHdD1D2D3>> groups1 = new LinkedHashMap<>();
    for (var cs : catalog_sales) {
        for (var inv : inventory) {
            if (!(inv.inv_item_sk == cs.cs_item_sk)) continue;
            for (var w : warehouse) {
                if (!(w.w_warehouse_sk == inv.inv_warehouse_sk)) continue;
                for (var i : item) {
                    if (!(i.i_item_sk == cs.cs_item_sk)) continue;
                    for (var cd : customer_demographics) {
                        if (!(cd.cd_demo_sk == cs.cs_bill_cdemo_sk)) continue;
                        for (var hd : household_demographics) {
                            if (!(hd.hd_demo_sk == cs.cs_bill_hdemo_sk)) continue;
                            for (var d1 : date_dim) {
                                if (!(d1.d_date_sk == cs.cs_sold_date_sk)) continue;
                                for (var d2 : date_dim) {
                                    if (!(d2.d_date_sk == inv.inv_date_sk)) continue;
                                    for (var d3 : date_dim) {
                                        if (!(d3.d_date_sk == cs.cs_ship_date_sk)) continue;
                                        if (!(d1.d_week_seq == d2.d_week_seq && inv.inv_quantity_on_hand < cs.cs_quantity && d3.d_date > d1.d_date + 5 && Objects.equals(hd.hd_buy_potential, "5001-10000") && d1.d_year == 2000 && Objects.equals(cd.cd_marital_status, "M"))) continue;
                                        CsInvWICdHdD1D2D3 row2 = new CsInvWICdHdD1D2D3(cs, inv, w, i, cd, hd, d1, d2, d3);
                                        ItemDescWarehouseWeekSeq key3 = new ItemDescWarehouseWeekSeq(i.i_item_desc, w.w_warehouse_name, d1.d_week_seq);
                                        List<CsInvWICdHdD1D2D3> bucket4 = groups1.get(key3);
                                        if (bucket4 == null) { bucket4 = new ArrayList<>(); groups1.put(key3, bucket4); }
                                        bucket4.add(row2);
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }
    }
    for (Map.Entry<ItemDescWarehouseWeekSeq,List<CsInvWICdHdD1D2D3>> __e : groups1.entrySet()) {
        ItemDescWarehouseWeekSeq g_key = __e.getKey();
        Group<ItemDescWarehouseWeekSeq,CsInvWICdHdD1D2D3> g = new Group<>(g_key, __e.getValue());
        res0.add(new IItemDescWWarehouseNameDWeekSeqNoPromoPromoTotalCnt(g.key.item_desc, g.key.warehouse, g.key.week_seq, (new java.util.function.Supplier<List<CsInvWICdHdD1D2D3>>(){public List<CsInvWICdHdD1D2D3> get(){
    List<CsInvWICdHdD1D2D3> res5 = new ArrayList<>();
    for (var x : g) {
        if (!(Objects.equals(x.cs_promo_sk, null))) continue;
        res5.add(x);
    }
    return res5;
}}).get().size(), (new java.util.function.Supplier<List<CsInvWICdHdD1D2D3>>(){public List<CsInvWICdHdD1D2D3> get(){
    List<CsInvWICdHdD1D2D3> res6 = new ArrayList<>();
    for (var x : g) {
        if (!(!Objects.equals(x.cs_promo_sk, null))) continue;
        res6.add(x);
    }
    return res6;
}}).get().size(), g.size()));
    }
    return res0;
}}).get();
    json(result);
    if (!(Objects.equals(result, Arrays.asList(new IItemDescWWarehouseNameDWeekSeqNoPromoPromoTotalCnt("ItemA", "Main", 10, 1, 0, 1))))) throw new AssertionError("expect failed");
    }
}
