// Generated by Mochi compiler v0.10.26 on 2025-07-15T07:51:51Z
// q76.mochi
import java.util.*;

class DDateSkDYearDQoy {
    int d_date_sk;
    int d_year;
    int d_qoy;
    DDateSkDYearDQoy(int d_date_sk, int d_year, int d_qoy) {
        this.d_date_sk = d_date_sk;
        this.d_year = d_year;
        this.d_qoy = d_qoy;
    }
    @Override public boolean equals(Object o) {
        if (this == o) return true;
        if (!(o instanceof DDateSkDYearDQoy other)) return false;
        return Objects.equals(this.d_date_sk, other.d_date_sk) && Objects.equals(this.d_year, other.d_year) && Objects.equals(this.d_qoy, other.d_qoy);
    }
    @Override public int hashCode() {
        return Objects.hash(d_date_sk, d_year, d_qoy);
    }
    int size() { return 3; }
}
class IItemSkICategory {
    int i_item_sk;
    String i_category;
    IItemSkICategory(int i_item_sk, String i_category) {
        this.i_item_sk = i_item_sk;
        this.i_category = i_category;
    }
    @Override public boolean equals(Object o) {
        if (this == o) return true;
        if (!(o instanceof IItemSkICategory other)) return false;
        return Objects.equals(this.i_item_sk, other.i_item_sk) && Objects.equals(this.i_category, other.i_category);
    }
    @Override public int hashCode() {
        return Objects.hash(i_item_sk, i_category);
    }
    int size() { return 2; }
}
class SsCustomerSkSsItemSkSsExtSalesPriceSsSoldDateSk {
    Object ss_customer_sk;
    int ss_item_sk;
    double ss_ext_sales_price;
    int ss_sold_date_sk;
    SsCustomerSkSsItemSkSsExtSalesPriceSsSoldDateSk(Object ss_customer_sk, int ss_item_sk, double ss_ext_sales_price, int ss_sold_date_sk) {
        this.ss_customer_sk = ss_customer_sk;
        this.ss_item_sk = ss_item_sk;
        this.ss_ext_sales_price = ss_ext_sales_price;
        this.ss_sold_date_sk = ss_sold_date_sk;
    }
    @Override public boolean equals(Object o) {
        if (this == o) return true;
        if (!(o instanceof SsCustomerSkSsItemSkSsExtSalesPriceSsSoldDateSk other)) return false;
        return Objects.equals(this.ss_customer_sk, other.ss_customer_sk) && Objects.equals(this.ss_item_sk, other.ss_item_sk) && Objects.equals(this.ss_ext_sales_price, other.ss_ext_sales_price) && Objects.equals(this.ss_sold_date_sk, other.ss_sold_date_sk);
    }
    @Override public int hashCode() {
        return Objects.hash(ss_customer_sk, ss_item_sk, ss_ext_sales_price, ss_sold_date_sk);
    }
    int size() { return 4; }
}
class WsBillCustomerSkWsItemSkWsExtSalesPriceWsSoldDateSk {
    Object ws_bill_customer_sk;
    int ws_item_sk;
    double ws_ext_sales_price;
    int ws_sold_date_sk;
    WsBillCustomerSkWsItemSkWsExtSalesPriceWsSoldDateSk(Object ws_bill_customer_sk, int ws_item_sk, double ws_ext_sales_price, int ws_sold_date_sk) {
        this.ws_bill_customer_sk = ws_bill_customer_sk;
        this.ws_item_sk = ws_item_sk;
        this.ws_ext_sales_price = ws_ext_sales_price;
        this.ws_sold_date_sk = ws_sold_date_sk;
    }
    @Override public boolean equals(Object o) {
        if (this == o) return true;
        if (!(o instanceof WsBillCustomerSkWsItemSkWsExtSalesPriceWsSoldDateSk other)) return false;
        return Objects.equals(this.ws_bill_customer_sk, other.ws_bill_customer_sk) && Objects.equals(this.ws_item_sk, other.ws_item_sk) && Objects.equals(this.ws_ext_sales_price, other.ws_ext_sales_price) && Objects.equals(this.ws_sold_date_sk, other.ws_sold_date_sk);
    }
    @Override public int hashCode() {
        return Objects.hash(ws_bill_customer_sk, ws_item_sk, ws_ext_sales_price, ws_sold_date_sk);
    }
    int size() { return 4; }
}
class CsBillCustomerSkCsItemSkCsExtSalesPriceCsSoldDateSk {
    Object cs_bill_customer_sk;
    int cs_item_sk;
    double cs_ext_sales_price;
    int cs_sold_date_sk;
    CsBillCustomerSkCsItemSkCsExtSalesPriceCsSoldDateSk(Object cs_bill_customer_sk, int cs_item_sk, double cs_ext_sales_price, int cs_sold_date_sk) {
        this.cs_bill_customer_sk = cs_bill_customer_sk;
        this.cs_item_sk = cs_item_sk;
        this.cs_ext_sales_price = cs_ext_sales_price;
        this.cs_sold_date_sk = cs_sold_date_sk;
    }
    @Override public boolean equals(Object o) {
        if (this == o) return true;
        if (!(o instanceof CsBillCustomerSkCsItemSkCsExtSalesPriceCsSoldDateSk other)) return false;
        return Objects.equals(this.cs_bill_customer_sk, other.cs_bill_customer_sk) && Objects.equals(this.cs_item_sk, other.cs_item_sk) && Objects.equals(this.cs_ext_sales_price, other.cs_ext_sales_price) && Objects.equals(this.cs_sold_date_sk, other.cs_sold_date_sk);
    }
    @Override public int hashCode() {
        return Objects.hash(cs_bill_customer_sk, cs_item_sk, cs_ext_sales_price, cs_sold_date_sk);
    }
    int size() { return 4; }
}
class ChannelColNameDYearDQoyICategoryExtSalesPrice {
    String channel;
    Object col_name;
    int d_year;
    int d_qoy;
    String i_category;
    double ext_sales_price;
    ChannelColNameDYearDQoyICategoryExtSalesPrice(String channel, Object col_name, int d_year, int d_qoy, String i_category, double ext_sales_price) {
        this.channel = channel;
        this.col_name = col_name;
        this.d_year = d_year;
        this.d_qoy = d_qoy;
        this.i_category = i_category;
        this.ext_sales_price = ext_sales_price;
    }
    @Override public boolean equals(Object o) {
        if (this == o) return true;
        if (!(o instanceof ChannelColNameDYearDQoyICategoryExtSalesPrice other)) return false;
        return Objects.equals(this.channel, other.channel) && Objects.equals(this.col_name, other.col_name) && Objects.equals(this.d_year, other.d_year) && Objects.equals(this.d_qoy, other.d_qoy) && Objects.equals(this.i_category, other.i_category) && Objects.equals(this.ext_sales_price, other.ext_sales_price);
    }
    @Override public int hashCode() {
        return Objects.hash(channel, col_name, d_year, d_qoy, i_category, ext_sales_price);
    }
    int size() { return 6; }
}
class ChannelColNameDYearDQoyICategory {
    String channel;
    Object col_name;
    int d_year;
    int d_qoy;
    String i_category;
    ChannelColNameDYearDQoyICategory(String channel, Object col_name, int d_year, int d_qoy, String i_category) {
        this.channel = channel;
        this.col_name = col_name;
        this.d_year = d_year;
        this.d_qoy = d_qoy;
        this.i_category = i_category;
    }
    @Override public boolean equals(Object o) {
        if (this == o) return true;
        if (!(o instanceof ChannelColNameDYearDQoyICategory other)) return false;
        return Objects.equals(this.channel, other.channel) && Objects.equals(this.col_name, other.col_name) && Objects.equals(this.d_year, other.d_year) && Objects.equals(this.d_qoy, other.d_qoy) && Objects.equals(this.i_category, other.i_category);
    }
    @Override public int hashCode() {
        return Objects.hash(channel, col_name, d_year, d_qoy, i_category);
    }
    int size() { return 5; }
}
class ChannelColNameDYearDQoyICategorySalesCntSalesAmt {
    String channel;
    Object col_name;
    int d_year;
    int d_qoy;
    String i_category;
    int sales_cnt;
    int sales_amt;
    ChannelColNameDYearDQoyICategorySalesCntSalesAmt(String channel, Object col_name, int d_year, int d_qoy, String i_category, int sales_cnt, int sales_amt) {
        this.channel = channel;
        this.col_name = col_name;
        this.d_year = d_year;
        this.d_qoy = d_qoy;
        this.i_category = i_category;
        this.sales_cnt = sales_cnt;
        this.sales_amt = sales_amt;
    }
    @Override public boolean equals(Object o) {
        if (this == o) return true;
        if (!(o instanceof ChannelColNameDYearDQoyICategorySalesCntSalesAmt other)) return false;
        return Objects.equals(this.channel, other.channel) && Objects.equals(this.col_name, other.col_name) && Objects.equals(this.d_year, other.d_year) && Objects.equals(this.d_qoy, other.d_qoy) && Objects.equals(this.i_category, other.i_category) && Objects.equals(this.sales_cnt, other.sales_cnt) && Objects.equals(this.sales_amt, other.sales_amt);
    }
    @Override public int hashCode() {
        return Objects.hash(channel, col_name, d_year, d_qoy, i_category, sales_cnt, sales_amt);
    }
    int size() { return 7; }
}
public class Q76 {
    static class Group<K,V> implements Iterable<V> {
        K key;
        List<V> items;
        Group(K key, List<V> items) { this.key = key; this.items = items; }
        public Iterator<V> iterator() { return items.iterator(); }
        int size() { return items.size(); }
    }
    static Map<String,Object> asMap(Object o) {
        if (o instanceof Map<?,?> mm) {
            LinkedHashMap<String,Object> m = new LinkedHashMap<>();
            for (Map.Entry<?,?> e : mm.entrySet()) m.put(String.valueOf(e.getKey()), e.getValue());
            return m;
        }
        LinkedHashMap<String,Object> m = new LinkedHashMap<>();
        for (var f : o.getClass().getDeclaredFields()) { try { f.setAccessible(true); m.put(f.getName(), f.get(o)); } catch (Exception e) { throw new RuntimeException(e); } }
        return m;
    }
    static void saveJsonl(List<?> list) {
        for (Object obj : list) {
            Map<String,Object> m = asMap(obj);
            List<String> parts = new ArrayList<>();
            for (Map.Entry<?,?> e : m.entrySet()) { parts.add("\"" + e.getKey() + "\":" + e.getValue()); }
            System.out.println("{" + String.join(",", parts) + "}");
        }
    }
    static String toJson(Object o) {
        if (o instanceof Map<?,?> m) {
            StringJoiner j = new StringJoiner(",", "{", "}");
            for (Map.Entry<?,?> e : m.entrySet()) j.add("\"" + e.getKey() + "\":" + toJson(e.getValue()));
            return j.toString();
        } else if (o instanceof Collection<?> c) {
            StringJoiner j = new StringJoiner(",", "[", "]");
            for (var x : c) j.add(toJson(x));
            return j.toString();
        } else if (o instanceof String s) {
            return "\"" + s + "\"";
        } else if (o instanceof Number || o instanceof Boolean || o instanceof Character) {
            return String.valueOf(o);
        } else {
            Map<String,Object> m = asMap(o);
            StringJoiner j = new StringJoiner(",", "{", "}");
            for (Map.Entry<String,Object> e : m.entrySet()) j.add("\"" + e.getKey() + "\":" + toJson(e.getValue()));
            return j.toString();
        }
    }
    static void json(Object o) { System.out.println(toJson(o)); }
    public static void main(String[] args) {
    List<DDateSkDYearDQoy> date_dim = new ArrayList<>(Arrays.asList(new DDateSkDYearDQoy(1, 1998, 1)));
    List<IItemSkICategory> item = new ArrayList<>(Arrays.asList(new IItemSkICategory(1, "CatA"), new IItemSkICategory(2, "CatB"), new IItemSkICategory(3, "CatC")));
    List<SsCustomerSkSsItemSkSsExtSalesPriceSsSoldDateSk> store_sales = new ArrayList<>(Arrays.asList(new SsCustomerSkSsItemSkSsExtSalesPriceSsSoldDateSk(null, 1, 10.000000, 1)));
    List<WsBillCustomerSkWsItemSkWsExtSalesPriceWsSoldDateSk> web_sales = new ArrayList<>(Arrays.asList(new WsBillCustomerSkWsItemSkWsExtSalesPriceWsSoldDateSk(null, 2, 15.000000, 1)));
    List<CsBillCustomerSkCsItemSkCsExtSalesPriceCsSoldDateSk> catalog_sales = new ArrayList<>(Arrays.asList(new CsBillCustomerSkCsItemSkCsExtSalesPriceCsSoldDateSk(null, 3, 20.000000, 1)));
    List<ChannelColNameDYearDQoyICategoryExtSalesPrice> store_part = (new java.util.function.Supplier<List<ChannelColNameDYearDQoyICategoryExtSalesPrice>>(){public List<ChannelColNameDYearDQoyICategoryExtSalesPrice> get(){
    List<ChannelColNameDYearDQoyICategoryExtSalesPrice> res0 = new ArrayList<>();
    for (var ss : store_sales) {
        for (var i : item) {
            if (!(i.i_item_sk == ss.ss_item_sk)) continue;
            for (var d : date_dim) {
                if (!(d.d_date_sk == ss.ss_sold_date_sk)) continue;
                if (!(Objects.equals(ss.ss_customer_sk, null))) continue;
                res0.add(new ChannelColNameDYearDQoyICategoryExtSalesPrice("store", ss.ss_customer_sk, d.d_year, d.d_qoy, i.i_category, ss.ss_ext_sales_price));
            }
        }
    }
    return res0;
}}).get();
    List<ChannelColNameDYearDQoyICategoryExtSalesPrice> web_part = (new java.util.function.Supplier<List<ChannelColNameDYearDQoyICategoryExtSalesPrice>>(){public List<ChannelColNameDYearDQoyICategoryExtSalesPrice> get(){
    List<ChannelColNameDYearDQoyICategoryExtSalesPrice> res1 = new ArrayList<>();
    for (var ws : web_sales) {
        for (var i : item) {
            if (!(i.i_item_sk == ws.ws_item_sk)) continue;
            for (var d : date_dim) {
                if (!(d.d_date_sk == ws.ws_sold_date_sk)) continue;
                if (!(Objects.equals(ws.ws_bill_customer_sk, null))) continue;
                res1.add(new ChannelColNameDYearDQoyICategoryExtSalesPrice("web", ws.ws_bill_customer_sk, d.d_year, d.d_qoy, i.i_category, ws.ws_ext_sales_price));
            }
        }
    }
    return res1;
}}).get();
    List<ChannelColNameDYearDQoyICategoryExtSalesPrice> catalog_part = (new java.util.function.Supplier<List<ChannelColNameDYearDQoyICategoryExtSalesPrice>>(){public List<ChannelColNameDYearDQoyICategoryExtSalesPrice> get(){
    List<ChannelColNameDYearDQoyICategoryExtSalesPrice> res2 = new ArrayList<>();
    for (var cs : catalog_sales) {
        for (var i : item) {
            if (!(i.i_item_sk == cs.cs_item_sk)) continue;
            for (var d : date_dim) {
                if (!(d.d_date_sk == cs.cs_sold_date_sk)) continue;
                if (!(Objects.equals(cs.cs_bill_customer_sk, null))) continue;
                res2.add(new ChannelColNameDYearDQoyICategoryExtSalesPrice("catalog", cs.cs_bill_customer_sk, d.d_year, d.d_qoy, i.i_category, cs.cs_ext_sales_price));
            }
        }
    }
    return res2;
}}).get();
    List<ChannelColNameDYearDQoyICategoryExtSalesPrice> all_rows = java.util.stream.Stream.concat(java.util.stream.Stream.concat(store_part.stream(), web_part.stream()).collect(java.util.stream.Collectors.toList()).stream(), catalog_part.stream()).collect(java.util.stream.Collectors.toList());
    List<ChannelColNameDYearDQoyICategorySalesCntSalesAmt> result = (new java.util.function.Supplier<List<ChannelColNameDYearDQoyICategorySalesCntSalesAmt>>(){public List<ChannelColNameDYearDQoyICategorySalesCntSalesAmt> get(){
    List<ChannelColNameDYearDQoyICategorySalesCntSalesAmt> res3 = new ArrayList<>();
    Map<ChannelColNameDYearDQoyICategory,List<ChannelColNameDYearDQoyICategoryExtSalesPrice>> groups4 = new LinkedHashMap<>();
    for (var r : all_rows) {
        var row5 = r;
        ChannelColNameDYearDQoyICategory key6 = new ChannelColNameDYearDQoyICategory(r.channel, r.col_name, r.d_year, r.d_qoy, r.i_category);
        List<ChannelColNameDYearDQoyICategoryExtSalesPrice> bucket7 = groups4.get(key6);
        if (bucket7 == null) { bucket7 = new ArrayList<>(); groups4.put(key6, bucket7); }
        bucket7.add(row5);
    }
    for (Map.Entry<ChannelColNameDYearDQoyICategory,List<ChannelColNameDYearDQoyICategoryExtSalesPrice>> __e : groups4.entrySet()) {
        ChannelColNameDYearDQoyICategory g_key = __e.getKey();
        Group<ChannelColNameDYearDQoyICategory,ChannelColNameDYearDQoyICategoryExtSalesPrice> g = new Group<>(g_key, __e.getValue());
        res3.add(new ChannelColNameDYearDQoyICategorySalesCntSalesAmt(g.key.channel, g.key.col_name, g.key.d_year, g.key.d_qoy, g.key.i_category, g.size(), (new java.util.function.Supplier<List<Object>>(){public List<Object> get(){
    List<Object> res8 = new ArrayList<>();
    for (var x : g) {
        res8.add(x.r.ext_sales_price);
    }
    return res8;
}}).get().stream().mapToInt(n -> ((Number)n).intValue()).sum()));
    }
    return res3;
}}).get();
    json(result);
    if (!(Objects.equals(result, Arrays.asList(new ChannelColNameDYearDQoyICategorySalesCntSalesAmt("store", null, 1998, 1, "CatA", 1, 10.000000), new ChannelColNameDYearDQoyICategorySalesCntSalesAmt("web", null, 1998, 1, "CatB", 1, 15.000000), new ChannelColNameDYearDQoyICategorySalesCntSalesAmt("catalog", null, 1998, 1, "CatC", 1, 20.000000))))) throw new AssertionError("expect failed");
    }
}
