// Generated by Mochi compiler v0.10.26 on 2025-07-15T07:52:07Z
// q94.mochi
import java.util.*;

class WebSale {
    int ws_order_number;
    int ws_ship_date_sk;
    int ws_warehouse_sk;
    int ws_ship_addr_sk;
    int ws_web_site_sk;
    double ws_net_profit;
    double ws_ext_ship_cost;
    WebSale(int ws_order_number, int ws_ship_date_sk, int ws_warehouse_sk, int ws_ship_addr_sk, int ws_web_site_sk, double ws_net_profit, double ws_ext_ship_cost) {
        this.ws_order_number = ws_order_number;
        this.ws_ship_date_sk = ws_ship_date_sk;
        this.ws_warehouse_sk = ws_warehouse_sk;
        this.ws_ship_addr_sk = ws_ship_addr_sk;
        this.ws_web_site_sk = ws_web_site_sk;
        this.ws_net_profit = ws_net_profit;
        this.ws_ext_ship_cost = ws_ext_ship_cost;
    }
    @Override public boolean equals(Object o) {
        if (this == o) return true;
        if (!(o instanceof WebSale other)) return false;
        return Objects.equals(this.ws_order_number, other.ws_order_number) && Objects.equals(this.ws_ship_date_sk, other.ws_ship_date_sk) && Objects.equals(this.ws_warehouse_sk, other.ws_warehouse_sk) && Objects.equals(this.ws_ship_addr_sk, other.ws_ship_addr_sk) && Objects.equals(this.ws_web_site_sk, other.ws_web_site_sk) && Objects.equals(this.ws_net_profit, other.ws_net_profit) && Objects.equals(this.ws_ext_ship_cost, other.ws_ext_ship_cost);
    }
    @Override public int hashCode() {
        return Objects.hash(ws_order_number, ws_ship_date_sk, ws_warehouse_sk, ws_ship_addr_sk, ws_web_site_sk, ws_net_profit, ws_ext_ship_cost);
    }
}
class WebReturn {
    int wr_order_number;
    WebReturn(int wr_order_number) {
        this.wr_order_number = wr_order_number;
    }
    @Override public boolean equals(Object o) {
        if (this == o) return true;
        if (!(o instanceof WebReturn other)) return false;
        return Objects.equals(this.wr_order_number, other.wr_order_number);
    }
    @Override public int hashCode() {
        return Objects.hash(wr_order_number);
    }
}
class DateDim {
    int d_date_sk;
    String d_date;
    DateDim(int d_date_sk, String d_date) {
        this.d_date_sk = d_date_sk;
        this.d_date = d_date;
    }
    @Override public boolean equals(Object o) {
        if (this == o) return true;
        if (!(o instanceof DateDim other)) return false;
        return Objects.equals(this.d_date_sk, other.d_date_sk) && Objects.equals(this.d_date, other.d_date);
    }
    @Override public int hashCode() {
        return Objects.hash(d_date_sk, d_date);
    }
}
class CustomerAddress {
    int ca_address_sk;
    String ca_state;
    CustomerAddress(int ca_address_sk, String ca_state) {
        this.ca_address_sk = ca_address_sk;
        this.ca_state = ca_state;
    }
    @Override public boolean equals(Object o) {
        if (this == o) return true;
        if (!(o instanceof CustomerAddress other)) return false;
        return Objects.equals(this.ca_address_sk, other.ca_address_sk) && Objects.equals(this.ca_state, other.ca_state);
    }
    @Override public int hashCode() {
        return Objects.hash(ca_address_sk, ca_state);
    }
}
class WebSite {
    int web_site_sk;
    String web_company_name;
    WebSite(int web_site_sk, String web_company_name) {
        this.web_site_sk = web_site_sk;
        this.web_company_name = web_company_name;
    }
    @Override public boolean equals(Object o) {
        if (this == o) return true;
        if (!(o instanceof WebSite other)) return false;
        return Objects.equals(this.web_site_sk, other.web_site_sk) && Objects.equals(this.web_company_name, other.web_company_name);
    }
    @Override public int hashCode() {
        return Objects.hash(web_site_sk, web_company_name);
    }
}
class WsOrderNumberWsShipDateSkWsWarehouseSkWsShipAddrSkWsWebSiteSkWsNetProfitWsExtShipCost {
    int ws_order_number;
    int ws_ship_date_sk;
    int ws_warehouse_sk;
    int ws_ship_addr_sk;
    int ws_web_site_sk;
    double ws_net_profit;
    double ws_ext_ship_cost;
    WsOrderNumberWsShipDateSkWsWarehouseSkWsShipAddrSkWsWebSiteSkWsNetProfitWsExtShipCost(int ws_order_number, int ws_ship_date_sk, int ws_warehouse_sk, int ws_ship_addr_sk, int ws_web_site_sk, double ws_net_profit, double ws_ext_ship_cost) {
        this.ws_order_number = ws_order_number;
        this.ws_ship_date_sk = ws_ship_date_sk;
        this.ws_warehouse_sk = ws_warehouse_sk;
        this.ws_ship_addr_sk = ws_ship_addr_sk;
        this.ws_web_site_sk = ws_web_site_sk;
        this.ws_net_profit = ws_net_profit;
        this.ws_ext_ship_cost = ws_ext_ship_cost;
    }
    @Override public boolean equals(Object o) {
        if (this == o) return true;
        if (!(o instanceof WsOrderNumberWsShipDateSkWsWarehouseSkWsShipAddrSkWsWebSiteSkWsNetProfitWsExtShipCost other)) return false;
        return Objects.equals(this.ws_order_number, other.ws_order_number) && Objects.equals(this.ws_ship_date_sk, other.ws_ship_date_sk) && Objects.equals(this.ws_warehouse_sk, other.ws_warehouse_sk) && Objects.equals(this.ws_ship_addr_sk, other.ws_ship_addr_sk) && Objects.equals(this.ws_web_site_sk, other.ws_web_site_sk) && Objects.equals(this.ws_net_profit, other.ws_net_profit) && Objects.equals(this.ws_ext_ship_cost, other.ws_ext_ship_cost);
    }
    @Override public int hashCode() {
        return Objects.hash(ws_order_number, ws_ship_date_sk, ws_warehouse_sk, ws_ship_addr_sk, ws_web_site_sk, ws_net_profit, ws_ext_ship_cost);
    }
    int size() { return 7; }
}
class WrOrderNumber {
    int wr_order_number;
    WrOrderNumber(int wr_order_number) {
        this.wr_order_number = wr_order_number;
    }
    @Override public boolean equals(Object o) {
        if (this == o) return true;
        if (!(o instanceof WrOrderNumber other)) return false;
        return Objects.equals(this.wr_order_number, other.wr_order_number);
    }
    @Override public int hashCode() {
        return Objects.hash(wr_order_number);
    }
    int size() { return 1; }
}
class DDateSkDDate {
    int d_date_sk;
    String d_date;
    DDateSkDDate(int d_date_sk, String d_date) {
        this.d_date_sk = d_date_sk;
        this.d_date = d_date;
    }
    @Override public boolean equals(Object o) {
        if (this == o) return true;
        if (!(o instanceof DDateSkDDate other)) return false;
        return Objects.equals(this.d_date_sk, other.d_date_sk) && Objects.equals(this.d_date, other.d_date);
    }
    @Override public int hashCode() {
        return Objects.hash(d_date_sk, d_date);
    }
    int size() { return 2; }
}
class CaAddressSkCaState {
    int ca_address_sk;
    String ca_state;
    CaAddressSkCaState(int ca_address_sk, String ca_state) {
        this.ca_address_sk = ca_address_sk;
        this.ca_state = ca_state;
    }
    @Override public boolean equals(Object o) {
        if (this == o) return true;
        if (!(o instanceof CaAddressSkCaState other)) return false;
        return Objects.equals(this.ca_address_sk, other.ca_address_sk) && Objects.equals(this.ca_state, other.ca_state);
    }
    @Override public int hashCode() {
        return Objects.hash(ca_address_sk, ca_state);
    }
    int size() { return 2; }
}
class WebSiteSkWebCompanyName {
    int web_site_sk;
    String web_company_name;
    WebSiteSkWebCompanyName(int web_site_sk, String web_company_name) {
        this.web_site_sk = web_site_sk;
        this.web_company_name = web_company_name;
    }
    @Override public boolean equals(Object o) {
        if (this == o) return true;
        if (!(o instanceof WebSiteSkWebCompanyName other)) return false;
        return Objects.equals(this.web_site_sk, other.web_site_sk) && Objects.equals(this.web_company_name, other.web_company_name);
    }
    @Override public int hashCode() {
        return Objects.hash(web_site_sk, web_company_name);
    }
    int size() { return 2; }
}
class OrderCountTotalShippingCostTotalNetProfit {
    int order_count;
    double total_shipping_cost;
    double total_net_profit;
    OrderCountTotalShippingCostTotalNetProfit(int order_count, double total_shipping_cost, double total_net_profit) {
        this.order_count = order_count;
        this.total_shipping_cost = total_shipping_cost;
        this.total_net_profit = total_net_profit;
    }
    @Override public boolean equals(Object o) {
        if (this == o) return true;
        if (!(o instanceof OrderCountTotalShippingCostTotalNetProfit other)) return false;
        return Objects.equals(this.order_count, other.order_count) && Objects.equals(this.total_shipping_cost, other.total_shipping_cost) && Objects.equals(this.total_net_profit, other.total_net_profit);
    }
    @Override public int hashCode() {
        return Objects.hash(order_count, total_shipping_cost, total_net_profit);
    }
    int size() { return 3; }
}
public class Q94 {
    static List<any> distinct(List<any> xs) {
        List<Object> out = new ArrayList<>(Arrays.asList());
        for (any x : xs) {
            if (!contains(out, x)) {
                out.add(x);
            }
        }
        return out;
    }
    static <T> List<T> append(List<T> list, T item) {
        List<T> res = new ArrayList<>(list);
        res.add(item);
        return res;
    }
    static Map<String,Object> asMap(Object o) {
        if (o instanceof Map<?,?> mm) {
            LinkedHashMap<String,Object> m = new LinkedHashMap<>();
            for (Map.Entry<?,?> e : mm.entrySet()) m.put(String.valueOf(e.getKey()), e.getValue());
            return m;
        }
        LinkedHashMap<String,Object> m = new LinkedHashMap<>();
        for (var f : o.getClass().getDeclaredFields()) { try { f.setAccessible(true); m.put(f.getName(), f.get(o)); } catch (Exception e) { throw new RuntimeException(e); } }
        return m;
    }
    static void saveJsonl(List<?> list) {
        for (Object obj : list) {
            Map<String,Object> m = asMap(obj);
            List<String> parts = new ArrayList<>();
            for (Map.Entry<?,?> e : m.entrySet()) { parts.add("\"" + e.getKey() + "\":" + e.getValue()); }
            System.out.println("{" + String.join(",", parts) + "}");
        }
    }
    static String toJson(Object o) {
        if (o instanceof Map<?,?> m) {
            StringJoiner j = new StringJoiner(",", "{", "}");
            for (Map.Entry<?,?> e : m.entrySet()) j.add("\"" + e.getKey() + "\":" + toJson(e.getValue()));
            return j.toString();
        } else if (o instanceof Collection<?> c) {
            StringJoiner j = new StringJoiner(",", "[", "]");
            for (var x : c) j.add(toJson(x));
            return j.toString();
        } else if (o instanceof String s) {
            return "\"" + s + "\"";
        } else if (o instanceof Number || o instanceof Boolean || o instanceof Character) {
            return String.valueOf(o);
        } else {
            Map<String,Object> m = asMap(o);
            StringJoiner j = new StringJoiner(",", "{", "}");
            for (Map.Entry<String,Object> e : m.entrySet()) j.add("\"" + e.getKey() + "\":" + toJson(e.getValue()));
            return j.toString();
        }
    }
    static void json(Object o) { System.out.println(toJson(o)); }
    public static void main(String[] args) {
    List<WsOrderNumberWsShipDateSkWsWarehouseSkWsShipAddrSkWsWebSiteSkWsNetProfitWsExtShipCost> web_sales = new ArrayList<>(Arrays.asList(new WsOrderNumberWsShipDateSkWsWarehouseSkWsShipAddrSkWsWebSiteSkWsNetProfitWsExtShipCost(1, 1, 1, 1, 1, 5.000000, 2.000000), new WsOrderNumberWsShipDateSkWsWarehouseSkWsShipAddrSkWsWebSiteSkWsNetProfitWsExtShipCost(1, 1, 2, 1, 1, 0.000000, 0.000000), new WsOrderNumberWsShipDateSkWsWarehouseSkWsShipAddrSkWsWebSiteSkWsNetProfitWsExtShipCost(2, 1, 3, 1, 1, 3.000000, 1.000000)));
    List<WrOrderNumber> web_returns = new ArrayList<>(Arrays.asList(new WrOrderNumber(2)));
    List<DDateSkDDate> date_dim = new ArrayList<>(Arrays.asList(new DDateSkDDate(1, "2001-02-01")));
    List<CaAddressSkCaState> customer_address = new ArrayList<>(Arrays.asList(new CaAddressSkCaState(1, "CA")));
    List<WebSiteSkWebCompanyName> web_site = new ArrayList<>(Arrays.asList(new WebSiteSkWebCompanyName(1, "pri")));
    List<WsOrderNumberWsShipDateSkWsWarehouseSkWsShipAddrSkWsWebSiteSkWsNetProfitWsExtShipCost> filtered = (new java.util.function.Supplier<List<WsOrderNumberWsShipDateSkWsWarehouseSkWsShipAddrSkWsWebSiteSkWsNetProfitWsExtShipCost>>(){public List<WsOrderNumberWsShipDateSkWsWarehouseSkWsShipAddrSkWsWebSiteSkWsNetProfitWsExtShipCost> get(){
    List<WsOrderNumberWsShipDateSkWsWarehouseSkWsShipAddrSkWsWebSiteSkWsNetProfitWsExtShipCost> res0 = new ArrayList<>();
    for (var ws : web_sales) {
        for (var d : date_dim) {
            if (!(ws.ws_ship_date_sk == d.d_date_sk)) continue;
            for (var ca : customer_address) {
                if (!(ws.ws_ship_addr_sk == ca.ca_address_sk)) continue;
                for (var w : web_site) {
                    if (!(ws.ws_web_site_sk == w.web_site_sk)) continue;
                    if (!(Objects.equals(ca.ca_state, "CA") && Objects.equals(w.web_company_name, "pri") && web_sales.stream().anyMatch(ws2 -> Objects.equals(ws.ws_order_number, ws2.ws_order_number) && !Objects.equals(ws.ws_warehouse_sk, ws2.ws_warehouse_sk)) && Objects.equals(web_returns.stream().anyMatch(wr -> Objects.equals(wr.wr_order_number, ws.ws_order_number)), false))) continue;
                    res0.add(ws);
                }
            }
        }
    }
    return res0;
}}).get();
    OrderCountTotalShippingCostTotalNetProfit result = new OrderCountTotalShippingCostTotalNetProfit(distinct((new java.util.function.Supplier<List<Integer>>(){public List<Integer> get(){
    List<Integer> res1 = new ArrayList<>();
    for (var x : filtered) {
        res1.add(x.ws_order_number);
    }
    return res1;
}}).get()).size(), (new java.util.function.Supplier<List<Double>>(){public List<Double> get(){
    List<Double> res2 = new ArrayList<>();
    for (var x : filtered) {
        res2.add(x.ws_ext_ship_cost);
    }
    return res2;
}}).get().stream().mapToDouble(n -> ((Number)n).doubleValue()).sum(), (new java.util.function.Supplier<List<Double>>(){public List<Double> get(){
    List<Double> res3 = new ArrayList<>();
    for (var x : filtered) {
        res3.add(x.ws_net_profit);
    }
    return res3;
}}).get().stream().mapToDouble(n -> ((Number)n).doubleValue()).sum());
    json(result);
    if (!(Objects.equals(result, new OrderCountTotalShippingCostTotalNetProfit(1, 2.000000, 5.000000)))) throw new AssertionError("expect failed");
    }
}
