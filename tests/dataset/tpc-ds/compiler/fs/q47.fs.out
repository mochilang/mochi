// Generated by Mochi compiler v0.10.25 on 2025-07-15T04:47:09Z
open System
open System.Text.Json

type Anon1 = {
    d_year: int
    item: string
    avg_monthly_sales: float
    sum_sales: float
}
let v2: Anon1 list = [{ d_year = 2020; item = "A"; avg_monthly_sales = 100.0; sum_sales = 120.0 }; { d_year = 2020; item = "B"; avg_monthly_sales = 80.0; sum_sales = 70.0 }; { d_year = 2019; item = "C"; avg_monthly_sales = 50.0; sum_sales = 60.0 }]
let year: int = 2020
let orderby: string = "item"
let abs (x) =
    if x >= 0.0 then
        x
    else
        -x
let result: Anon1 list = [ for v in v2 do if v.d_year >= year - 1 && v.avg_monthly_sales > 0 && v.sum_sales > v.avg_monthly_sales && abs v.sum_sales - v.avg_monthly_sales / v.avg_monthly_sales > 0.1 then yield { d_year = v.d_year; item = v.item; avg_monthly_sales = v.avg_monthly_sales; sum_sales = v.sum_sales } ] |> List.sortBy (fun v -> [v.sum_sales - v.avg_monthly_sales; v.item])
printfn "%A" (JsonSerializer.Serialize(result))
assert (result = [{ d_year = 2019; item = "C"; avg_monthly_sales = 50.0; sum_sales = 60.0 }; { d_year = 2020; item = "A"; avg_monthly_sales = 100.0; sum_sales = 120.0 }])
