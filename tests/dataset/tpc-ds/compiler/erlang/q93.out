%    9|     T = [#{ss_customer_sk => mochi_get(ss_customer_sk, Ss), act_sales => (case (Sr /= undefined) of true -> (((mochi_get(ss_quantity, Ss) - mochi_get(sr_return_quantity, Sr))) * mochi_get(ss_sales_price, Ss)); _ -> (mochi_get(ss_quantity, Ss) * mochi_get(ss_sales_price, Ss)) end)} || Ss <- Store_sales, {Ss, Sr} <- mochi_left_join_item(Ss, Store_returns, fun(Ss, Sr) -> ((mochi_get(ss_item_sk, Ss) == mochi_get(sr_item_sk, Sr)) andalso (mochi_get(ss_ticket_number, Ss) == mochi_get(sr_ticket_number, Sr))) end), {Ss, R} <- mochi_left_join_item(Ss, Reason, fun(Ss, R) -> ((Sr /= undefined) andalso (mochi_get(sr_reason_sk, Sr) == mochi_get(r_reason_sk, R))) end), ((R == undefined) orelse (mochi_get(r_reason_desc, R) == "ReasonA"))],
%     |                                                                                                                                                                                                                                                                                                                  ^
%    9|     T = [#{ss_customer_sk => mochi_get(ss_customer_sk, Ss), act_sales => (case (Sr /= undefined) of true -> (((mochi_get(ss_quantity, Ss) - mochi_get(sr_return_quantity, Sr))) * mochi_get(ss_sales_price, Ss)); _ -> (mochi_get(ss_quantity, Ss) * mochi_get(ss_sales_price, Ss)) end)} || Ss <- Store_sales, {Ss, Sr} <- mochi_left_join_item(Ss, Store_returns, fun(Ss, Sr) -> ((mochi_get(ss_item_sk, Ss) == mochi_get(sr_item_sk, Sr)) andalso (mochi_get(ss_ticket_number, Ss) == mochi_get(sr_ticket_number, Sr))) end), {Ss, R} <- mochi_left_join_item(Ss, Reason, fun(Ss, R) -> ((Sr /= undefined) andalso (mochi_get(sr_reason_sk, Sr) == mochi_get(r_reason_sk, R))) end), ((R == undefined) orelse (mochi_get(r_reason_desc, R) == "ReasonA"))],
%     |                                                                                                                                                                                                                                                                                                                                                                         ^
%    9|     T = [#{ss_customer_sk => mochi_get(ss_customer_sk, Ss), act_sales => (case (Sr /= undefined) of true -> (((mochi_get(ss_quantity, Ss) - mochi_get(sr_return_quantity, Sr))) * mochi_get(ss_sales_price, Ss)); _ -> (mochi_get(ss_quantity, Ss) * mochi_get(ss_sales_price, Ss)) end)} || Ss <- Store_sales, {Ss, Sr} <- mochi_left_join_item(Ss, Store_returns, fun(Ss, Sr) -> ((mochi_get(ss_item_sk, Ss) == mochi_get(sr_item_sk, Sr)) andalso (mochi_get(ss_ticket_number, Ss) == mochi_get(sr_ticket_number, Sr))) end), {Ss, R} <- mochi_left_join_item(Ss, Reason, fun(Ss, R) -> ((Sr /= undefined) andalso (mochi_get(sr_reason_sk, Sr) == mochi_get(r_reason_sk, R))) end), ((R == undefined) orelse (mochi_get(r_reason_desc, R) == "ReasonA"))],
%     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ^
%    9|     T = [#{ss_customer_sk => mochi_get(ss_customer_sk, Ss), act_sales => (case (Sr /= undefined) of true -> (((mochi_get(ss_quantity, Ss) - mochi_get(sr_return_quantity, Sr))) * mochi_get(ss_sales_price, Ss)); _ -> (mochi_get(ss_quantity, Ss) * mochi_get(ss_sales_price, Ss)) end)} || Ss <- Store_sales, {Ss, Sr} <- mochi_left_join_item(Ss, Store_returns, fun(Ss, Sr) -> ((mochi_get(ss_item_sk, Ss) == mochi_get(sr_item_sk, Sr)) andalso (mochi_get(ss_ticket_number, Ss) == mochi_get(sr_ticket_number, Sr))) end), {Ss, R} <- mochi_left_join_item(Ss, Reason, fun(Ss, R) -> ((Sr /= undefined) andalso (mochi_get(sr_reason_sk, Sr) == mochi_get(r_reason_sk, R))) end), ((R == undefined) orelse (mochi_get(r_reason_desc, R) == "ReasonA"))],
%     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  ^
%    9|     T = [#{ss_customer_sk => mochi_get(ss_customer_sk, Ss), act_sales => (case (Sr /= undefined) of true -> (((mochi_get(ss_quantity, Ss) - mochi_get(sr_return_quantity, Sr))) * mochi_get(ss_sales_price, Ss)); _ -> (mochi_get(ss_quantity, Ss) * mochi_get(ss_sales_price, Ss)) end)} || Ss <- Store_sales, {Ss, Sr} <- mochi_left_join_item(Ss, Store_returns, fun(Ss, Sr) -> ((mochi_get(ss_item_sk, Ss) == mochi_get(sr_item_sk, Sr)) andalso (mochi_get(ss_ticket_number, Ss) == mochi_get(sr_ticket_number, Sr))) end), {Ss, R} <- mochi_left_join_item(Ss, Reason, fun(Ss, R) -> ((Sr /= undefined) andalso (mochi_get(sr_reason_sk, Sr) == mochi_get(r_reason_sk, R))) end), ((R == undefined) orelse (mochi_get(r_reason_desc, R) == "ReasonA"))],
%     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  ^
%   21| mochi_left_join(L, R, Fun) ->
%     | ^
[{"ss_customer_sk":1,"sumsales":40},{"ss_customer_sk":2,"sumsales":60}]
