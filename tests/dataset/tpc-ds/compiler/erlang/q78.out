%    9|     Result = [#{ss_sold_year => maps:get(ss_sold_year, S), ss_item_sk => maps:get(ss_item_sk, S), ss_customer_sk => maps:get(ss_customer_sk, S), ratio => (maps:get(ss_qty, S) / ((((case (W == undefined) of true -> 0; _ -> maps:get(ws_qty, W) end)) + ((case (C == undefined) of true -> 0; _ -> maps:get(cs_qty, C) end))))), store_qty => maps:get(ss_qty, S), store_wholesale_cost => maps:get(ss_wc, S), store_sales_price => maps:get(ss_sp, S), other_chan_qty => (((case (W == undefined) of true -> 0; _ -> maps:get(ws_qty, W) end)) + ((case (C == undefined) of true -> 0; _ -> maps:get(cs_qty, C) end))), other_chan_wholesale_cost => (((case (W == undefined) of true -> 0; _ -> maps:get(ws_wc, W) end)) + ((case (C == undefined) of true -> 0; _ -> maps:get(cs_wc, C) end))), other_chan_sales_price => (((case (W == undefined) of true -> 0; _ -> maps:get(ws_sp, W) end)) + ((case (C == undefined) of true -> 0; _ -> maps:get(cs_sp, C) end)))} || S <- Ss, {S, W} <- mochi_left_join_item(S, Ws, fun(S, W) -> (((maps:get(ws_sold_year, W) == maps:get(ss_sold_year, S)) andalso (maps:get(ws_item_sk, W) == maps:get(ss_item_sk, S))) andalso (maps:get(ws_customer_sk, W) == maps:get(ss_customer_sk, S))) end), {S, C} <- mochi_left_join_item(S, Cs, fun(S, C) -> (((maps:get(cs_sold_year, C) == maps:get(ss_sold_year, S)) andalso (maps:get(cs_item_sk, C) == maps:get(ss_item_sk, S))) andalso (maps:get(cs_customer_sk, C) == maps:get(ss_customer_sk, S))) end), ((((((case (W == undefined) of true -> 0; _ -> maps:get(ws_qty, W) end)) > 0) orelse (((case (C == undefined) of true -> 0; _ -> maps:get(cs_qty, C) end)) > 0))) andalso (maps:get(ss_sold_year, S) == 1998))],
%     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          ^
%    9|     Result = [#{ss_sold_year => maps:get(ss_sold_year, S), ss_item_sk => maps:get(ss_item_sk, S), ss_customer_sk => maps:get(ss_customer_sk, S), ratio => (maps:get(ss_qty, S) / ((((case (W == undefined) of true -> 0; _ -> maps:get(ws_qty, W) end)) + ((case (C == undefined) of true -> 0; _ -> maps:get(cs_qty, C) end))))), store_qty => maps:get(ss_qty, S), store_wholesale_cost => maps:get(ss_wc, S), store_sales_price => maps:get(ss_sp, S), other_chan_qty => (((case (W == undefined) of true -> 0; _ -> maps:get(ws_qty, W) end)) + ((case (C == undefined) of true -> 0; _ -> maps:get(cs_qty, C) end))), other_chan_wholesale_cost => (((case (W == undefined) of true -> 0; _ -> maps:get(ws_wc, W) end)) + ((case (C == undefined) of true -> 0; _ -> maps:get(cs_wc, C) end))), other_chan_sales_price => (((case (W == undefined) of true -> 0; _ -> maps:get(ws_sp, W) end)) + ((case (C == undefined) of true -> 0; _ -> maps:get(cs_sp, C) end)))} || S <- Ss, {S, W} <- mochi_left_join_item(S, Ws, fun(S, W) -> (((maps:get(ws_sold_year, W) == maps:get(ss_sold_year, S)) andalso (maps:get(ws_item_sk, W) == maps:get(ss_item_sk, S))) andalso (maps:get(ws_customer_sk, W) == maps:get(ss_customer_sk, S))) end), {S, C} <- mochi_left_join_item(S, Cs, fun(S, C) -> (((maps:get(cs_sold_year, C) == maps:get(ss_sold_year, S)) andalso (maps:get(cs_item_sk, C) == maps:get(ss_item_sk, S))) andalso (maps:get(cs_customer_sk, C) == maps:get(ss_customer_sk, S))) end), ((((((case (W == undefined) of true -> 0; _ -> maps:get(ws_qty, W) end)) > 0) orelse (((case (C == undefined) of true -> 0; _ -> maps:get(cs_qty, C) end)) > 0))) andalso (maps:get(ss_sold_year, S) == 1998))],
%     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   ^
%    9|     Result = [#{ss_sold_year => maps:get(ss_sold_year, S), ss_item_sk => maps:get(ss_item_sk, S), ss_customer_sk => maps:get(ss_customer_sk, S), ratio => (maps:get(ss_qty, S) / ((((case (W == undefined) of true -> 0; _ -> maps:get(ws_qty, W) end)) + ((case (C == undefined) of true -> 0; _ -> maps:get(cs_qty, C) end))))), store_qty => maps:get(ss_qty, S), store_wholesale_cost => maps:get(ss_wc, S), store_sales_price => maps:get(ss_sp, S), other_chan_qty => (((case (W == undefined) of true -> 0; _ -> maps:get(ws_qty, W) end)) + ((case (C == undefined) of true -> 0; _ -> maps:get(cs_qty, C) end))), other_chan_wholesale_cost => (((case (W == undefined) of true -> 0; _ -> maps:get(ws_wc, W) end)) + ((case (C == undefined) of true -> 0; _ -> maps:get(cs_wc, C) end))), other_chan_sales_price => (((case (W == undefined) of true -> 0; _ -> maps:get(ws_sp, W) end)) + ((case (C == undefined) of true -> 0; _ -> maps:get(cs_sp, C) end)))} || S <- Ss, {S, W} <- mochi_left_join_item(S, Ws, fun(S, W) -> (((maps:get(ws_sold_year, W) == maps:get(ss_sold_year, S)) andalso (maps:get(ws_item_sk, W) == maps:get(ss_item_sk, S))) andalso (maps:get(ws_customer_sk, W) == maps:get(ss_customer_sk, S))) end), {S, C} <- mochi_left_join_item(S, Cs, fun(S, C) -> (((maps:get(cs_sold_year, C) == maps:get(ss_sold_year, S)) andalso (maps:get(cs_item_sk, C) == maps:get(ss_item_sk, S))) andalso (maps:get(cs_customer_sk, C) == maps:get(ss_customer_sk, S))) end), ((((((case (W == undefined) of true -> 0; _ -> maps:get(ws_qty, W) end)) > 0) orelse (((case (C == undefined) of true -> 0; _ -> maps:get(cs_qty, C) end)) > 0))) andalso (maps:get(ss_sold_year, S) == 1998))],
%     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  ^
%    9|     Result = [#{ss_sold_year => maps:get(ss_sold_year, S), ss_item_sk => maps:get(ss_item_sk, S), ss_customer_sk => maps:get(ss_customer_sk, S), ratio => (maps:get(ss_qty, S) / ((((case (W == undefined) of true -> 0; _ -> maps:get(ws_qty, W) end)) + ((case (C == undefined) of true -> 0; _ -> maps:get(cs_qty, C) end))))), store_qty => maps:get(ss_qty, S), store_wholesale_cost => maps:get(ss_wc, S), store_sales_price => maps:get(ss_sp, S), other_chan_qty => (((case (W == undefined) of true -> 0; _ -> maps:get(ws_qty, W) end)) + ((case (C == undefined) of true -> 0; _ -> maps:get(cs_qty, C) end))), other_chan_wholesale_cost => (((case (W == undefined) of true -> 0; _ -> maps:get(ws_wc, W) end)) + ((case (C == undefined) of true -> 0; _ -> maps:get(cs_wc, C) end))), other_chan_sales_price => (((case (W == undefined) of true -> 0; _ -> maps:get(ws_sp, W) end)) + ((case (C == undefined) of true -> 0; _ -> maps:get(cs_sp, C) end)))} || S <- Ss, {S, W} <- mochi_left_join_item(S, Ws, fun(S, W) -> (((maps:get(ws_sold_year, W) == maps:get(ss_sold_year, S)) andalso (maps:get(ws_item_sk, W) == maps:get(ss_item_sk, S))) andalso (maps:get(ws_customer_sk, W) == maps:get(ss_customer_sk, S))) end), {S, C} <- mochi_left_join_item(S, Cs, fun(S, C) -> (((maps:get(cs_sold_year, C) == maps:get(ss_sold_year, S)) andalso (maps:get(cs_item_sk, C) == maps:get(ss_item_sk, S))) andalso (maps:get(cs_customer_sk, C) == maps:get(ss_customer_sk, S))) end), ((((((case (W == undefined) of true -> 0; _ -> maps:get(ws_qty, W) end)) > 0) orelse (((case (C == undefined) of true -> 0; _ -> maps:get(cs_qty, C) end)) > 0))) andalso (maps:get(ss_sold_year, S) == 1998))],
%     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           ^
%   20| mochi_left_join(L, R, Fun) ->
%     | ^
[{"ss_sold_year":1998,"ss_item_sk":1,"ss_customer_sk":1,"ratio":1.25,"store_qty":10,"store_wholesale_cost":50,"store_sales_price":100,"other_chan_qty":8,"other_chan_wholesale_cost":40,"other_chan_sales_price":80}]
