run: exit status 127
/tmp/q77.erl:19:19: function concat/3 undefined
%   19|     Per_channel = concat([#{channel => "store channel", id => maps:get(s_store_sk, S), sales => maps:get(sales, S), returns => (case (R == undefined) of true -> 0; _ -> maps:get(returns, R) end), profit => (maps:get(profit, S) - ((case (R == undefined) of true -> 0; _ -> maps:get(profit_loss, R) end)))} || S <- Ss, {S, R} <- mochi_left_join_item(S, Sr, fun(S, R) -> (maps:get(s_store_sk, S) == maps:get(s_store_sk, R)) end)], [#{channel => "catalog channel", id => maps:get(cs_call_center_sk, C), sales => maps:get(sales, C), returns => maps:get(returns, R), profit => (maps:get(profit, C) - maps:get(profit_loss, R))} || C <- Cs, R <- Cr, (maps:get(cs_call_center_sk, C) == maps:get(cr_call_center_sk, R))], [#{channel => "web channel", id => maps:get(wp_web_page_sk, W), sales => maps:get(sales, W), returns => (case (R == undefined) of true -> 0; _ -> maps:get(returns, R) end), profit => (maps:get(profit, W) - ((case (R == undefined) of true -> 0; _ -> maps:get(profit_loss, R) end)))} || W <- Ws, {W, R} <- mochi_left_join_item(W, Wr, fun(W, R) -> (maps:get(wp_web_page_sk, W) == maps:get(wp_web_page_sk, R)) end)]),
%     |                   ^

/tmp/q77.erl:19:319: Warning: variable 'S' shadowed in generate
%   19|     Per_channel = concat([#{channel => "store channel", id => maps:get(s_store_sk, S), sales => maps:get(sales, S), returns => (case (R == undefined) of true -> 0; _ -> maps:get(returns, R) end), profit => (maps:get(profit, S) - ((case (R == undefined) of true -> 0; _ -> maps:get(profit_loss, R) end)))} || S <- Ss, {S, R} <- mochi_left_join_item(S, Sr, fun(S, R) -> (maps:get(s_store_sk, S) == maps:get(s_store_sk, R)) end)], [#{channel => "catalog channel", id => maps:get(cs_call_center_sk, C), sales => maps:get(sales, C), returns => maps:get(returns, R), profit => (maps:get(profit, C) - maps:get(profit_loss, R))} || C <- Cs, R <- Cr, (maps:get(cs_call_center_sk, C) == maps:get(cr_call_center_sk, R))], [#{channel => "web channel", id => maps:get(wp_web_page_sk, W), sales => maps:get(sales, W), returns => (case (R == undefined) of true -> 0; _ -> maps:get(returns, R) end), profit => (maps:get(profit, W) - ((case (R == undefined) of true -> 0; _ -> maps:get(profit_loss, R) end)))} || W <- Ws, {W, R} <- mochi_left_join_item(W, Wr, fun(W, R) -> (maps:get(wp_web_page_sk, W) == maps:get(wp_web_page_sk, R)) end)]),
%     |                                                                                                                                                                                                                                                                                                                               ^

/tmp/q77.erl:19:360: Warning: variable 'S' shadowed in 'fun'
%   19|     Per_channel = concat([#{channel => "store channel", id => maps:get(s_store_sk, S), sales => maps:get(sales, S), returns => (case (R == undefined) of true -> 0; _ -> maps:get(returns, R) end), profit => (maps:get(profit, S) - ((case (R == undefined) of true -> 0; _ -> maps:get(profit_loss, R) end)))} || S <- Ss, {S, R} <- mochi_left_join_item(S, Sr, fun(S, R) -> (maps:get(s_store_sk, S) == maps:get(s_store_sk, R)) end)], [#{channel => "catalog channel", id => maps:get(cs_call_center_sk, C), sales => maps:get(sales, C), returns => maps:get(returns, R), profit => (maps:get(profit, C) - maps:get(profit_loss, R))} || C <- Cs, R <- Cr, (maps:get(cs_call_center_sk, C) == maps:get(cr_call_center_sk, R))], [#{channel => "web channel", id => maps:get(wp_web_page_sk, W), sales => maps:get(sales, W), returns => (case (R == undefined) of true -> 0; _ -> maps:get(returns, R) end), profit => (maps:get(profit, W) - ((case (R == undefined) of true -> 0; _ -> maps:get(profit_loss, R) end)))} || W <- Ws, {W, R} <- mochi_left_join_item(W, Wr, fun(W, R) -> (maps:get(wp_web_page_sk, W) == maps:get(wp_web_page_sk, R)) end)]),
%     |                                                                                                                                                                                                                                                                                                                                                                        ^

/tmp/q77.erl:19:1007: Warning: variable 'W' shadowed in generate
%   19|     Per_channel = concat([#{channel => "store channel", id => maps:get(s_store_sk, S), sales => maps:get(sales, S), returns => (case (R == undefined) of true -> 0; _ -> maps:get(returns, R) end), profit => (maps:get(profit, S) - ((case (R == undefined) of true -> 0; _ -> maps:get(profit_loss, R) end)))} || S <- Ss, {S, R} <- mochi_left_join_item(S, Sr, fun(S, R) -> (maps:get(s_store_sk, S) == maps:get(s_store_sk, R)) end)], [#{channel => "catalog channel", id => maps:get(cs_call_center_sk, C), sales => maps:get(sales, C), returns => maps:get(returns, R), profit => (maps:get(profit, C) - maps:get(profit_loss, R))} || C <- Cs, R <- Cr, (maps:get(cs_call_center_sk, C) == maps:get(cr_call_center_sk, R))], [#{channel => "web channel", id => maps:get(wp_web_page_sk, W), sales => maps:get(sales, W), returns => (case (R == undefined) of true -> 0; _ -> maps:get(returns, R) end), profit => (maps:get(profit, W) - ((case (R == undefined) of true -> 0; _ -> maps:get(profit_loss, R) end)))} || W <- Ws, {W, R} <- mochi_left_join_item(W, Wr, fun(W, R) -> (maps:get(wp_web_page_sk, W) == maps:get(wp_web_page_sk, R)) end)]),
%     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               ^

/tmp/q77.erl:19:1048: Warning: variable 'W' shadowed in 'fun'
%   19|     Per_channel = concat([#{channel => "store channel", id => maps:get(s_store_sk, S), sales => maps:get(sales, S), returns => (case (R == undefined) of true -> 0; _ -> maps:get(returns, R) end), profit => (maps:get(profit, S) - ((case (R == undefined) of true -> 0; _ -> maps:get(profit_loss, R) end)))} || S <- Ss, {S, R} <- mochi_left_join_item(S, Sr, fun(S, R) -> (maps:get(s_store_sk, S) == maps:get(s_store_sk, R)) end)], [#{channel => "catalog channel", id => maps:get(cs_call_center_sk, C), sales => maps:get(sales, C), returns => maps:get(returns, R), profit => (maps:get(profit, C) - maps:get(profit_loss, R))} || C <- Cs, R <- Cr, (maps:get(cs_call_center_sk, C) == maps:get(cr_call_center_sk, R))], [#{channel => "web channel", id => maps:get(wp_web_page_sk, W), sales => maps:get(sales, W), returns => (case (R == undefined) of true -> 0; _ -> maps:get(returns, R) end), profit => (maps:get(profit, W) - ((case (R == undefined) of true -> 0; _ -> maps:get(profit_loss, R) end)))} || W <- Ws, {W, R} <- mochi_left_join_item(W, Wr, fun(W, R) -> (maps:get(wp_web_page_sk, W) == maps:get(wp_web_page_sk, R)) end)]),
%     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        ^

/tmp/q77.erl:31:1: Warning: function mochi_left_join/3 is unused
%   31| mochi_left_join(L, R, Fun) ->
%     | ^

escript: There were compilation errors.
