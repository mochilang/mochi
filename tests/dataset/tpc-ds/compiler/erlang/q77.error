run: exit status 127
/tmp/q77.erl:19:19: function concat/3 undefined
%   19|     Per_channel = concat([#{channel => "store channel", id => mochi_get(s_store_sk, S), sales => mochi_get(sales, S), returns => (case (R == undefined) of true -> 0; _ -> mochi_get(returns, R) end), profit => (mochi_get(profit, S) - ((case (R == undefined) of true -> 0; _ -> mochi_get(profit_loss, R) end)))} || S <- Ss, {S, R} <- mochi_left_join_item(S, Sr, fun(S, R) -> (mochi_get(s_store_sk, S) == mochi_get(s_store_sk, R)) end)], [#{channel => "catalog channel", id => mochi_get(cs_call_center_sk, C), sales => mochi_get(sales, C), returns => mochi_get(returns, R), profit => (mochi_get(profit, C) - mochi_get(profit_loss, R))} || C <- Cs, R <- Cr, (mochi_get(cs_call_center_sk, C) == mochi_get(cr_call_center_sk, R))], [#{channel => "web channel", id => mochi_get(wp_web_page_sk, W), sales => mochi_get(sales, W), returns => (case (R == undefined) of true -> 0; _ -> mochi_get(returns, R) end), profit => (mochi_get(profit, W) - ((case (R == undefined) of true -> 0; _ -> mochi_get(profit_loss, R) end)))} || W <- Ws, {W, R} <- mochi_left_join_item(W, Wr, fun(W, R) -> (mochi_get(wp_web_page_sk, W) == mochi_get(wp_web_page_sk, R)) end)]),
%     |                   ^

/tmp/q77.erl:19:324: Warning: variable 'S' shadowed in generate
%   19|     Per_channel = concat([#{channel => "store channel", id => mochi_get(s_store_sk, S), sales => mochi_get(sales, S), returns => (case (R == undefined) of true -> 0; _ -> mochi_get(returns, R) end), profit => (mochi_get(profit, S) - ((case (R == undefined) of true -> 0; _ -> mochi_get(profit_loss, R) end)))} || S <- Ss, {S, R} <- mochi_left_join_item(S, Sr, fun(S, R) -> (mochi_get(s_store_sk, S) == mochi_get(s_store_sk, R)) end)], [#{channel => "catalog channel", id => mochi_get(cs_call_center_sk, C), sales => mochi_get(sales, C), returns => mochi_get(returns, R), profit => (mochi_get(profit, C) - mochi_get(profit_loss, R))} || C <- Cs, R <- Cr, (mochi_get(cs_call_center_sk, C) == mochi_get(cr_call_center_sk, R))], [#{channel => "web channel", id => mochi_get(wp_web_page_sk, W), sales => mochi_get(sales, W), returns => (case (R == undefined) of true -> 0; _ -> mochi_get(returns, R) end), profit => (mochi_get(profit, W) - ((case (R == undefined) of true -> 0; _ -> mochi_get(profit_loss, R) end)))} || W <- Ws, {W, R} <- mochi_left_join_item(W, Wr, fun(W, R) -> (mochi_get(wp_web_page_sk, W) == mochi_get(wp_web_page_sk, R)) end)]),
%     |                                                                                                                                                                                                                                                                                                                                    ^

/tmp/q77.erl:19:365: Warning: variable 'S' shadowed in 'fun'
%   19|     Per_channel = concat([#{channel => "store channel", id => mochi_get(s_store_sk, S), sales => mochi_get(sales, S), returns => (case (R == undefined) of true -> 0; _ -> mochi_get(returns, R) end), profit => (mochi_get(profit, S) - ((case (R == undefined) of true -> 0; _ -> mochi_get(profit_loss, R) end)))} || S <- Ss, {S, R} <- mochi_left_join_item(S, Sr, fun(S, R) -> (mochi_get(s_store_sk, S) == mochi_get(s_store_sk, R)) end)], [#{channel => "catalog channel", id => mochi_get(cs_call_center_sk, C), sales => mochi_get(sales, C), returns => mochi_get(returns, R), profit => (mochi_get(profit, C) - mochi_get(profit_loss, R))} || C <- Cs, R <- Cr, (mochi_get(cs_call_center_sk, C) == mochi_get(cr_call_center_sk, R))], [#{channel => "web channel", id => mochi_get(wp_web_page_sk, W), sales => mochi_get(sales, W), returns => (case (R == undefined) of true -> 0; _ -> mochi_get(returns, R) end), profit => (mochi_get(profit, W) - ((case (R == undefined) of true -> 0; _ -> mochi_get(profit_loss, R) end)))} || W <- Ws, {W, R} <- mochi_left_join_item(W, Wr, fun(W, R) -> (mochi_get(wp_web_page_sk, W) == mochi_get(wp_web_page_sk, R)) end)]),
%     |                                                                                                                                                                                                                                                                                                                                                                             ^

/tmp/q77.erl:19:1026: Warning: variable 'W' shadowed in generate
%   19|     Per_channel = concat([#{channel => "store channel", id => mochi_get(s_store_sk, S), sales => mochi_get(sales, S), returns => (case (R == undefined) of true -> 0; _ -> mochi_get(returns, R) end), profit => (mochi_get(profit, S) - ((case (R == undefined) of true -> 0; _ -> mochi_get(profit_loss, R) end)))} || S <- Ss, {S, R} <- mochi_left_join_item(S, Sr, fun(S, R) -> (mochi_get(s_store_sk, S) == mochi_get(s_store_sk, R)) end)], [#{channel => "catalog channel", id => mochi_get(cs_call_center_sk, C), sales => mochi_get(sales, C), returns => mochi_get(returns, R), profit => (mochi_get(profit, C) - mochi_get(profit_loss, R))} || C <- Cs, R <- Cr, (mochi_get(cs_call_center_sk, C) == mochi_get(cr_call_center_sk, R))], [#{channel => "web channel", id => mochi_get(wp_web_page_sk, W), sales => mochi_get(sales, W), returns => (case (R == undefined) of true -> 0; _ -> mochi_get(returns, R) end), profit => (mochi_get(profit, W) - ((case (R == undefined) of true -> 0; _ -> mochi_get(profit_loss, R) end)))} || W <- Ws, {W, R} <- mochi_left_join_item(W, Wr, fun(W, R) -> (mochi_get(wp_web_page_sk, W) == mochi_get(wp_web_page_sk, R)) end)]),
%     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  ^

/tmp/q77.erl:19:1067: Warning: variable 'W' shadowed in 'fun'
%   19|     Per_channel = concat([#{channel => "store channel", id => mochi_get(s_store_sk, S), sales => mochi_get(sales, S), returns => (case (R == undefined) of true -> 0; _ -> mochi_get(returns, R) end), profit => (mochi_get(profit, S) - ((case (R == undefined) of true -> 0; _ -> mochi_get(profit_loss, R) end)))} || S <- Ss, {S, R} <- mochi_left_join_item(S, Sr, fun(S, R) -> (mochi_get(s_store_sk, S) == mochi_get(s_store_sk, R)) end)], [#{channel => "catalog channel", id => mochi_get(cs_call_center_sk, C), sales => mochi_get(sales, C), returns => mochi_get(returns, R), profit => (mochi_get(profit, C) - mochi_get(profit_loss, R))} || C <- Cs, R <- Cr, (mochi_get(cs_call_center_sk, C) == mochi_get(cr_call_center_sk, R))], [#{channel => "web channel", id => mochi_get(wp_web_page_sk, W), sales => mochi_get(sales, W), returns => (case (R == undefined) of true -> 0; _ -> mochi_get(returns, R) end), profit => (mochi_get(profit, W) - ((case (R == undefined) of true -> 0; _ -> mochi_get(profit_loss, R) end)))} || W <- Ws, {W, R} <- mochi_left_join_item(W, Wr, fun(W, R) -> (mochi_get(wp_web_page_sk, W) == mochi_get(wp_web_page_sk, R)) end)]),
%     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           ^

/tmp/q77.erl:31:1: Warning: function mochi_left_join/3 is unused
%   31| mochi_left_join(L, R, Fun) ->
%     | ^

escript: There were compilation errors.
