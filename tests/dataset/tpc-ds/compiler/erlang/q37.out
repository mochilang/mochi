%   10|     Result = [V || {_, V} <- lists:keysort(1, [{mochi_get(id, Key0), #{i_item_id => mochi_get(id, Key0), i_item_desc => mochi_get(desc, Key0), i_current_price => mochi_get(price, Key0)}} || {Key0, Val0} <- maps:to_list(lists:foldl(fun({Key0, Val0}, Acc0) -> L = maps:get(Key0, Acc0, []), maps:put(Key0, [Val0 | L], Acc0) end, #{}, [{#{id => mochi_get(i_item_id, I), desc => mochi_get(i_item_desc, I), price => mochi_get(i_current_price, I)}, #{i => I, inv => Inv, d => D, cs => Cs}} || I <- Item, Inv <- Inventory, D <- Date_dim, Cs <- Catalog_sales, (mochi_get(i_item_sk, I) == mochi_get(inv_item_sk, Inv)), (mochi_get(inv_date_sk, Inv) == mochi_get(d_date_sk, D)), (mochi_get(cs_item_sk, Cs) == mochi_get(i_item_sk, I)), ((((((mochi_get(i_current_price, I) >= 20) andalso (mochi_get(i_current_price, I) =< 50)) andalso (mochi_get(i_manufact_id, I) >= 800)) andalso (mochi_get(i_manufact_id, I) =< 803)) andalso (mochi_get(inv_quantity_on_hand, Inv) >= 100)) andalso (mochi_get(inv_quantity_on_hand, Inv) =< 500))]))])],
%     |                                                                                                                                                                                                      ^
[{"i_item_id":"I1","i_item_desc":"Item1","i_current_price":30}]
