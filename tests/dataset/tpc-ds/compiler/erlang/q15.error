run: exit status 127
/tmp/q15.erl:10:678: function substr/3 undefined
%   10|     Filtered = [V || {_, V} <- lists:keysort(1, [{maps:get(zip, Key0), #{ca_zip => maps:get(zip, Key0), sum_sales => lists:sum([maps:get(cs_sales_price, X) || X <- Val0])}} || {Key0, Val0} <- maps:to_list(lists:foldl(fun({Key0, Val0}, Acc0) -> L = maps:get(Key0, Acc0, []), maps:put(Key0, [Val0 | L], Acc0) end, #{}, [{#{zip => maps:get(ca_zip, Ca)}, #{cs => Cs, c => C, ca => Ca, d => D}} || Cs <- Catalog_sales, C <- Customer, Ca <- Customer_address, D <- Date_dim, (maps:get(cs_bill_customer_sk, Cs) == maps:get(c_customer_sk, C)), (maps:get(c_current_addr_sk, C) == maps:get(ca_address_sk, Ca)), (maps:get(cs_sold_date_sk, Cs) == maps:get(d_date_sk, D)), (((((lists:member(substr(maps:get(ca_zip, Ca), 0, 5), ["85669", "86197", "88274", "83405", "86475", "85392", "85460", "80348", "81792"]) orelse lists:member(maps:get(ca_state, Ca), ["CA", "WA", "GA"])) orelse (maps:get(cs_sales_price, Cs) > 500))) andalso (maps:get(d_qoy, D) == 1)) andalso (maps:get(d_year, D) == 2000))]))])],
%     |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      ^

escript: There were compilation errors.
