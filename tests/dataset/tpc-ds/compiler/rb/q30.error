/tmp/q30.rb:210:in `block (2 levels) in <main>': undefined method `wr_return_amt' for [#<OpenStruct wr_returning_customer_sk=1, wr_returned_date_sk=1, wr_return_amt=100.0, wr_returning_addr_sk=1>, #<OpenStruct d_date_sk=1, d_year=2000>, #<OpenStruct ca_address_sk=1, ca_state="CA">]:Array (NoMethodError)

		_res << OpenStruct.new(ctr_customer_sk: g.key.cust, ctr_state: g.key.state, ctr_total_return: _sum(((g)).map { |x| x.wr_return_amt }))
		                                                                                                                    ^^^^^^^^^^^^^^
	from /tmp/q30.rb:30:in `each'
	from /tmp/q30.rb:30:in `each'
	from /tmp/q30.rb:210:in `map'
	from /tmp/q30.rb:210:in `block in <main>'
	from /tmp/q30.rb:209:in `each'
	from /tmp/q30.rb:209:in `<main>'
