/tmp/q98.rb:203:in `block (2 levels) in <main>': undefined method `ss_ext_sales_price' for [#<OpenStruct ss_item_sk=1, ss_sold_date_sk=1, ss_ext_sales_price=50.0>, #<OpenStruct i_item_sk=1, i_item_id="I1", i_item_desc="desc1", i_category="CatA", i_class="Class1", i_current_price=100.0>, #<OpenStruct d_date_sk=1, d_date="2000-02-01">]:Array (NoMethodError)

		_res << OpenStruct.new(i_item_id: g.key.item_id, i_item_desc: g.key.item_desc, i_category: g.key.category, i_class: g.key._class, i_current_price: g.key.price, itemrevenue: _sum(((g)).map { |x| x.ss_ext_sales_price }))
		                                                                                                                                                                                                   ^^^^^^^^^^^^^^^^^^^
	from /tmp/q98.rb:18:in `each'
	from /tmp/q98.rb:18:in `each'
	from /tmp/q98.rb:203:in `map'
	from /tmp/q98.rb:203:in `block in <main>'
	from /tmp/q98.rb:202:in `each'
	from /tmp/q98.rb:202:in `<main>'
