% Generated by Mochi compiler v0.10.26 on 2025-07-15T06:39:05Z
:- style_check(-singleton).
:- use_module(library(http/json)).
load_data(Path, Opts, Rows) :-
    (is_dict(Opts), get_dict(format, Opts, Fmt) -> true ; Fmt = 'json'),
    (Path == '' ; Path == '-' -> read_string(user_input, _, Text) ; read_file_to_string(Path, Text, [])),
    (Fmt == 'jsonl' ->
        split_string(Text, '\n', ' \t\r', Lines0),
        exclude(=(''), Lines0, Lines),
        findall(D, (member(L, Lines), open_string(L, S), json_read_dict(S, D), close(S)), Rows)
    ;
        open_string(Text, S), json_read_dict(S, Data), close(S),
        (is_list(Data) -> Rows = Data ; Rows = [Data])
    ).

expect(Cond) :- (Cond -> true ; throw(error('expect failed'))).

:- initialization(main, main).
main :-
    dict_create(_V0, map, [item-1, cost-20, list-30, coupon-5]),
    Store_sales = [_V0],
    dict_create(_V1, map, [item-1, ticket-1]),
    Store_returns = [_V1],
    Result is (((20 + 30) - 5) + 19),
    json_write_dict(current_output, Result), nl,
    true,
    expect((Result == 64)),
    true.
