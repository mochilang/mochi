# TPC-DS Query 90 â€“ Morning vs Evening Web Sales (Simplified)

This example compares web sales made by households with a specific dependent count during an AM hour and a PM hour.  The ratio of the two counts is returned.

## SQL
```sql
SELECT CAST(amc AS decimal(15,4)) / CAST(pmc AS decimal(15,4)) AS am_pm_ratio
FROM (
  SELECT COUNT(*) AS amc
  FROM web_sales
  JOIN household_demographics ON ws_ship_hdemo_sk = hd_demo_sk
  JOIN time_dim ON ws_sold_time_sk = t_time_sk
  JOIN web_page ON ws_web_page_sk = wp_web_page_sk
  WHERE t_hour BETWEEN 6 AND 7
    AND hd_dep_count = 0
    AND wp_char_count BETWEEN 5000 AND 5200
) am,
(
  SELECT COUNT(*) AS pmc
  FROM web_sales
  JOIN household_demographics ON ws_ship_hdemo_sk = hd_demo_sk
  JOIN time_dim ON ws_sold_time_sk = t_time_sk
  JOIN web_page ON ws_web_page_sk = wp_web_page_sk
  WHERE t_hour BETWEEN 18 AND 19
    AND hd_dep_count = 0
    AND wp_char_count BETWEEN 5000 AND 5200
) pm
ORDER BY am_pm_ratio;
```

## Expected Output
```json
[
  { "am_pm_ratio": 1.0 }
]
```
