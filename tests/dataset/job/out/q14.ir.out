func main (regs=173)
  // let info_type = [
  Const        r0, [{"id": 1, "info": "countries"}, {"id": 2, "info": "rating"}]
  // let keyword = [
  Const        r1, [{"id": 1, "keyword": "murder"}, {"id": 2, "keyword": "blood"}, {"id": 3, "keyword": "romance"}]
  // let kind_type = [
  Const        r2, [{"id": 1, "kind": "movie"}]
  // let title = [
  Const        r3, [{"id": 1, "kind_id": 1, "production_year": 2012, "title": "A Dark Movie"}, {"id": 2, "kind_id": 1, "production_year": 2013, "title": "Brutal Blood"}, {"id": 3, "kind_id": 1, "production_year": 2008, "title": "Old Film"}]
  // let movie_info = [
  Const        r4, [{"info": "Sweden", "info_type_id": 1, "movie_id": 1}, {"info": "USA", "info_type_id": 1, "movie_id": 2}, {"info": "USA", "info_type_id": 1, "movie_id": 3}]
  // let movie_info_idx = [
  Const        r5, [{"info": 7, "info_type_id": 2, "movie_id": 1}, {"info": 7.5, "info_type_id": 2, "movie_id": 2}, {"info": 9.1, "info_type_id": 2, "movie_id": 3}]
  // let movie_keyword = [
  Const        r6, [{"keyword_id": 1, "movie_id": 1}, {"keyword_id": 2, "movie_id": 2}, {"keyword_id": 3, "movie_id": 3}]
  // let allowed_keywords = ["murder", "murder-in-title", "blood", "violence"]
  Const        r7, ["murder", "murder-in-title", "blood", "violence"]
  // let allowed_countries = [
  Const        r8, ["Sweden", "Norway", "Germany", "Denmark", "Swedish", "Denish", "Norwegian", "German", "USA", "American"]
  // from it1 in info_type
  Const        r9, []
  // it1.info == "countries" &&
  Const        r10, "info"
  // (k.keyword in allowed_keywords) &&
  Const        r11, "keyword"
  // kt.kind == "movie" &&
  Const        r12, "kind"
  // t.production_year > 2010 &&
  Const        r13, "production_year"
  // kt.id == t.kind_id &&
  Const        r14, "id"
  Const        r15, "kind_id"
  // t.id == mi.movie_id &&
  Const        r16, "movie_id"
  // k.id == mk.keyword_id &&
  Const        r17, "keyword_id"
  // it1.id == mi.info_type_id &&
  Const        r18, "info_type_id"
  // rating: mi_idx.info,
  Const        r19, "rating"
  // title: t.title
  Const        r20, "title"
  // from it1 in info_type
  IterPrep     r21, r0
  Len          r22, r21
  Const        r24, 0
  Move         r23, r24
L32:
  LessInt      r25, r23, r22
  JumpIfFalse  r25, L0
  Index        r27, r21, r23
  // from it2 in info_type
  IterPrep     r28, r0
  Len          r29, r28
  Move         r30, r24
L31:
  LessInt      r31, r30, r29
  JumpIfFalse  r31, L1
  Index        r33, r28, r30
  // from k in keyword
  IterPrep     r34, r1
  Len          r35, r34
  Move         r36, r24
L30:
  LessInt      r37, r36, r35
  JumpIfFalse  r37, L2
  Index        r39, r34, r36
  // from kt in kind_type
  IterPrep     r40, r2
  Len          r41, r40
  Move         r42, r24
L29:
  LessInt      r43, r42, r41
  JumpIfFalse  r43, L3
  Index        r45, r40, r42
  // from mi in movie_info
  IterPrep     r46, r4
  Len          r47, r46
  Move         r48, r24
L28:
  LessInt      r49, r48, r47
  JumpIfFalse  r49, L4
  Index        r51, r46, r48
  // from mi_idx in movie_info_idx
  IterPrep     r52, r5
  Len          r53, r52
  Move         r54, r24
L27:
  LessInt      r55, r54, r53
  JumpIfFalse  r55, L5
  Index        r57, r52, r54
  // from mk in movie_keyword
  IterPrep     r58, r6
  Len          r59, r58
  Move         r60, r24
L26:
  LessInt      r61, r60, r59
  JumpIfFalse  r61, L6
  Index        r63, r58, r60
  // from t in title
  IterPrep     r64, r3
  Len          r65, r64
  Move         r66, r24
L25:
  LessInt      r67, r66, r65
  JumpIfFalse  r67, L7
  Index        r69, r64, r66
  // it1.info == "countries" &&
  Index        r70, r27, r10
  // mi_idx.info < 8.5 &&
  Index        r71, r57, r10
  Const        r72, 8.5
  LessFloat    r73, r71, r72
  // t.production_year > 2010 &&
  Index        r74, r69, r13
  Const        r75, 2010
  Less         r76, r75, r74
  // it1.info == "countries" &&
  Const        r77, "countries"
  Equal        r78, r70, r77
  // it2.info == "rating" &&
  Index        r79, r33, r10
  Equal        r80, r79, r19
  // kt.kind == "movie" &&
  Index        r81, r45, r12
  Const        r82, "movie"
  Equal        r83, r81, r82
  // kt.id == t.kind_id &&
  Index        r84, r45, r14
  Index        r85, r69, r15
  Equal        r86, r84, r85
  // t.id == mi.movie_id &&
  Index        r87, r69, r14
  Index        r88, r51, r16
  Equal        r89, r87, r88
  // t.id == mk.movie_id &&
  Index        r90, r69, r14
  Index        r91, r63, r16
  Equal        r92, r90, r91
  // t.id == mi_idx.movie_id &&
  Index        r93, r69, r14
  Index        r94, r57, r16
  Equal        r95, r93, r94
  // mk.movie_id == mi.movie_id &&
  Index        r96, r63, r16
  Index        r97, r51, r16
  Equal        r98, r96, r97
  // mk.movie_id == mi_idx.movie_id &&
  Index        r99, r63, r16
  Index        r100, r57, r16
  Equal        r101, r99, r100
  // mi.movie_id == mi_idx.movie_id &&
  Index        r102, r51, r16
  Index        r103, r57, r16
  Equal        r104, r102, r103
  // k.id == mk.keyword_id &&
  Index        r105, r39, r14
  Index        r106, r63, r17
  Equal        r107, r105, r106
  // it1.id == mi.info_type_id &&
  Index        r108, r27, r14
  Index        r109, r51, r18
  Equal        r110, r108, r109
  // it2.id == mi_idx.info_type_id
  Index        r111, r33, r14
  Index        r112, r57, r18
  Equal        r113, r111, r112
  // it1.info == "countries" &&
  Move         r114, r78
  JumpIfFalse  r114, L8
L8:
  // it2.info == "rating" &&
  Move         r115, r80
  JumpIfFalse  r115, L9
  // (k.keyword in allowed_keywords) &&
  Index        r116, r39, r11
  In           r118, r116, r7
L9:
  JumpIfFalse  r118, L10
L10:
  // kt.kind == "movie" &&
  Move         r119, r83
  JumpIfFalse  r119, L11
  // (mi.info in allowed_countries) &&
  Index        r120, r51, r10
  In           r122, r120, r8
L11:
  JumpIfFalse  r122, L12
L12:
  // mi_idx.info < 8.5 &&
  Move         r123, r73
  JumpIfFalse  r123, L13
L13:
  // t.production_year > 2010 &&
  Move         r124, r76
  JumpIfFalse  r124, L14
L14:
  // kt.id == t.kind_id &&
  Move         r125, r86
  JumpIfFalse  r125, L15
L15:
  // t.id == mi.movie_id &&
  Move         r126, r89
  JumpIfFalse  r126, L16
L16:
  // t.id == mk.movie_id &&
  Move         r127, r92
  JumpIfFalse  r127, L17
L17:
  // t.id == mi_idx.movie_id &&
  Move         r128, r95
  JumpIfFalse  r128, L18
L18:
  // mk.movie_id == mi.movie_id &&
  Move         r129, r98
  JumpIfFalse  r129, L19
L19:
  // mk.movie_id == mi_idx.movie_id &&
  Move         r130, r101
  JumpIfFalse  r130, L20
L20:
  // mi.movie_id == mi_idx.movie_id &&
  Move         r131, r104
  JumpIfFalse  r131, L21
L21:
  // k.id == mk.keyword_id &&
  Move         r132, r107
  JumpIfFalse  r132, L22
L22:
  // it1.id == mi.info_type_id &&
  Move         r133, r110
  JumpIfFalse  r133, L23
  Move         r133, r113
L23:
  // where (
  JumpIfFalse  r133, L24
  // rating: mi_idx.info,
  Const        r134, "rating"
  Index        r135, r57, r10
  // title: t.title
  Const        r136, "title"
  Index        r137, r69, r20
  // rating: mi_idx.info,
  Move         r138, r134
  Move         r139, r135
  // title: t.title
  Move         r140, r136
  Move         r141, r137
  // select {
  MakeMap      r142, 2, r138
  // from it1 in info_type
  Append       r9, r9, r142
L24:
  // from t in title
  Const        r144, 1
  AddInt       r66, r66, r144
  Jump         L25
L7:
  // from mk in movie_keyword
  AddInt       r60, r60, r144
  Jump         L26
L6:
  // from mi_idx in movie_info_idx
  AddInt       r54, r54, r144
  Jump         L27
L5:
  // from mi in movie_info
  AddInt       r48, r48, r144
  Jump         L28
L4:
  // from kt in kind_type
  AddInt       r42, r42, r144
  Jump         L29
L3:
  // from k in keyword
  AddInt       r36, r36, r144
  Jump         L30
L2:
  // from it2 in info_type
  AddInt       r30, r30, r144
  Jump         L31
L1:
  // from it1 in info_type
  AddInt       r23, r23, r144
  Jump         L32
L0:
  // rating: min(from x in matches select x.rating),
  Const        r145, "rating"
  Const        r146, []
  IterPrep     r147, r9
  Len          r148, r147
  Move         r149, r24
L34:
  LessInt      r150, r149, r148
  JumpIfFalse  r150, L33
  Index        r152, r147, r149
  Index        r153, r152, r19
  Append       r146, r146, r153
  AddInt       r149, r149, r144
  Jump         L34
L33:
  Min          r155, r146
  // northern_dark_movie: min(from x in matches select x.title)
  Const        r156, "northern_dark_movie"
  Const        r157, []
  IterPrep     r158, r9
  Len          r159, r158
  Move         r160, r24
L36:
  LessInt      r161, r160, r159
  JumpIfFalse  r161, L35
  Index        r152, r158, r160
  Index        r163, r152, r20
  Append       r157, r157, r163
  AddInt       r160, r160, r144
  Jump         L36
L35:
  Min          r165, r157
  // rating: min(from x in matches select x.rating),
  Move         r166, r145
  Move         r167, r155
  // northern_dark_movie: min(from x in matches select x.title)
  Move         r168, r156
  Move         r169, r165
  // let result = {
  MakeMap      r170, 2, r166
  // json(result)
  JSON         r170
  // expect result == { rating: 7.0, northern_dark_movie: "A Dark Movie" }
  Const        r171, {"northern_dark_movie": "A Dark Movie", "rating": 7}
  Equal        r172, r170, r171
  Expect       r172
  Return       r0
