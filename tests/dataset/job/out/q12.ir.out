func main (regs=304)
  // let company_name = [
  Const        r0, [{"country_code": "[us]", "id": 1, "name": "Best Pictures"}, {"country_code": "[uk]", "id": 2, "name": "Foreign Films"}]
  // let company_type = [
  Const        r1, [{"id": 10, "kind": "production companies"}, {"id": 20, "kind": "distributors"}]
  // let info_type = [
  Const        r2, [{"id": 100, "info": "genres"}, {"id": 200, "info": "rating"}]
  // let movie_companies = [
  Const        r3, [{"company_id": 1, "company_type_id": 10, "movie_id": 1000}, {"company_id": 2, "company_type_id": 10, "movie_id": 2000}]
  // let movie_info = [
  Const        r4, [{"info": "Drama", "info_type_id": 100, "movie_id": 1000}, {"info": "Horror", "info_type_id": 100, "movie_id": 2000}]
  // let movie_info_idx = [
  Const        r5, [{"info": 8.3, "info_type_id": 200, "movie_id": 1000}, {"info": 7.5, "info_type_id": 200, "movie_id": 2000}]
  // let title = [
  Const        r6, [{"id": 1000, "production_year": 2006, "title": "Great Drama"}, {"id": 2000, "production_year": 2007, "title": "Low Rated"}]
  // from cn in company_name
  Const        r7, []
  // cn.country_code == "[us]" &&
  Const        r8, "country_code"
  // ct.kind == "production companies" &&
  Const        r9, "kind"
  // it1.info == "genres" &&
  Const        r10, "info"
  // it2.info == "rating" &&
  Const        r11, "info"
  // (mi.info == "Drama" || mi.info == "Horror") &&
  Const        r12, "info"
  Const        r13, "info"
  // mi_idx.info > 8.0 &&
  Const        r14, "info"
  // t.production_year >= 2005 &&
  Const        r15, "production_year"
  // t.production_year <= 2008
  Const        r16, "production_year"
  // movie_company: cn.name,
  Const        r17, "movie_company"
  Const        r18, "name"
  // rating: mi_idx.info,
  Const        r19, "rating"
  Const        r20, "info"
  // drama_horror_movie: t.title
  Const        r21, "drama_horror_movie"
  Const        r22, "title"
  // from cn in company_name
  IterPrep     r23, r0
  Len          r24, r23
  Const        r25, 0
L23:
  LessInt      r27, r25, r24
  JumpIfFalse  r27, L0
  Index        r29, r23, r25
  // join mc in movie_companies on mc.company_id == cn.id
  IterPrep     r30, r3
  Len          r31, r30
  Const        r32, "company_id"
  Const        r33, "id"
  // cn.country_code == "[us]" &&
  Const        r34, "country_code"
  // ct.kind == "production companies" &&
  Const        r35, "kind"
  // it1.info == "genres" &&
  Const        r36, "info"
  // it2.info == "rating" &&
  Const        r37, "info"
  // (mi.info == "Drama" || mi.info == "Horror") &&
  Const        r38, "info"
  Const        r39, "info"
  // mi_idx.info > 8.0 &&
  Const        r40, "info"
  // t.production_year >= 2005 &&
  Const        r41, "production_year"
  // t.production_year <= 2008
  Const        r42, "production_year"
  // movie_company: cn.name,
  Const        r43, "movie_company"
  Const        r44, "name"
  // rating: mi_idx.info,
  Const        r45, "rating"
  Const        r46, "info"
  // drama_horror_movie: t.title
  Const        r47, "drama_horror_movie"
  Const        r48, "title"
  // join mc in movie_companies on mc.company_id == cn.id
  Const        r49, 0
L22:
  LessInt      r51, r49, r31
  JumpIfFalse  r51, L1
  Index        r53, r30, r49
  Const        r54, "company_id"
  Index        r55, r53, r54
  Const        r56, "id"
  Index        r57, r29, r56
  Equal        r58, r55, r57
  JumpIfFalse  r58, L2
  // join ct in company_type on ct.id == mc.company_type_id
  IterPrep     r59, r1
  Len          r60, r59
  Const        r61, "id"
  Const        r62, "company_type_id"
  // cn.country_code == "[us]" &&
  Const        r63, "country_code"
  // ct.kind == "production companies" &&
  Const        r64, "kind"
  // it1.info == "genres" &&
  Const        r65, "info"
  // it2.info == "rating" &&
  Const        r66, "info"
  // (mi.info == "Drama" || mi.info == "Horror") &&
  Const        r67, "info"
  Const        r68, "info"
  // mi_idx.info > 8.0 &&
  Const        r69, "info"
  // t.production_year >= 2005 &&
  Const        r70, "production_year"
  // t.production_year <= 2008
  Const        r71, "production_year"
  // movie_company: cn.name,
  Const        r72, "movie_company"
  Const        r73, "name"
  // rating: mi_idx.info,
  Const        r74, "rating"
  Const        r75, "info"
  // drama_horror_movie: t.title
  Const        r76, "drama_horror_movie"
  Const        r77, "title"
  // join ct in company_type on ct.id == mc.company_type_id
  Const        r78, 0
L21:
  LessInt      r80, r78, r60
  JumpIfFalse  r80, L2
  Index        r82, r59, r78
  Const        r83, "id"
  Index        r84, r82, r83
  Const        r85, "company_type_id"
  Index        r86, r53, r85
  Equal        r87, r84, r86
  JumpIfFalse  r87, L3
  // join t in title on t.id == mc.movie_id
  IterPrep     r88, r6
  Len          r89, r88
  Const        r90, "id"
  Const        r91, "movie_id"
  // cn.country_code == "[us]" &&
  Const        r92, "country_code"
  // ct.kind == "production companies" &&
  Const        r93, "kind"
  // it1.info == "genres" &&
  Const        r94, "info"
  // it2.info == "rating" &&
  Const        r95, "info"
  // (mi.info == "Drama" || mi.info == "Horror") &&
  Const        r96, "info"
  Const        r97, "info"
  // mi_idx.info > 8.0 &&
  Const        r98, "info"
  // t.production_year >= 2005 &&
  Const        r99, "production_year"
  // t.production_year <= 2008
  Const        r100, "production_year"
  // movie_company: cn.name,
  Const        r101, "movie_company"
  Const        r102, "name"
  // rating: mi_idx.info,
  Const        r103, "rating"
  Const        r104, "info"
  // drama_horror_movie: t.title
  Const        r105, "drama_horror_movie"
  Const        r106, "title"
  // join t in title on t.id == mc.movie_id
  Const        r107, 0
L20:
  LessInt      r109, r107, r89
  JumpIfFalse  r109, L3
  Index        r111, r88, r107
  Const        r112, "id"
  Index        r113, r111, r112
  Const        r114, "movie_id"
  Index        r115, r53, r114
  Equal        r116, r113, r115
  JumpIfFalse  r116, L4
  // join mi in movie_info on mi.movie_id == t.id
  IterPrep     r117, r4
  Len          r118, r117
  Const        r119, "movie_id"
  Const        r120, "id"
  // cn.country_code == "[us]" &&
  Const        r121, "country_code"
  // ct.kind == "production companies" &&
  Const        r122, "kind"
  // it1.info == "genres" &&
  Const        r123, "info"
  // it2.info == "rating" &&
  Const        r124, "info"
  // (mi.info == "Drama" || mi.info == "Horror") &&
  Const        r125, "info"
  Const        r126, "info"
  // mi_idx.info > 8.0 &&
  Const        r127, "info"
  // t.production_year >= 2005 &&
  Const        r128, "production_year"
  // t.production_year <= 2008
  Const        r129, "production_year"
  // movie_company: cn.name,
  Const        r130, "movie_company"
  Const        r131, "name"
  // rating: mi_idx.info,
  Const        r132, "rating"
  Const        r133, "info"
  // drama_horror_movie: t.title
  Const        r134, "drama_horror_movie"
  Const        r135, "title"
  // join mi in movie_info on mi.movie_id == t.id
  Const        r136, 0
L19:
  LessInt      r138, r136, r118
  JumpIfFalse  r138, L4
  Index        r140, r117, r136
  Const        r141, "movie_id"
  Index        r142, r140, r141
  Const        r143, "id"
  Index        r144, r111, r143
  Equal        r145, r142, r144
  JumpIfFalse  r145, L5
  // join it1 in info_type on it1.id == mi.info_type_id
  IterPrep     r146, r2
  Len          r147, r146
  Const        r148, "id"
  Const        r149, "info_type_id"
  // cn.country_code == "[us]" &&
  Const        r150, "country_code"
  // ct.kind == "production companies" &&
  Const        r151, "kind"
  // it1.info == "genres" &&
  Const        r152, "info"
  // it2.info == "rating" &&
  Const        r153, "info"
  // (mi.info == "Drama" || mi.info == "Horror") &&
  Const        r154, "info"
  Const        r155, "info"
  // mi_idx.info > 8.0 &&
  Const        r156, "info"
  // t.production_year >= 2005 &&
  Const        r157, "production_year"
  // t.production_year <= 2008
  Const        r158, "production_year"
  // movie_company: cn.name,
  Const        r159, "movie_company"
  Const        r160, "name"
  // rating: mi_idx.info,
  Const        r161, "rating"
  Const        r162, "info"
  // drama_horror_movie: t.title
  Const        r163, "drama_horror_movie"
  Const        r164, "title"
  // join it1 in info_type on it1.id == mi.info_type_id
  Const        r165, 0
L18:
  LessInt      r167, r165, r147
  JumpIfFalse  r167, L5
  Index        r169, r146, r165
  Const        r170, "id"
  Index        r171, r169, r170
  Const        r172, "info_type_id"
  Index        r173, r140, r172
  Equal        r174, r171, r173
  JumpIfFalse  r174, L6
  // join mi_idx in movie_info_idx on mi_idx.movie_id == t.id
  IterPrep     r175, r5
  Len          r176, r175
  Const        r177, "movie_id"
  Const        r178, "id"
  // cn.country_code == "[us]" &&
  Const        r179, "country_code"
  // ct.kind == "production companies" &&
  Const        r180, "kind"
  // it1.info == "genres" &&
  Const        r181, "info"
  // it2.info == "rating" &&
  Const        r182, "info"
  // (mi.info == "Drama" || mi.info == "Horror") &&
  Const        r183, "info"
  Const        r184, "info"
  // mi_idx.info > 8.0 &&
  Const        r185, "info"
  // t.production_year >= 2005 &&
  Const        r186, "production_year"
  // t.production_year <= 2008
  Const        r187, "production_year"
  // movie_company: cn.name,
  Const        r188, "movie_company"
  Const        r189, "name"
  // rating: mi_idx.info,
  Const        r190, "rating"
  Const        r191, "info"
  // drama_horror_movie: t.title
  Const        r192, "drama_horror_movie"
  Const        r193, "title"
  // join mi_idx in movie_info_idx on mi_idx.movie_id == t.id
  Const        r194, 0
L17:
  LessInt      r196, r194, r176
  JumpIfFalse  r196, L6
  Index        r198, r175, r194
  Const        r199, "movie_id"
  Index        r200, r198, r199
  Const        r201, "id"
  Index        r202, r111, r201
  Equal        r203, r200, r202
  JumpIfFalse  r203, L7
  // join it2 in info_type on it2.id == mi_idx.info_type_id
  IterPrep     r204, r2
  Len          r205, r204
  Const        r206, "id"
  Const        r207, "info_type_id"
  // cn.country_code == "[us]" &&
  Const        r208, "country_code"
  // ct.kind == "production companies" &&
  Const        r209, "kind"
  // it1.info == "genres" &&
  Const        r210, "info"
  // it2.info == "rating" &&
  Const        r211, "info"
  // (mi.info == "Drama" || mi.info == "Horror") &&
  Const        r212, "info"
  Const        r213, "info"
  // mi_idx.info > 8.0 &&
  Const        r214, "info"
  // t.production_year >= 2005 &&
  Const        r215, "production_year"
  // t.production_year <= 2008
  Const        r216, "production_year"
  // movie_company: cn.name,
  Const        r217, "movie_company"
  Const        r218, "name"
  // rating: mi_idx.info,
  Const        r219, "rating"
  Const        r220, "info"
  // drama_horror_movie: t.title
  Const        r221, "drama_horror_movie"
  Const        r222, "title"
  // join it2 in info_type on it2.id == mi_idx.info_type_id
  Const        r223, 0
L16:
  LessInt      r225, r223, r205
  JumpIfFalse  r225, L7
  Index        r227, r204, r223
  Const        r228, "id"
  Index        r229, r227, r228
  Const        r230, "info_type_id"
  Index        r231, r198, r230
  Equal        r232, r229, r231
  JumpIfFalse  r232, L8
  // cn.country_code == "[us]" &&
  Const        r233, "country_code"
  Index        r234, r29, r233
  // mi_idx.info > 8.0 &&
  Const        r235, "info"
  Index        r236, r198, r235
  Const        r237, 8
  LessFloat    r238, r237, r236
  // t.production_year >= 2005 &&
  Const        r239, "production_year"
  Index        r240, r111, r239
  Const        r241, 2005
  LessEq       r242, r241, r240
  // t.production_year <= 2008
  Const        r243, "production_year"
  Index        r244, r111, r243
  Const        r245, 2008
  LessEq       r246, r244, r245
  // cn.country_code == "[us]" &&
  Const        r247, "[us]"
  Equal        r248, r234, r247
  // ct.kind == "production companies" &&
  Const        r249, "kind"
  Index        r250, r82, r249
  Const        r251, "production companies"
  Equal        r252, r250, r251
  // it1.info == "genres" &&
  Const        r253, "info"
  Index        r254, r169, r253
  Const        r255, "genres"
  Equal        r256, r254, r255
  // it2.info == "rating" &&
  Const        r257, "info"
  Index        r258, r227, r257
  Const        r259, "rating"
  Equal        r260, r258, r259
  // cn.country_code == "[us]" &&
  Move         r261, r248
  JumpIfFalse  r261, L9
L9:
  // ct.kind == "production companies" &&
  Move         r262, r252
  JumpIfFalse  r262, L10
L10:
  // it1.info == "genres" &&
  Move         r263, r256
  JumpIfFalse  r263, L11
L11:
  // it2.info == "rating" &&
  Move         r264, r260
  JumpIfFalse  r264, L12
  // (mi.info == "Drama" || mi.info == "Horror") &&
  Const        r265, "info"
  Index        r266, r140, r265
  Const        r267, "Drama"
  Equal        r268, r266, r267
  Const        r269, "info"
  Index        r270, r140, r269
  Const        r271, "Horror"
  Equal        r272, r270, r271
  Move         r273, r268
  JumpIfTrue   r273, L12
L12:
  Move         r274, r272
  JumpIfFalse  r274, L13
L13:
  // mi_idx.info > 8.0 &&
  Move         r275, r238
  JumpIfFalse  r275, L14
L14:
  // t.production_year >= 2005 &&
  Move         r276, r242
  JumpIfFalse  r276, L15
  Move         r276, r246
L15:
  // cn.country_code == "[us]" &&
  JumpIfFalse  r276, L8
  // movie_company: cn.name,
  Const        r277, "movie_company"
  Const        r278, "name"
  Index        r279, r29, r278
  // rating: mi_idx.info,
  Const        r280, "rating"
  Const        r281, "info"
  Index        r282, r198, r281
  // drama_horror_movie: t.title
  Const        r283, "drama_horror_movie"
  Const        r284, "title"
  Index        r285, r111, r284
  // movie_company: cn.name,
  Move         r286, r277
  Move         r287, r279
  // rating: mi_idx.info,
  Move         r288, r280
  Move         r289, r282
  // drama_horror_movie: t.title
  Move         r290, r283
  Move         r291, r285
  // select {
  MakeMap      r292, 3, r286
  // from cn in company_name
  Append       r7, r7, r292
L8:
  // join it2 in info_type on it2.id == mi_idx.info_type_id
  Const        r294, 1
  Add          r223, r223, r294
  Jump         L16
L7:
  // join mi_idx in movie_info_idx on mi_idx.movie_id == t.id
  Const        r295, 1
  Add          r194, r194, r295
  Jump         L17
L6:
  // join it1 in info_type on it1.id == mi.info_type_id
  Const        r296, 1
  Add          r165, r165, r296
  Jump         L18
L5:
  // join mi in movie_info on mi.movie_id == t.id
  Const        r297, 1
  Add          r136, r136, r297
  Jump         L19
L4:
  // join t in title on t.id == mc.movie_id
  Const        r298, 1
  Add          r107, r107, r298
  Jump         L20
L3:
  // join ct in company_type on ct.id == mc.company_type_id
  Const        r299, 1
  Add          r78, r78, r299
  Jump         L21
L2:
  // join mc in movie_companies on mc.company_id == cn.id
  Const        r300, 1
  Add          r49, r49, r300
  Jump         L22
L1:
  // from cn in company_name
  Const        r301, 1
  AddInt       r25, r25, r301
  Jump         L23
L0:
  // json(result)
  JSON         r7
  // expect result == [
  Const        r302, [{"drama_horror_movie": "Great Drama", "movie_company": "Best Pictures", "rating": 8.3}]
  Equal        r303, r7, r302
  Expect       r303
  Return       r0
