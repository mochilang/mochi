func main (regs=90)
  // let company_type = [
  Const        r0, [{"ct_id": 1, "kind": "production companies"}, {"ct_id": 2, "kind": "other"}]
  // let info_type = [
  Const        r1, [{"info": "languages", "it_id": 10}]
  // let title = [
  Const        r2, [{"production_year": 2010, "t_id": 100, "title": "B Movie"}, {"production_year": 2012, "t_id": 200, "title": "A Film"}, {"production_year": 2000, "t_id": 300, "title": "Old Movie"}]
  // let movie_companies = [
  Const        r3, [{"company_type_id": 1, "movie_id": 100, "note": "ACME (France) (theatrical)"}, {"company_type_id": 1, "movie_id": 200, "note": "ACME (France) (theatrical)"}, {"company_type_id": 1, "movie_id": 300, "note": "ACME (France) (theatrical)"}]
  // let movie_info = [
  Const        r4, [{"info": "German", "info_type_id": 10, "movie_id": 100}, {"info": "Swedish", "info_type_id": 10, "movie_id": 200}, {"info": "German", "info_type_id": 10, "movie_id": 300}]
  // from ct in company_type
  Const        r5, []
  // where ct.kind == "production companies" &&
  Const        r6, "kind"
  // "(theatrical)" in mc.note &&
  Const        r7, "note"
  // t.production_year > 2005 &&
  Const        r8, "production_year"
  // (mi.info in [
  Const        r9, "info"
  // select t.title
  Const        r10, "title"
  // from ct in company_type
  IterPrep     r11, r0
  Len          r12, r11
  Const        r14, 0
  Move         r13, r14
L14:
  LessInt      r15, r13, r12
  JumpIfFalse  r15, L0
  Index        r17, r11, r13
  // join mc in movie_companies on mc.company_type_id == ct.ct_id
  IterPrep     r18, r3
  Len          r19, r18
  Const        r20, "company_type_id"
  Const        r21, "ct_id"
  Move         r22, r14
L13:
  LessInt      r23, r22, r19
  JumpIfFalse  r23, L1
  Index        r25, r18, r22
  Index        r26, r25, r20
  Index        r27, r17, r21
  Equal        r28, r26, r27
  JumpIfFalse  r28, L2
  // join mi in movie_info on mi.movie_id == mc.movie_id
  IterPrep     r29, r4
  Len          r30, r29
  Const        r31, "movie_id"
  Move         r32, r14
L12:
  LessInt      r33, r32, r30
  JumpIfFalse  r33, L2
  Index        r35, r29, r32
  Index        r36, r35, r31
  Index        r37, r25, r31
  Equal        r38, r36, r37
  JumpIfFalse  r38, L3
  // join it in info_type on it.it_id == mi.info_type_id
  IterPrep     r39, r1
  Len          r40, r39
  Const        r41, "it_id"
  Const        r42, "info_type_id"
  Move         r43, r14
L11:
  LessInt      r44, r43, r40
  JumpIfFalse  r44, L3
  Index        r46, r39, r43
  Index        r47, r46, r41
  Index        r48, r35, r42
  Equal        r49, r47, r48
  JumpIfFalse  r49, L4
  // join t in title on t.t_id == mc.movie_id
  IterPrep     r50, r2
  Len          r51, r50
  Const        r52, "t_id"
  Move         r53, r14
L10:
  LessInt      r54, r53, r51
  JumpIfFalse  r54, L4
  Index        r56, r50, r53
  Index        r57, r56, r52
  Index        r58, r25, r31
  Equal        r59, r57, r58
  JumpIfFalse  r59, L5
  // where ct.kind == "production companies" &&
  Index        r60, r17, r6
  // t.production_year > 2005 &&
  Index        r61, r56, r8
  Const        r62, 2005
  Less         r63, r62, r61
  // where ct.kind == "production companies" &&
  Const        r64, "production companies"
  Equal        r65, r60, r64
  // "(theatrical)" in mc.note &&
  Const        r66, "(theatrical)"
  Index        r67, r25, r7
  In           r68, r66, r67
  // "(France)" in mc.note &&
  Const        r69, "(France)"
  Index        r70, r25, r7
  In           r71, r69, r70
  // where ct.kind == "production companies" &&
  Move         r72, r65
  JumpIfFalse  r72, L6
L6:
  // "(theatrical)" in mc.note &&
  Move         r73, r68
  JumpIfFalse  r73, L7
L7:
  // "(France)" in mc.note &&
  Move         r74, r71
  JumpIfFalse  r74, L8
L8:
  // t.production_year > 2005 &&
  Move         r75, r63
  JumpIfFalse  r75, L9
  // (mi.info in [
  Index        r76, r35, r9
  Const        r77, ["Sweden", "Norway", "Germany", "Denmark", "Swedish", "Denish", "Norwegian", "German"]
  In           r75, r76, r77
L9:
  // where ct.kind == "production companies" &&
  JumpIfFalse  r75, L5
  // select t.title
  Index        r79, r56, r10
  // from ct in company_type
  Append       r5, r5, r79
L5:
  // join t in title on t.t_id == mc.movie_id
  Const        r81, 1
  Add          r53, r53, r81
  Jump         L10
L4:
  // join it in info_type on it.it_id == mi.info_type_id
  Add          r43, r43, r81
  Jump         L11
L3:
  // join mi in movie_info on mi.movie_id == mc.movie_id
  Add          r32, r32, r81
  Jump         L12
L2:
  // join mc in movie_companies on mc.company_type_id == ct.ct_id
  Add          r22, r22, r81
  Jump         L13
L1:
  // from ct in company_type
  AddInt       r13, r13, r81
  Jump         L14
L0:
  // let result = [ { typical_european_movie: min(candidate_titles) } ]
  Const        r82, "typical_european_movie"
  Min          r83, r5
  MakeMap      r86, 1, r82
  MakeList     r87, 1, r86
  // json(result)
  JSON         r87
  // expect result == [ { typical_european_movie: "A Film" } ]
  Const        r88, [{"typical_european_movie": "A Film"}]
  Equal        r89, r87, r88
  Expect       r89
  Return       r0
