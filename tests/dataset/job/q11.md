# JOB Query 11 – Non‑Polish Sequel Producers

The program [q11.mochi](./q11.mochi) looks for sequels produced between 1950 and 2000. Companies must have a name containing "Film" or "Warner" and must not be from Poland. Only production companies are considered, the link type must include the word "follow", and the movie must have the keyword "sequel". The `MIN` aggregation over the qualifying rows returns one company name, link type, and title.

## SQL
```sql
SELECT MIN(cn.name) AS from_company,
       MIN(lt.link) AS movie_link_type,
       MIN(t.title) AS non_polish_sequel_movie
FROM company_name AS cn,
     company_type AS ct,
     keyword AS k,
     link_type AS lt,
     movie_companies AS mc,
     movie_keyword AS mk,
     movie_link AS ml,
     title AS t
WHERE cn.country_code != '[pl]'
  AND (cn.name LIKE '%Film%'
       OR cn.name LIKE '%Warner%')
  AND ct.kind = 'production companies'
  AND k.keyword = 'sequel'
  AND lt.link LIKE '%follow%'
  AND mc.note IS NULL
  AND t.production_year BETWEEN 1950 AND 2000
  AND lt.id = ml.link_type_id
  AND ml.movie_id = t.id
  AND t.id = mk.movie_id
  AND mk.keyword_id = k.id
  AND t.id = mc.movie_id
  AND mc.company_type_id = ct.id
  AND mc.company_id = cn.id
  AND ml.movie_id = mk.movie_id
  AND ml.movie_id = mc.movie_id
  AND mk.movie_id = mc.movie_id;
```

## Expected Output
One movie satisfies all conditions, so its data forms the aggregated result.
```json
[
  {
    "from_company": "Big Film Studios",
    "movie_link_type": "follows",
    "non_polish_sequel_movie": "Space Adventure II"
  }
]
```
