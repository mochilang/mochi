" Generated by Mochi compiler v0.10.25 on 2025-07-13T14:24:44Z
"
| aka_name char_name cast_info company_name movie_companies name role_type title matches result |
aka_name := {Dictionary from:{'person_id'->1. 'name'->'A. N. G.'}. Dictionary from:{'person_id'->2. 'name'->'J. D.'}}.
char_name := {Dictionary from:{'id'->10. 'name'->'Angel'}. Dictionary from:{'id'->20. 'name'->'Devil'}}.
cast_info := {Dictionary from:{'person_id'->1. 'person_role_id'->10. 'movie_id'->100. 'role_id'->1000. 'note'->'(voice)'}. Dictionary from:{'person_id'->2. 'person_role_id'->20. 'movie_id'->200. 'role_id'->1000. 'note'->'(voice)'}}.
company_name := {Dictionary from:{'id'->100. 'country_code'->'[us]'}. Dictionary from:{'id'->200. 'country_code'->'[gb]'}}.
movie_companies := {Dictionary from:{'movie_id'->100. 'company_id'->100. 'note'->'ACME Studios (USA)'}. Dictionary from:{'movie_id'->200. 'company_id'->200. 'note'->'Maple Films'}}.
name := {Dictionary from:{'id'->1. name->'Angela Smith'. 'gender'->'f'}. Dictionary from:{'id'->2. name->'John Doe'. 'gender'->'m'}}.
role_type := {Dictionary from:{'id'->1000. 'role'->'actress'}. Dictionary from:{'id'->2000. 'role'->'actor'}}.
title := {Dictionary from:{'id'->100. title->'Famous Film'. 'production_year'->2010}. Dictionary from:{'id'->200. title->'Old Movie'. 'production_year'->1999}}.
matches := [ | tmp |
  tmp := OrderedCollection new.
  aka_name do: [:an |
    name do: [:n |
      cast_info do: [:ci |
        char_name do: [:chn |
          title do: [:t |
            movie_companies do: [:mc |
              company_name do: [:cn |
                role_type do: [:rt |
                  ((((((((((((((((((((((((ci at: 'note') in ({'(voice)'. '(voice: Japanese version)'. '(voice) (uncredited)'. '(voice: English version)'}))) and: [(((cn at: 'country_code') = '[us]'))])) and: [((((mc at: 'note' at: 'contains') value: '(USA)') or: [((mc at: 'note' at: 'contains') value: '(worldwide)')]))])) and: [(((n at: 'gender') = 'f'))])) and: [((n at: 'name' at: 'contains') value: 'Ang')])) and: [(((rt at: 'role') = 'actress'))])) and: [(((t at: 'production_year') >= 2005))])) and: [(((t at: 'production_year') <= 2015))]) and: [(an.person_id = n.id)]) and: [(ci.person_id = n.id)]) and: [(chn.id = ci.person_role_id)]) and: [(t.id = ci.movie_id)]) and: [(mc.movie_id = t.id)]) and: [(cn.id = mc.company_id)]) and: [(rt.id = ci.role_id)])) ifTrue: [
                    tmp add: Dictionary from:{'alt'->an at: 'name'. 'character'->chn at: 'name'. 'movie'->t at: 'title'}.
                  ].
                ].
              ].
            ].
          ].
        ].
      ].
    ].
  ].
  tmp
] value.
result := {Dictionary from:{'alternative_name'->([ | tmp |
  tmp := OrderedCollection new.
  matches do: [:x |
    tmp add: x at: 'alt'.
  ].
  tmp
] value min). 'character_name'->([ | tmp |
  tmp := OrderedCollection new.
  matches do: [:x |
    tmp add: x at: 'character'.
  ].
  tmp
] value min). 'movie'->([ | tmp |
  tmp := OrderedCollection new.
  matches do: [:x |
    tmp add: x at: 'movie'.
  ].
  tmp
] value min)}}.
json value: result.
((result = ({Dictionary from:{'alternative_name'->'A. N. G.'. 'character_name'->'Angel'. 'movie'->'Famous Film'}}))) ifTrue: [Transcript show:'ok'; cr] ifFalse: [Transcript show:'fail'; cr].
