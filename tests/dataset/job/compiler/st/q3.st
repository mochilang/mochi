" Generated by Mochi compiler v0.10.25 on 2025-07-13T14:24:44Z
"
| keyword movie_info movie_keyword title allowed_infos candidate_titles result |
keyword := {Dictionary from:{'id'->1. keyword->'amazing sequel'}. Dictionary from:{'id'->2. keyword->'prequel'}}.
movie_info := {Dictionary from:{'movie_id'->10. 'info'->'Germany'}. Dictionary from:{'movie_id'->30. 'info'->'Sweden'}. Dictionary from:{'movie_id'->20. 'info'->'France'}}.
movie_keyword := {Dictionary from:{'movie_id'->10. 'keyword_id'->1}. Dictionary from:{'movie_id'->30. 'keyword_id'->1}. Dictionary from:{'movie_id'->20. 'keyword_id'->1}. Dictionary from:{'movie_id'->10. 'keyword_id'->2}}.
title := {Dictionary from:{'id'->10. title->'Alpha'. 'production_year'->2006}. Dictionary from:{'id'->30. title->'Beta'. 'production_year'->2008}. Dictionary from:{'id'->20. title->'Gamma'. 'production_year'->2009}}.
allowed_infos := {'Sweden'. 'Norway'. 'Germany'. 'Denmark'. 'Swedish'. 'Denish'. 'Norwegian'. 'German'}.
candidate_titles := [ | tmp |
  tmp := OrderedCollection new.
  keyword do: [:k |
    movie_keyword do: [:mk |
      movie_info do: [:mi |
        title do: [:t |
          (((((((((((k at: 'keyword' at: 'contains') value: 'sequel') and: [(((mi at: 'info') in allowed_infos))])) and: [(((t at: 'production_year') > 2005))])) and: [(((mk at: 'movie_id') = (mi at: 'movie_id')))]) and: [(mk.keyword_id = k.id)]) and: [(mi.movie_id = mk.movie_id)]) and: [(t.id = mi.movie_id)])) ifTrue: [
            tmp add: t at: 'title'.
          ].
        ].
      ].
    ].
  ].
  tmp
] value.
result := {Dictionary from:{'movie_title'->(candidate_titles min)}}.
json value: result.
((result = ({Dictionary from:{'movie_title'->'Alpha'}}))) ifTrue: [Transcript show:'ok'; cr] ifFalse: [Transcript show:'fail'; cr].
