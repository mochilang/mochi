# Generated by Mochi compiler v0.10.25 on 2025-07-13T13:07:09Z
require 'ostruct'

def _json(v)
  require 'json'
  obj = v
  if v.is_a?(Array)
    obj = v.map { |it| it.respond_to?(:to_h) ? it.to_h : it }
  elsif v.respond_to?(:to_h)
    obj = v.to_h
  end
  puts(JSON.generate(obj))
end
def _min(v)
  list = nil
  if v.respond_to?(:Items)
    list = v.Items
  elsif v.is_a?(Array)
    list = v
  elsif v.respond_to?(:to_a)
    list = v.to_a
  end
  return 0 if !list || list.empty?
  list.min
end

$keyword = [OpenStruct.new(id: 1, keyword: "10,000-mile-club"), OpenStruct.new(id: 2, keyword: "character-name-in-title")]
$link_type = [OpenStruct.new(id: 1, link: "sequel"), OpenStruct.new(id: 2, link: "remake")]
$movie_keyword = [OpenStruct.new(movie_id: 100, keyword_id: 1), OpenStruct.new(movie_id: 200, keyword_id: 2)]
$movie_link = [OpenStruct.new(movie_id: 100, linked_movie_id: 300, link_type_id: 1), OpenStruct.new(movie_id: 200, linked_movie_id: 400, link_type_id: 2)]
$title = [OpenStruct.new(id: 100, title: "Movie A"), OpenStruct.new(id: 200, title: "Movie B"), OpenStruct.new(id: 300, title: "Movie C"), OpenStruct.new(id: 400, title: "Movie D")]
$joined = (begin
	_res = []
	for k in $keyword
		for mk in $movie_keyword
			if (mk.keyword_id == k.id)
				for t1 in $title
					if (t1.id == mk.movie_id)
						for ml in $movie_link
							if (ml.movie_id == t1.id)
								for t2 in $title
									if (t2.id == ml.linked_movie_id)
										for lt in $link_type
											if (lt.id == ml.link_type_id)
												if (k.keyword == "10,000-mile-club")
													_res << OpenStruct.new(link_type: lt.link, first_movie: t1.title, second_movie: t2.title)
												end
											end
										end
									end
								end
							end
						end
					end
				end
			end
		end
	end
	_res
end)
$result = OpenStruct.new(link_type: _min((($joined)).map { |r| r.link_type }), first_movie: _min((($joined)).map { |r| r.first_movie }), second_movie: _min((($joined)).map { |r| r.second_movie }))
_json([$result])
raise "expect failed" unless ($result == OpenStruct.new(link_type: "sequel", first_movie: "Movie A", second_movie: "Movie C"))
