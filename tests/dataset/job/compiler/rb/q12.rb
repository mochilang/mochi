# Generated by Mochi compiler v0.10.25 on 2025-07-13T12:52:35Z
require 'ostruct'

def _json(v)
  require 'json'
  obj = v
  if v.is_a?(Array)
    obj = v.map { |it| it.respond_to?(:to_h) ? it.to_h : it }
  elsif v.respond_to?(:to_h)
    obj = v.to_h
  end
  puts(JSON.generate(obj))
end

$company_name = [OpenStruct.new(id: 1, name: "Best Pictures", country_code: "[us]"), OpenStruct.new(id: 2, name: "Foreign Films", country_code: "[uk]")]
$company_type = [OpenStruct.new(id: 10, kind: "production companies"), OpenStruct.new(id: 20, kind: "distributors")]
$info_type = [OpenStruct.new(id: 100, info: "genres"), OpenStruct.new(id: 200, info: "rating")]
$movie_companies = [OpenStruct.new(movie_id: 1000, company_id: 1, company_type_id: 10), OpenStruct.new(movie_id: 2000, company_id: 2, company_type_id: 10)]
$movie_info = [OpenStruct.new(movie_id: 1000, info_type_id: 100, info: "Drama"), OpenStruct.new(movie_id: 2000, info_type_id: 100, info: "Horror")]
$movie_info_idx = [OpenStruct.new(movie_id: 1000, info_type_id: 200, info: 8.3), OpenStruct.new(movie_id: 2000, info_type_id: 200, info: 7.5)]
$title = [OpenStruct.new(id: 1000, production_year: 2006, title: "Great Drama"), OpenStruct.new(id: 2000, production_year: 2007, title: "Low Rated")]
$result = (begin
	_res = []
	for cn in $company_name
		for mc in $movie_companies
			if (mc.company_id == cn.id)
				for ct in $company_type
					if (ct.id == mc.company_type_id)
						for t in $title
							if (t.id == mc.movie_id)
								for mi in $movie_info
									if (mi.movie_id == t.id)
										for it1 in $info_type
											if (it1.id == mi.info_type_id)
												for mi_idx in $movie_info_idx
													if (mi_idx.movie_id == t.id)
														for it2 in $info_type
															if (it2.id == mi_idx.info_type_id)
																if ((((((((cn.country_code == "[us]") && (ct.kind == "production companies")) && (it1.info == "genres")) && (it2.info == "rating")) && (((mi.info == "Drama") || (mi.info == "Horror")))) && (mi_idx.info > 8.0)) && (t.production_year >= 2005)) && (t.production_year <= 2008))
																	_res << OpenStruct.new(movie_company: cn.name, rating: mi_idx.info, drama_horror_movie: t.title)
																end
															end
														end
													end
												end
											end
										end
									end
								end
							end
						end
					end
				end
			end
		end
	end
	_res
end)
_json($result)
raise "expect failed" unless ($result == [OpenStruct.new(movie_company: "Best Pictures", rating: 8.3, drama_horror_movie: "Great Drama")])
