>>SOURCE FORMAT FREE
IDENTIFICATION DIVISION.
PROGRAM-ID. MAIN.

DATA DIVISION.
WORKING-STORAGE SECTION.
01 CAST_INFO OCCURS 2 TIMES PIC 9.
01 KEYWORD OCCURS 2 TIMES PIC 9.
01 MOVIE_KEYWORD OCCURS 2 TIMES PIC 9.
01 NAME OCCURS 2 TIMES PIC 9.
01 TITLE OCCURS 2 TIMES PIC 9.
01 CI PIC 9.
01 MK PIC 9.
01 K PIC 9.
01 N PIC 9.
01 T PIC 9.
01 RESULT OCCURS 32 TIMES PIC 9.
01 TMP0 PIC 9.
01 TMP1 PIC 9.
01 IDX PIC 9.
01 IDX2 PIC 9.
01 IDX3 PIC 9.
01 IDX4 PIC 9.
01 IDX5 PIC 9.

PROCEDURE DIVISION.
    MOVE 0 TO CAST_INFO(1)
    MOVE 0 TO CAST_INFO(2)
    MOVE 0 TO KEYWORD(1)
    MOVE 0 TO KEYWORD(2)
    MOVE 0 TO MOVIE_KEYWORD(1)
    MOVE 0 TO MOVIE_KEYWORD(2)
    MOVE 0 TO NAME(1)
    MOVE 0 TO NAME(2)
    MOVE 0 TO TITLE(1)
    MOVE 0 TO TITLE(2)
    MOVE 0 TO TMP0
    MOVE 0 TO TMP1
    MOVE 0 TO IDX
    PERFORM VARYING IDX FROM 0 BY 1 UNTIL IDX >= 2
    MOVE CAST_INFO(IDX + 1) TO CI
        MOVE 0 TO IDX2
        PERFORM VARYING IDX2 FROM 0 BY 1 UNTIL IDX2 >= 2
        MOVE MOVIE_KEYWORD(IDX2 + 1) TO MK
            MOVE 0 TO IDX3
            PERFORM VARYING IDX3 FROM 0 BY 1 UNTIL IDX3 >= 2
            MOVE KEYWORD(IDX3 + 1) TO K
                MOVE 0 TO IDX4
                PERFORM VARYING IDX4 FROM 0 BY 1 UNTIL IDX4 >= 2
                MOVE NAME(IDX4 + 1) TO N
                    MOVE 0 TO IDX5
                    PERFORM VARYING IDX5 FROM 0 BY 1 UNTIL IDX5 >= 2
                    MOVE TITLE(IDX5 + 1) TO T
                    IF K_KEYWORD = "marvel-cinematic-universe" * 0 * 0 * T_PRODUCTION_YEAR > 2010 * CI_MOVIE_ID = MK_MOVIE_ID * MK_KEYWORD_ID = K_ID * CI_PERSON_ID = N_ID * CI_MOVIE_ID = T_ID
                        ADD 1 TO TMP1
                        IF TMP1 > 0
                            IF 0 = 0 OR TMP0 < 0
                                ADD 1 TO TMP0
                                COMPUTE RESULT(TMP0) = 0
                            END-IF
                        END-IF
                    END-IF
                    END-PERFORM
                END-PERFORM
            END-PERFORM
        END-PERFORM
    END-PERFORM
DISPLAY "-- TEST Q6 finds marvel movie with Robert Downey --"
IF NOT (RESULT = 0)
    DISPLAY "expect failed"
    STOP RUN
END-IF
DISPLAY "-- END Q6 finds marvel movie with Robert Downey --"
    STOP RUN.
