>>SOURCE FORMAT FREE
IDENTIFICATION DIVISION.
PROGRAM-ID. MAIN.

DATA DIVISION.
WORKING-STORAGE SECTION.
01 INFO_TYPE OCCURS 2 TIMES PIC 9.
01 KEYWORD OCCURS 2 TIMES PIC 9.
01 TITLE OCCURS 3 TIMES PIC 9.
01 MOVIE_KEYWORD OCCURS 3 TIMES PIC 9.
01 MOVIE_INFO_IDX OCCURS 3 TIMES PIC 9.
01 IT PIC 9.
01 MI PIC 9.
01 T PIC 9.
01 MK PIC 9.
01 K PIC 9.
01 ROWS OCCURS 108 TIMES PIC 9.
01 TMP0 PIC 9.
01 TMP1 PIC 9.
01 IDX PIC 9.
01 IDX2 PIC 9.
01 IDX3 PIC 9.
01 IDX4 PIC 9.
01 IDX5 PIC 9.
01 RESULT OCCURS 1 TIMES PIC 9.

PROCEDURE DIVISION.
    MOVE 0 TO INFO_TYPE(1)
    MOVE 0 TO INFO_TYPE(2)
    MOVE 0 TO KEYWORD(1)
    MOVE 0 TO KEYWORD(2)
    MOVE 0 TO TITLE(1)
    MOVE 0 TO TITLE(2)
    MOVE 0 TO TITLE(3)
    MOVE 0 TO MOVIE_KEYWORD(1)
    MOVE 0 TO MOVIE_KEYWORD(2)
    MOVE 0 TO MOVIE_KEYWORD(3)
    MOVE 0 TO MOVIE_INFO_IDX(1)
    MOVE 0 TO MOVIE_INFO_IDX(2)
    MOVE 0 TO MOVIE_INFO_IDX(3)
    MOVE 0 TO TMP0
    MOVE 0 TO TMP1
    MOVE 0 TO IDX
    PERFORM VARYING IDX FROM 0 BY 1 UNTIL IDX >= 2
    MOVE INFO_TYPE(IDX + 1) TO IT
        MOVE 0 TO IDX2
        PERFORM VARYING IDX2 FROM 0 BY 1 UNTIL IDX2 >= 3
        MOVE MOVIE_INFO_IDX(IDX2 + 1) TO MI
            MOVE 0 TO IDX3
            PERFORM VARYING IDX3 FROM 0 BY 1 UNTIL IDX3 >= 3
            MOVE TITLE(IDX3 + 1) TO T
                MOVE 0 TO IDX4
                PERFORM VARYING IDX4 FROM 0 BY 1 UNTIL IDX4 >= 3
                MOVE MOVIE_KEYWORD(IDX4 + 1) TO MK
                    MOVE 0 TO IDX5
                    PERFORM VARYING IDX5 FROM 0 BY 1 UNTIL IDX5 >= 2
                    MOVE KEYWORD(IDX5 + 1) TO K
                    IF IT_INFO = "rating" * 0 * MI_INFO > "5.0" * T_PRODUCTION_YEAR > 2005 * MK_MOVIE_ID = MI_MOVIE_ID * IT_ID = MI_INFO_TYPE_ID * T_ID = MI_MOVIE_ID * MK_MOVIE_ID = T_ID * K_ID = MK_KEYWORD_ID
                        ADD 1 TO TMP1
                        IF TMP1 > 0
                            IF 0 = 0 OR TMP0 < 0
                                ADD 1 TO TMP0
                                COMPUTE ROWS(TMP0) = 0
                            END-IF
                        END-IF
                    END-IF
                    END-PERFORM
                END-PERFORM
            END-PERFORM
        END-PERFORM
    END-PERFORM
    MOVE 0 TO RESULT(1)
DISPLAY "-- TEST Q4 returns minimum rating and title for sequels --"
IF NOT (RESULT = 0)
    DISPLAY "expect failed"
    STOP RUN
END-IF
DISPLAY "-- END Q4 returns minimum rating and title for sequels --"
    STOP RUN.
