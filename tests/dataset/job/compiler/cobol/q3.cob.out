>>SOURCE FORMAT FREE
IDENTIFICATION DIVISION.
PROGRAM-ID. MAIN.

DATA DIVISION.
WORKING-STORAGE SECTION.
01 KEYWORD OCCURS 2 TIMES PIC 9.
01 MOVIE_INFO OCCURS 3 TIMES PIC 9.
01 MOVIE_KEYWORD OCCURS 4 TIMES PIC 9.
01 TITLE OCCURS 3 TIMES PIC 9.
01 ALLOWED_INFOS OCCURS 8 TIMES PIC X(100).
01 K PIC 9.
01 MK PIC 9.
01 MI PIC 9.
01 T PIC 9.
01 CANDIDATE_TITLES OCCURS 72 TIMES PIC 9.
01 TMP0 PIC 9.
01 TMP1 PIC 9.
01 IDX PIC 9.
01 IDX2 PIC 9.
01 IDX3 PIC 9.
01 IDX4 PIC 9.
01 RESULT OCCURS 1 TIMES PIC 9.

PROCEDURE DIVISION.
    MOVE 0 TO KEYWORD(1)
    MOVE 0 TO KEYWORD(2)
    MOVE 0 TO MOVIE_INFO(1)
    MOVE 0 TO MOVIE_INFO(2)
    MOVE 0 TO MOVIE_INFO(3)
    MOVE 0 TO MOVIE_KEYWORD(1)
    MOVE 0 TO MOVIE_KEYWORD(2)
    MOVE 0 TO MOVIE_KEYWORD(3)
    MOVE 0 TO MOVIE_KEYWORD(4)
    MOVE 0 TO TITLE(1)
    MOVE 0 TO TITLE(2)
    MOVE 0 TO TITLE(3)
    MOVE "Sweden" TO ALLOWED_INFOS(1)
    MOVE "Norway" TO ALLOWED_INFOS(2)
    MOVE "Germany" TO ALLOWED_INFOS(3)
    MOVE "Denmark" TO ALLOWED_INFOS(4)
    MOVE "Swedish" TO ALLOWED_INFOS(5)
    MOVE "Denish" TO ALLOWED_INFOS(6)
    MOVE "Norwegian" TO ALLOWED_INFOS(7)
    MOVE "German" TO ALLOWED_INFOS(8)
    MOVE 0 TO TMP0
    MOVE 0 TO TMP1
    MOVE 0 TO IDX
    PERFORM VARYING IDX FROM 0 BY 1 UNTIL IDX >= 2
    MOVE KEYWORD(IDX + 1) TO K
        MOVE 0 TO IDX2
        PERFORM VARYING IDX2 FROM 0 BY 1 UNTIL IDX2 >= 4
        MOVE MOVIE_KEYWORD(IDX2 + 1) TO MK
            MOVE 0 TO IDX3
            PERFORM VARYING IDX3 FROM 0 BY 1 UNTIL IDX3 >= 3
            MOVE MOVIE_INFO(IDX3 + 1) TO MI
                MOVE 0 TO IDX4
                PERFORM VARYING IDX4 FROM 0 BY 1 UNTIL IDX4 >= 3
                MOVE TITLE(IDX4 + 1) TO T
                IF 0 * MI_INFO in ALLOWED_INFOS * T_PRODUCTION_YEAR > 2005 * MK_MOVIE_ID = MI_MOVIE_ID * MK_KEYWORD_ID = K_ID * MI_MOVIE_ID = MK_MOVIE_ID * T_ID = MI_MOVIE_ID
                    ADD 1 TO TMP1
                    IF TMP1 > 0
                        IF 0 = 0 OR TMP0 < 0
                            ADD 1 TO TMP0
                            COMPUTE CANDIDATE_TITLES(TMP0) = T_TITLE
                        END-IF
                    END-IF
                END-IF
                END-PERFORM
            END-PERFORM
        END-PERFORM
    END-PERFORM
    MOVE 0 TO RESULT(1)
DISPLAY "-- TEST Q3 returns lexicographically smallest sequel title --"
IF NOT (RESULT = 0)
    DISPLAY "expect failed"
    STOP RUN
END-IF
DISPLAY "-- END Q3 returns lexicographically smallest sequel title --"
    STOP RUN.
