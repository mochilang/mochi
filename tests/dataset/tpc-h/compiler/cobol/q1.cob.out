>>SOURCE FORMAT FREE
IDENTIFICATION DIVISION.
PROGRAM-ID. MAIN.

DATA DIVISION.
WORKING-STORAGE SECTION.
01 LINEITEM OCCURS 3 TIMES PIC 9.
01 ROW PIC 9.
01 RESULT OCCURS 3 TIMES PIC 9.
01 TMP0 PIC 9.
01 TMP1 PIC 9.
01 IDX PIC 9.

PROCEDURE DIVISION.
    MOVE 0 TO LINEITEM(1)
    MOVE 0 TO LINEITEM(2)
    MOVE 0 TO LINEITEM(3)
    MOVE 0 TO TMP0
    MOVE 0 TO TMP1
    MOVE 0 TO IDX
    PERFORM VARYING IDX FROM 0 BY 1 UNTIL IDX >= 3
    MOVE LINEITEM(IDX + 1) TO ROW
    IF ROW_L_SHIPDATE <= "1998-09-02"
        ADD 1 TO TMP1
        IF TMP1 > 0
            IF 0 = 0 OR TMP0 < 0
                ADD 1 TO TMP0
                COMPUTE RESULT(TMP0) = 0
            END-IF
        END-IF
    END-IF
    END-PERFORM
DISPLAY "-- TEST Q1 aggregates revenue and quantity by returnflag + linestatus --"
IF NOT (RESULT = 0)
    DISPLAY "expect failed"
    STOP RUN
END-IF
DISPLAY "-- END Q1 aggregates revenue and quantity by returnflag + linestatus --"
    STOP RUN.
