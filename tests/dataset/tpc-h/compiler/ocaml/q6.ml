(* Generated by Mochi compiler v0.10.25 on 2025-07-13T17:51:26Z *)
let sum lst = List.fold_left (+) 0 lst
let sum_float lst = List.fold_left (+.) 0.0 lst

type record1 = { mutable l_extendedprice : float; mutable l_discount : float; mutable l_shipdate : string; mutable l_quantity : int }

let lineitem : record1 list = [{ l_extendedprice = 1000.; l_discount = 0.06; l_shipdate = "1994-02-15"; l_quantity = 10 };{ l_extendedprice = 500.; l_discount = 0.07; l_shipdate = "1994-03-10"; l_quantity = 23 };{ l_extendedprice = 400.; l_discount = 0.04; l_shipdate = "1994-04-10"; l_quantity = 15 };{ l_extendedprice = 200.; l_discount = 0.06; l_shipdate = "1995-01-01"; l_quantity = 5 }]
let result : float list = (let __res0 = ref [] in
  List.iter (fun (l : record1) ->
      if ((((((l.l_shipdate >= "1994-01-01")) && ((l.l_shipdate < "1995-01-01"))) && ((l.l_discount >= 0.05))) && ((l.l_discount <= 0.07))) && ((l.l_quantity < 24))) then
    __res0 := (sum_float (l.l_extendedprice *. l.l_discount)) :: !__res0;
  ) lineitem;
List.rev !__res0)


let () =
  json result;
  assert ((result = ((((1000. *. 0.06)) +. ((500. *. 0.07))))))
