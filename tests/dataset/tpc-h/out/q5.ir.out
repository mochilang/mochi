func main (regs=210)
  // let region = [
  Const        r0, [{"r_name": "ASIA", "r_regionkey": 0}, {"r_name": "EUROPE", "r_regionkey": 1}]
  Move         r1, r0
  // let nation = [
  Const        r2, [{"n_name": "JAPAN", "n_nationkey": 10, "n_regionkey": 0}, {"n_name": "INDIA", "n_nationkey": 20, "n_regionkey": 0}, {"n_name": "FRANCE", "n_nationkey": 30, "n_regionkey": 1}]
  // let supplier = [
  Const        r6, [{"s_nationkey": 10, "s_suppkey": 100}, {"s_nationkey": 20, "s_suppkey": 200}]
  // let orders = [
  Const        r8, [{"o_custkey": 1, "o_orderdate": "1994-03-15", "o_orderkey": 1000}, {"o_custkey": 2, "o_orderdate": "1994-06-10", "o_orderkey": 2000}, {"o_custkey": 2, "o_orderdate": "1995-01-01", "o_orderkey": 3000}]
  // let lineitem = [
  Const        r10, [{"l_discount": 0.05, "l_extendedprice": 1000, "l_orderkey": 1000, "l_suppkey": 100}, {"l_discount": 0.1, "l_extendedprice": 800, "l_orderkey": 2000, "l_suppkey": 200}, {"l_discount": 0.05, "l_extendedprice": 900, "l_orderkey": 3000, "l_suppkey": 200}]
  // from r in region
  IterPrep     r13, r1
  Len          r14, r13
  // join n in nation on n.n_regionkey == r.r_regionkey
  IterPrep     r15, r2
  Len          r16, r15
  // from r in region
  Const        r17, 0
  Less         r18, r17, r14
  JumpIfFalse  r18, L0
  Index        r19, r13, r17
  // join n in nation on n.n_regionkey == r.r_regionkey
  Const        r21, 0
  Less         r22, r21, r16
L4:
  JumpIfFalse  r22, L1
  Index        r23, r15, r21
  Const        r25, "n_regionkey"
  Index        r26, r23, r25
  Const        r27, "r_regionkey"
L3:
  Index        r28, r19, r27
  Equal        r29, r26, r28
  JumpIfFalse  r29, L2
  // where r.r_name == "ASIA"
  Const        r30, "r_name"
  Index        r31, r19, r30
  Const        r32, "ASIA"
  Equal        r33, r31, r32
  JumpIfFalse  r33, L2
  // join n in nation on n.n_regionkey == r.r_regionkey
  Jump         L3
  // from r in region
  Jump         L4
  // from c in customer
  Const        r40, []
  IterPrep     r41, r4
  Len          r42, r41
  Const        r43, 0
L2:
  Less         r44, r43, r42
L1:
  JumpIfFalse  r44, L5
  Index        r45, r41, r43
  // join n in asia_nations on c.c_nationkey == n.n_nationkey
  IterPrep     r47, r34
  Len          r48, r47
L0:
  Const        r49, 0
  Less         r50, r49, r48
  JumpIfFalse  r50, L6
  Index        r51, r47, r49
  Const        r52, "c_nationkey"
L16:
  Index        r53, r45, r52
  Const        r54, "n_nationkey"
  Index        r55, r51, r54
  Equal        r56, r53, r55
  JumpIfFalse  r56, L6
  // join o in orders on o.o_custkey == c.c_custkey
  IterPrep     r57, r8
  Len          r58, r57
L15:
  Const        r59, 0
  Less         r60, r59, r58
  JumpIfFalse  r60, L6
  Index        r61, r57, r59
  Const        r63, "o_custkey"
  Index        r64, r61, r63
  Const        r65, "c_custkey"
  Index        r66, r45, r65
  Equal        r67, r64, r66
  JumpIfFalse  r67, L7
  // join l in lineitem on l.l_orderkey == o.o_orderkey
  IterPrep     r68, r10
  Len          r69, r68
  Const        r70, 0
L14:
  Less         r71, r70, r69
  JumpIfFalse  r71, L7
  Index        r72, r68, r70
  Const        r74, "l_orderkey"
  Index        r75, r72, r74
  Const        r76, "o_orderkey"
  Index        r77, r61, r76
  Equal        r78, r75, r77
  JumpIfFalse  r78, L8
  // join s in supplier on s.s_suppkey == l.l_suppkey
  IterPrep     r79, r6
  Len          r80, r79
  Const        r81, 0
  Less         r82, r81, r80
L13:
  JumpIfFalse  r82, L8
  Index        r83, r79, r81
  Const        r85, "s_suppkey"
  Index        r86, r83, r85
  Const        r87, "l_suppkey"
  Index        r88, r72, r87
  Equal        r89, r86, r88
  JumpIfFalse  r89, L9
  // where o.o_orderdate >= "1994-01-01" && o.o_orderdate < "1995-01-01" && s.s_nationkey == c.c_nationkey
  Const        r90, "o_orderdate"
  Index        r91, r61, r90
  Const        r92, "1994-01-01"
  LessEq       r93, r92, r91
  Const        r94, "o_orderdate"
L12:
  Index        r95, r61, r94
  Const        r96, "1995-01-01"
  Less         r97, r95, r96
  Const        r98, "s_nationkey"
  Index        r99, r83, r98
  Const        r100, "c_nationkey"
  Index        r101, r45, r100
  Equal        r102, r99, r101
  Move         r103, r93
  JumpIfFalse  r103, L10
  JumpIfFalse  r97, L11
  JumpIfFalse  r102, L9
  // nation: n.n_name,
  Const        r105, "nation"
  Const        r106, "n_name"
  Index        r107, r51, r106
  // revenue: l.l_extendedprice * (1 - l.l_discount)
  Const        r108, "revenue"
  Const        r109, "l_extendedprice"
  Index        r110, r72, r109
  Const        r111, 1
  Const        r112, "l_discount"
  Index        r113, r72, r112
  Sub          r114, r111, r113
  Mul          r115, r110, r114
  // nation: n.n_name,
  Move         r116, r105
  Move         r117, r107
  // revenue: l.l_extendedprice * (1 - l.l_discount)
  Move         r118, r108
L10:
  Move         r119, r115
  // select {
  MakeMap      r120, 2, r116
  // from c in customer
  Append       r121, r40, r120
L11:
  Move         r40, r121
  // join s in supplier on s.s_suppkey == l.l_suppkey
  Jump         L12
  // join l in lineitem on l.l_orderkey == o.o_orderkey
  Jump         L13
  // join o in orders on o.o_custkey == c.c_custkey
  Jump         L14
  // join n in asia_nations on c.c_nationkey == n.n_nationkey
  Jump         L15
  // from c in customer
  Jump         L16
  // from r in local_customer_supplier_orders
  IterPrep     r134, r40
  Len          r135, r134
  Const        r136, 0
  MakeMap      r137, 0, r0
  Less         r139, r136, r135
  JumpIfFalse  r139, L17
  Index        r140, r134, r136
  // group by r.nation into g
  Const        r141, "nation"
  Index        r142, r140, r141
  Str          r143, r142
L9:
  In           r144, r143, r137
L8:
  JumpIfTrue   r144, L18
L7:
  // from r in local_customer_supplier_orders
  Const        r146, "__group__"
L6:
  Const        r147, true
  Const        r148, "key"
  // group by r.nation into g
  Move         r149, r142
  // from r in local_customer_supplier_orders
  MakeMap      r152, 2, r146
L5:
  SetIndex     r137, r143, r152
  Const        r154, "items"
  Index        r155, r137, r143
  Index        r156, r155, r154
  Append       r157, r156, r140
L19:
  SetIndex     r155, r154, r157
  Jump         L19
  Jump         L20
  Const        r163, nil
  // revenue: sum(from x in g select x.revenue)
  IterPrep     r170, r163
  Len          r171, r170
  Const        r172, 0
  Less         r173, r172, r171
  JumpIfFalse  r173, L21
  // sort by -sum(from x in g select x.revenue)
  IterPrep     r188, r163
  Len          r189, r188
  Const        r190, 0
L18:
  Less         r191, r190, r189
  JumpIfFalse  r191, L22
  // from r in local_customer_supplier_orders
  Jump         L23
  // sort by -sum(from x in g select x.revenue)
  Sort         r206, r133
  // json(result)
  JSON         r206
  // expect result == [
  Const        r208, [{"n_name": "JAPAN", "revenue": 950}, {"n_name": "INDIA", "revenue": 720}]
  Equal        r209, r206, r208
  Expect       r209
L17:
  Return       r0
