func main (regs=220)
  // let region = [
  Const        r0, [{"r_name": "EUROPE", "r_regionkey": 1}, {"r_name": "ASIA", "r_regionkey": 2}]
  Move         r1, r0
  // let nation = [
  Const        r2, [{"n_name": "FRANCE", "n_nationkey": 10, "n_regionkey": 1}, {"n_name": "CHINA", "n_nationkey": 20, "n_regionkey": 2}]
  Move         r3, r2
  // let supplier = [
  Const        r4, [{"s_acctbal": 1000, "s_address": "123 Rue", "s_comment": "Fast and reliable", "s_name": "BestSupplier", "s_nationkey": 10, "s_phone": "123", "s_suppkey": 100}, {"s_acctbal": 500, "s_address": "456 Way", "s_comment": "Slow", "s_name": "AltSupplier", "s_nationkey": 20, "s_phone": "456", "s_suppkey": 200}]
  Move         r5, r4
  // let part = [
  Const        r6, [{"p_mfgr": "M1", "p_partkey": 1000, "p_size": 15, "p_type": "LARGE BRASS"}, {"p_mfgr": "M2", "p_partkey": 2000, "p_size": 15, "p_type": "SMALL COPPER"}]
  Move         r7, r6
  // let partsupp = [
  Const        r8, [{"ps_partkey": 1000, "ps_suppkey": 100, "ps_supplycost": 10}, {"ps_partkey": 1000, "ps_suppkey": 200, "ps_supplycost": 15}]
  Move         r9, r8
  // from r in region
  Const        r10, []
  IterPrep     r11, r1
  Len          r12, r11
  // join n in nation on n.n_regionkey == r.r_regionkey
  IterPrep     r13, r3
  Len          r14, r13
  // from r in region
  Const        r15, 0
L4:
  Less         r16, r15, r12
  JumpIfFalse  r16, L0
  Index        r17, r11, r15
  Move         r18, r17
  // join n in nation on n.n_regionkey == r.r_regionkey
  Const        r19, 0
L3:
  Less         r20, r19, r14
  JumpIfFalse  r20, L1
  Index        r21, r13, r19
  Move         r22, r21
  Const        r23, "n_regionkey"
  Index        r24, r22, r23
  Const        r25, "r_regionkey"
  Index        r26, r18, r25
  Equal        r27, r24, r26
  JumpIfFalse  r27, L2
  // where r.r_name == "EUROPE"
  Const        r28, "r_name"
  Index        r29, r18, r28
  Const        r30, "EUROPE"
  Equal        r31, r29, r30
  JumpIfFalse  r31, L2
  // from r in region
  Append       r32, r10, r22
  Move         r10, r32
L2:
  // join n in nation on n.n_regionkey == r.r_regionkey
  Const        r33, 1
  Add          r34, r19, r33
  Move         r19, r34
  Jump         L3
L1:
  // from r in region
  Const        r35, 1
  Add          r36, r15, r35
  Move         r15, r36
  Jump         L4
L0:
  // let europe_nations =
  Move         r37, r10
  // from s in supplier
  Const        r38, []
  IterPrep     r39, r5
  Len          r40, r39
  // join n in europe_nations on s.s_nationkey == n.n_nationkey
  IterPrep     r41, r37
  Len          r42, r41
  // from s in supplier
  Const        r43, 0
L9:
  Less         r44, r43, r40
  JumpIfFalse  r44, L5
  Index        r45, r39, r43
  Move         r46, r45
  // join n in europe_nations on s.s_nationkey == n.n_nationkey
  Const        r47, 0
L8:
  Less         r48, r47, r42
  JumpIfFalse  r48, L6
  Index        r49, r41, r47
  Move         r22, r49
  Const        r50, "s_nationkey"
  Index        r51, r46, r50
  Const        r52, "n_nationkey"
  Index        r53, r22, r52
  Equal        r54, r51, r53
  JumpIfFalse  r54, L7
  // select { s: s, n: n }
  Const        r55, "s"
  Const        r56, "n"
  Move         r57, r55
  Move         r58, r46
  Move         r59, r56
  Move         r60, r22
  MakeMap      r61, 2, r57
  // from s in supplier
  Append       r62, r38, r61
  Move         r38, r62
L7:
  // join n in europe_nations on s.s_nationkey == n.n_nationkey
  Const        r63, 1
  Add          r64, r47, r63
  Move         r47, r64
  Jump         L8
L6:
  // from s in supplier
  Const        r65, 1
  Add          r66, r43, r65
  Move         r43, r66
  Jump         L9
L5:
  // let europe_suppliers =
  Move         r67, r38
  // from p in part
  Const        r68, []
  IterPrep     r69, r7
  Len          r70, r69
  Const        r71, 0
L13:
  Less         r72, r71, r70
  JumpIfFalse  r72, L10
  Index        r73, r69, r71
  Move         r74, r73
  // where p.p_size == 15 && p.p_type == "LARGE BRASS"
  Const        r75, "p_size"
  Index        r76, r74, r75
  Const        r77, 15
  Equal        r78, r76, r77
  Const        r79, "p_type"
  Index        r80, r74, r79
  Const        r81, "LARGE BRASS"
  Equal        r82, r80, r81
  Move         r83, r78
  JumpIfFalse  r83, L11
  Move         r83, r82
L11:
  JumpIfFalse  r83, L12
  // from p in part
  Append       r84, r68, r74
  Move         r68, r84
L12:
  Const        r85, 1
  Add          r86, r71, r85
  Move         r71, r86
  Jump         L13
L10:
  // let target_parts =
  Move         r87, r68
  // from ps in partsupp
  Const        r88, []
  IterPrep     r89, r9
  Len          r90, r89
  Const        r91, 0
L20:
  Less         r92, r91, r90
  JumpIfFalse  r92, L14
  Index        r93, r89, r91
  Move         r94, r93
  // join p in target_parts on ps.ps_partkey == p.p_partkey
  IterPrep     r95, r87
  Len          r96, r95
  Const        r97, 0
L19:
  Less         r98, r97, r96
  JumpIfFalse  r98, L15
  Index        r99, r95, r97
  Move         r74, r99
  Const        r100, "ps_partkey"
  Index        r101, r94, r100
  Const        r102, "p_partkey"
  Index        r103, r74, r102
  Equal        r104, r101, r103
  JumpIfFalse  r104, L16
  // join s in europe_suppliers on ps.ps_suppkey == s.s.s_suppkey
  IterPrep     r105, r67
  Len          r106, r105
  Const        r107, 0
L18:
  Less         r108, r107, r106
  JumpIfFalse  r108, L16
  Index        r109, r105, r107
  Move         r46, r109
  Const        r110, "ps_suppkey"
  Index        r111, r94, r110
  Const        r112, "s"
  Index        r113, r46, r112
  Const        r114, "s_suppkey"
  Index        r115, r113, r114
  Equal        r116, r111, r115
  JumpIfFalse  r116, L17
  // s_acctbal: s.s.s_acctbal,
  Const        r117, "s_acctbal"
  Const        r118, "s"
  Index        r119, r46, r118
  Const        r120, "s_acctbal"
  Index        r121, r119, r120
  // s_name: s.s.s_name,
  Const        r122, "s_name"
  Const        r123, "s"
  Index        r124, r46, r123
  Const        r125, "s_name"
  Index        r126, r124, r125
  // n_name: s.n.n_name,
  Const        r127, "n_name"
  Const        r128, "n"
  Index        r129, r46, r128
  Const        r130, "n_name"
  Index        r131, r129, r130
  // p_partkey: p.p_partkey,
  Const        r132, "p_partkey"
  Const        r133, "p_partkey"
  Index        r134, r74, r133
  // p_mfgr: p.p_mfgr,
  Const        r135, "p_mfgr"
  Const        r136, "p_mfgr"
  Index        r137, r74, r136
  // s_address: s.s.s_address,
  Const        r138, "s_address"
  Const        r139, "s"
  Index        r140, r46, r139
  Const        r141, "s_address"
  Index        r142, r140, r141
  // s_phone: s.s.s_phone,
  Const        r143, "s_phone"
  Const        r144, "s"
  Index        r145, r46, r144
  Const        r146, "s_phone"
  Index        r147, r145, r146
  // s_comment: s.s.s_comment,
  Const        r148, "s_comment"
  Const        r149, "s"
  Index        r150, r46, r149
  Const        r151, "s_comment"
  Index        r152, r150, r151
  // ps_supplycost: ps.ps_supplycost
  Const        r153, "ps_supplycost"
  Const        r154, "ps_supplycost"
  Index        r155, r94, r154
  // s_acctbal: s.s.s_acctbal,
  Move         r156, r117
  Move         r157, r121
  // s_name: s.s.s_name,
  Move         r158, r122
  Move         r159, r126
  // n_name: s.n.n_name,
  Move         r160, r127
  Move         r161, r131
  // p_partkey: p.p_partkey,
  Move         r162, r132
  Move         r163, r134
  // p_mfgr: p.p_mfgr,
  Move         r164, r135
  Move         r165, r137
  // s_address: s.s.s_address,
  Move         r166, r138
  Move         r167, r142
  // s_phone: s.s.s_phone,
  Move         r168, r143
  Move         r169, r147
  // s_comment: s.s.s_comment,
  Move         r170, r148
  Move         r171, r152
  // ps_supplycost: ps.ps_supplycost
  Move         r172, r153
  Move         r173, r155
  // select {
  MakeMap      r174, 9, r156
  // from ps in partsupp
  Append       r175, r88, r174
  Move         r88, r175
L17:
  // join s in europe_suppliers on ps.ps_suppkey == s.s.s_suppkey
  Const        r176, 1
  Add          r177, r107, r176
  Move         r107, r177
  Jump         L18
L16:
  // join p in target_parts on ps.ps_partkey == p.p_partkey
  Const        r178, 1
  Add          r179, r97, r178
  Move         r97, r179
  Jump         L19
L15:
  // from ps in partsupp
  Const        r180, 1
  Add          r181, r91, r180
  Move         r91, r181
  Jump         L20
L14:
  // let target_partsupp =
  Move         r182, r88
  // let costs = from x in target_partsupp select x.ps_supplycost
  Const        r183, []
  IterPrep     r184, r182
  Len          r185, r184
  Const        r186, 0
L22:
  Less         r187, r186, r185
  JumpIfFalse  r187, L21
  Index        r188, r184, r186
  Move         r189, r188
  Const        r190, "ps_supplycost"
  Index        r191, r189, r190
  Append       r192, r183, r191
  Move         r183, r192
  Const        r193, 1
  Add          r194, r186, r193
  Move         r186, r194
  Jump         L22
L21:
  Move         r195, r183
  // let min_cost = min(costs)
  Min          r196, r195
  Move         r197, r196
  // from x in target_partsupp
  Const        r198, []
  IterPrep     r199, r182
  Len          r200, r199
  Const        r201, 0
L25:
  Less         r202, r201, r200
  JumpIfFalse  r202, L23
  Index        r203, r199, r201
  Move         r189, r203
  // where x.ps_supplycost == min_cost
  Const        r204, "ps_supplycost"
  Index        r205, r189, r204
  Equal        r206, r205, r197
  JumpIfFalse  r206, L24
  // sort by -x.s_acctbal
  Const        r207, "s_acctbal"
  Index        r208, r189, r207
  Neg          r209, r208
  Move         r210, r209
  // from x in target_partsupp
  Move         r211, r189
  MakeList     r212, 2, r210
  Append       r213, r198, r212
  Move         r198, r213
L24:
  Const        r214, 1
  Add          r215, r201, r214
  Move         r201, r215
  Jump         L25
L23:
  // sort by -x.s_acctbal
  Sort         r216, r198
  // from x in target_partsupp
  Move         r198, r216
  // let result =
  Move         r217, r198
  // json(result)
  JSON         r217
  // expect result == [
  Const        r218, [{"n_name": "FRANCE", "p_mfgr": "M1", "p_partkey": 1000, "ps_supplycost": 10, "s_acctbal": 1000, "s_address": "123 Rue", "s_comment": "Fast and reliable", "s_name": "BestSupplier", "s_phone": "123"}]
  Equal        r219, r217, r218
  Expect       r219
  Return       r0
