func main (regs=161)
  // let nation = [
  Const        r0, [{"n_name": "SAUDI ARABIA", "n_nationkey": 1}, {"n_name": "FRANCE", "n_nationkey": 2}]
  Move         r1, r0
  // let supplier = [
  Const        r2, [{"s_name": "Desert Trade", "s_nationkey": 1, "s_suppkey": 100}, {"s_name": "Euro Goods", "s_nationkey": 2, "s_suppkey": 200}]
  // let orders = [
  Const        r4, [{"o_orderkey": 500, "o_orderstatus": "F"}, {"o_orderkey": 600, "o_orderstatus": "O"}]
  // let lineitem = [
  Const        r6, [{"l_commitdate": "1995-04-10", "l_orderkey": 500, "l_receiptdate": "1995-04-15", "l_suppkey": 100}, {"l_commitdate": "1995-04-12", "l_orderkey": 500, "l_receiptdate": "1995-04-12", "l_suppkey": 200}, {"l_commitdate": "1995-04-25", "l_orderkey": 600, "l_receiptdate": "1995-05-01", "l_suppkey": 100}]
  // from s in supplier
  MakeMap      r9, 0, r0
  IterPrep     r11, r2
  Len          r12, r11
  Const        r13, 0
  Less         r14, r13, r12
  JumpIfFalse  r14, L0
  Index        r15, r11, r13
L13:
  // join l1 in lineitem on s.s_suppkey == l1.l_suppkey
  IterPrep     r17, r6
  Len          r18, r17
  Const        r19, 0
  Less         r20, r19, r18
  JumpIfFalse  r20, L1
  Index        r21, r17, r19
  Const        r23, "s_suppkey"
L12:
  Index        r24, r15, r23
  Const        r25, "l_suppkey"
  Index        r26, r21, r25
  Equal        r27, r24, r26
  JumpIfFalse  r27, L1
  // join o in orders on o.o_orderkey == l1.l_orderkey
  IterPrep     r28, r4
  Len          r29, r28
  Const        r30, 0
  Less         r31, r30, r29
  JumpIfFalse  r31, L1
  Index        r32, r28, r30
  Const        r34, "o_orderkey"
  Index        r35, r32, r34
L11:
  Const        r36, "l_orderkey"
  Index        r37, r21, r36
  Equal        r38, r35, r37
  JumpIfFalse  r38, L1
  // join n in nation on n.n_nationkey == s.s_nationkey
  IterPrep     r39, r1
  Len          r40, r39
  Const        r41, 0
  Less         r42, r41, r40
  JumpIfFalse  r42, L1
  Index        r43, r39, r41
  Const        r45, "n_nationkey"
  Index        r46, r43, r45
  Const        r47, "s_nationkey"
L10:
  Index        r48, r15, r47
  Equal        r49, r46, r48
  JumpIfFalse  r49, L1
  // o.o_orderstatus == "F" &&
  Const        r50, "o_orderstatus"
  Index        r51, r32, r50
  // l1.l_receiptdate > l1.l_commitdate &&
  Const        r52, "l_receiptdate"
  Index        r53, r21, r52
  Const        r54, "l_commitdate"
  Index        r55, r21, r54
  Less         r56, r55, r53
  // o.o_orderstatus == "F" &&
  Const        r57, "F"
  Equal        r58, r51, r57
  // n.n_name == "SAUDI ARABIA" && (!exists(
  Const        r59, "n_name"
  Index        r60, r43, r59
  Const        r61, "SAUDI ARABIA"
  Equal        r62, r60, r61
  // o.o_orderstatus == "F" &&
  JumpIfFalse  r58, L2
  // l1.l_receiptdate > l1.l_commitdate &&
  JumpIfFalse  r56, L3
  // n.n_name == "SAUDI ARABIA" && (!exists(
  JumpIfFalse  r62, L4
  // from x in lineitem
  IterPrep     r67, r6
  Len          r68, r67
  Const        r69, 0
  Less         r70, r69, r68
  JumpIfFalse  r70, L5
  Index        r71, r67, r69
L2:
  // where x.l_orderkey == l1.l_orderkey && x.l_suppkey != l1.l_suppkey && x.l_receiptdate > x.l_commitdate
  Const        r73, "l_orderkey"
  Index        r74, r71, r73
  Const        r75, "l_receiptdate"
L3:
  Index        r76, r71, r75
  Const        r77, "l_commitdate"
  Index        r78, r71, r77
  Less         r79, r78, r76
  Const        r80, "l_orderkey"
  Index        r81, r21, r80
L9:
  Equal        r82, r74, r81
  Const        r83, "l_suppkey"
  Index        r84, r71, r83
  Const        r85, "l_suppkey"
  Index        r86, r21, r85
  NotEqual     r87, r84, r86
  JumpIfFalse  r82, L6
  JumpIfFalse  r87, L7
  JumpIfFalse  r79, L8
  // from x in lineitem
  Jump         L9
  // n.n_name == "SAUDI ARABIA" && (!exists(
  Exists       r93, r90
  Not          r94, r93
  // o.o_orderstatus == "F" &&
  JumpIfFalse  r94, L1
  // from s in supplier
  Const        r95, "s"
  Move         r96, r15
  Const        r97, "l1"
  Move         r98, r21
  Const        r99, "o"
  Move         r100, r32
L6:
  Const        r101, "n"
  Move         r102, r43
  MakeMap      r103, 4, r95
L7:
  // group by s.s_name into g
  Const        r104, "s_name"
  Index        r105, r15, r104
  Str          r106, r105
L8:
  In           r107, r106, r9
  JumpIfTrue   r107, L1
  // from s in supplier
  Const        r109, "__group__"
  Const        r110, true
L5:
  Const        r111, "key"
  // group by s.s_name into g
  Move         r112, r105
  // from s in supplier
  MakeMap      r115, 2, r109
L4:
  SetIndex     r9, r106, r115
  Const        r117, "items"
  Index        r118, r9, r106
  Index        r119, r118, r117
  Append       r120, r119, r103
  SetIndex     r118, r117, r120
  // join n in nation on n.n_nationkey == s.s_nationkey
  Jump         L10
  // join o in orders on o.o_orderkey == l1.l_orderkey
  Jump         L11
  // join l1 in lineitem on s.s_suppkey == l1.l_suppkey
  Jump         L12
  // from s in supplier
  Jump         L13
  Const        r129, 0
  Len          r130, r116
  Less         r131, r129, r130
  JumpIfFalse  r131, L14
L1:
  Jump         L1
L0:
  // sort by [ -count(g), g.key ]
  Sort         r157, r154
  // json(result)
  JSON         r157
  // expect result == [
  Const        r159, [{"numwait": 1, "s_name": "Desert Trade"}]
  Equal        r160, r157, r159
  Expect       r160
  Return       r0
