Letâ€™s proceed to **TPC-H Query 6**, which is the simplest query in the suite â€” no joins, just filtering and aggregation. Weâ€™ll write the **Mochi version with inline data and a test**.

---

## ðŸ§¾ TPC-H Query 6 â€” Forecasting Revenue Change

### âœ… **SQL Overview**

```sql
SELECT
  SUM(l_extendedprice * l_discount) AS revenue
FROM
  lineitem
WHERE
  l_shipdate >= DATE '1994-01-01'
  AND l_shipdate < DATE '1995-01-01'
  AND l_discount BETWEEN 0.05 AND 0.07
  AND l_quantity < 24;
```

### ðŸ§  Purpose

> Forecast revenue impact by selecting **discounted lineitems** in a date range, with **quantity filter** and discount bounds.

---

## ðŸ¦Š Mochi Version â€” Inline + Test

We simulate 4 lineitems â€” only 2 of which match the criteria.

### ðŸ§¾ **Mochi Code**

```mochi
let lineitem = [
  {
    l_extendedprice: 1000.0,
    l_discount: 0.06,
    l_shipdate: "1994-02-15",
    l_quantity: 10
  },
  {
    l_extendedprice: 500.0,
    l_discount: 0.07,
    l_shipdate: "1994-03-10",
    l_quantity: 23
  },
  {
    l_extendedprice: 400.0,
    l_discount: 0.04,
    l_shipdate: "1994-04-10",
    l_quantity: 15
  },
  {
    l_extendedprice: 200.0,
    l_discount: 0.06,
    l_shipdate: "1995-01-01", // outside range
    l_quantity: 5
  }
]

let result = from l in lineitem
  where
    l.l_shipdate >= "1994-01-01" and
    l.l_shipdate < "1995-01-01" and
    l.l_discount >= 0.05 and l.l_discount <= 0.07 and
    l.l_quantity < 24
  select sum(l.l_extendedprice * l.l_discount)

print result

test "Q6 calculates revenue from qualified lineitems" {
  expect result == 1000.0 * 0.06 + 500.0 * 0.07 // 60 + 35 = 95
}
```

---

### âœ… Explanation

| Lineitem | Match? | Reason            | Revenue            |
| -------- | ------ | ----------------- | ------------------ |
| 1        | âœ…      | All criteria      | 1000 Ã— 0.06 = 60.0 |
| 2        | âœ…      | All criteria      | 500 Ã— 0.07 = 35.0  |
| 3        | âŒ      | Discount too low  | â€”                  |
| 4        | âŒ      | Shipdate too late | â€”                  |

âœ… Final `SUM = 60.0 + 35.0 = 95.0`

---

Would you like to proceed to **Query 7**, which introduces multi-nation revenue with joins and grouping by nation pairs?
