let part = [
  { p_partkey: 1, p_brand: "Brand#12", p_container: "SM BOX", p_size: 3 },
  { p_partkey: 2, p_brand: "Brand#23", p_container: "MED BOX", p_size: 5 },
  { p_partkey: 3, p_brand: "Brand#34", p_container: "LG BOX", p_size: 15 }
]

let lineitem = [
  {
    l_partkey: 1, l_quantity: 5, l_extendedprice: 1000.0, l_discount: 0.1,
    l_shipmode: "AIR", l_shipinstruct: "DELIVER IN PERSON"
  },
  {
    l_partkey: 2, l_quantity: 15, l_extendedprice: 2000.0, l_discount: 0.05,
    l_shipmode: "AIR REG", l_shipinstruct: "DELIVER IN PERSON"
  },
  {
    l_partkey: 3, l_quantity: 35, l_extendedprice: 1500.0, l_discount: 0.0,
    l_shipmode: "AIR", l_shipinstruct: "DELIVER IN PERSON"
  }
]

let result =
  from l in lineitem
  join p in part on p.p_partkey == l.l_partkey
  where (
    (
      p.p_brand == "Brand#12" and
      p.p_container in ["SM CASE", "SM BOX", "SM PACK", "SM PKG"] and
      l.l_quantity >= 1 and l.l_quantity <= 11 and
      p.p_size >= 1 and p.p_size <= 5
    ) or (
      p.p_brand == "Brand#23" and
      p.p_container in ["MED BAG", "MED BOX", "MED PKG", "MED PACK"] and
      l.l_quantity >= 10 and l.l_quantity <= 20 and
      p.p_size >= 1 and p.p_size <= 10
    ) or (
      p.p_brand == "Brand#34" and
      p.p_container in ["LG CASE", "LG BOX", "LG PACK", "LG PKG"] and
      l.l_quantity >= 20 and l.l_quantity <= 30 and
      p.p_size >= 1 and p.p_size <= 15
    )
  )
  and l.l_shipmode in ["AIR", "AIR REG"]
  and l.l_shipinstruct == "DELIVER IN PERSON"
  select sum(l.l_extendedprice * (1 - l.l_discount))

print result

test "Q19 returns total revenue from qualifying branded parts" {
  // Matches:
  // Line 1: Brand#12 — 1000 * 0.9 = 900
  // Line 2: Brand#23 — 2000 * 0.95 = 1900
  // Line 3: Brand#34 — disqualified due to quantity (35 > 30)
  expect result == 2800.0
}
