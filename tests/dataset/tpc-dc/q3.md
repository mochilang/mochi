# TPC-DC Query 3

Query extracted from the official TPC-DS specification.

## SQL
```sql
--q3.sql--
[_LIMITA] select [_LIMITB] dt.d_year
      ,item.i_brand_id brand_id
      ,item.i_brand brand
      ,sum([AGGC]) sum_agg
 from  date_dim dt
      ,store_sales
      ,item
 where dt.d_date_sk = store_sales.ss_sold_date_sk
   and store_sales.ss_item_sk = item.i_item_sk
   and item.i_manufact_id = [MANUFACT]
   and dt.d_moy=[MONTH]
 group by dt.d_year
      ,item.i_brand
      ,item.i_brand_id
 order by dt.d_year
         ,sum_agg desc
         ,brand_id
 [_LIMITC];
```

## Expected Output
Aggregated brand totals from the simplified dataset.
```json
[
  {"i_brand":"Brand#2","sum_sales":100},
  {"i_brand":"Brand#1","sum_sales":50}
]
```
