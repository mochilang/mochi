# TPC-DC Query 52

Query extracted from the official TPC-DS specification.

## SQL
```sql
SELECT dt.d_year
        ,item.i_brand_id brand_id
        ,item.i_brand brand
        ,sum(ss_ext_sales_price) ext_price
 from date_dim dt, store_sales, item
 where dt.d_date_sk = store_sales.ss_sold_date_sk
    and store_sales.ss_item_sk = item.i_item_sk
    and item.i_manager_id = 1
    and dt.d_moy=1
    and dt.d_year=2000
 group by dt.d_year
        ,item.i_brand
        ,item.i_brand_id
 order by dt.d_year
        ,ext_price desc
        ,brand_id
LIMIT 100 ;
```

## Expected Output
Example result using the expanded dataset from `q52.mochi`:
```json
[
  {"d_year":2000, "brand_id":1, "brand":"BrandA", "ext_price":310},
  {"d_year":2000, "brand_id":3, "brand":"BrandC", "ext_price":115},
  {"d_year":2000, "brand_id":2, "brand":"BrandB", "ext_price":75}
]
```
