# TPC-DC Query 22

Query 22 averages inventory levels for each product and brand over a twelve
month span. The rollup clause in the original query also produces subtotals at
various levels of the product hierarchy.

## SQL
```sql
SELECT i_product_name,
       i_brand,
       i_class,
       i_category,
       AVG(inv_quantity_on_hand) AS qoh
FROM inventory, date_dim, item
WHERE inv_date_sk = d_date_sk
  AND inv_item_sk = i_item_sk
  AND d_month_seq BETWEEN 0 AND 11
GROUP BY ROLLUP(i_product_name, i_brand, i_class, i_category)
ORDER BY qoh, i_product_name, i_brand, i_class, i_category;
```

## Expected Output
With additional months of data the average quantity on hand for Prod1 is
18.33 while Prod2 averages 5 units.
```json
[
  { "i_product_name": "Prod1", "qoh": 18.333333333333332 },
  { "i_product_name": "Prod2", "qoh": 5.0 }
]
```
