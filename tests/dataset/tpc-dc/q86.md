# TPC-DC Query 86

Query extracted from the official TPC-DS specification.

## SQL
```sql
 define DMS = random(1176,1224,uniform);
 define _LIMIT=100; 
 [_LIMITA] select [_LIMITB]  
    sum(ws_net_paid) as total_sum
   ,i_category
   ,i_class
   ,grouping(i_category)+grouping(i_class) as lochierarchy
   ,rank() over (
 	partition by grouping(i_category)+grouping(i_class),
 	case when grouping(i_class) = 0 then i_category end 
 	order by sum(ws_net_paid) desc) as rank_within_parent
 from
    web_sales
   ,date_dim       d1
   ,item
 where
    d1.d_month_seq between [DMS] and [DMS]+11
 and d1.d_date_sk = ws_sold_date_sk
 and i_item_sk  = ws_item_sk
 group by rollup(i_category,i_class)
 order by
   lochierarchy desc,
   case when lochierarchy = 0 then i_category end,
   rank_within_parent
 [_LIMITC];

```

## Expected Output
Example using the small test dataset:
```json
[
  { "i_category": "CatA", "i_class": "ClassA", "total_sum": 70.0 },
  { "i_category": "CatA", "i_class": "ClassB", "total_sum": 60.0 }
]
```
