#!/usr/bin/env escript
-module(main).
-export([main/1]).
main(_) ->
  Code = "# Generated by Mochi Python compiler\nfrom __future__ import annotations\n\nimport dataclasses\nimport typing\n\n@dataclasses.dataclass\nclass Product:\n	name: str\n	price: int\n\nproducts = [Product(name=\"Laptop\", price=1500), Product(name=\"Smartphone\", price=900), Product(name=\"Tablet\", price=600), Product(name=\"Monitor\", price=300), Product(name=\"Keyboard\", price=100), Product(name=\"Mouse\", price=50), Product(name=\"Headphones\", price=200)]\nexpensive = None\n\ndef main():\n	products = [Product(name=\"Laptop\", price=1500), Product(name=\"Smartphone\", price=900), Product(name=\"Tablet\", price=600), Product(name=\"Monitor\", price=300), Product(name=\"Keyboard\", price=100), Product(name=\"Mouse\", price=50), Product(name=\"Headphones\", price=200)]\n	expensive = [ p for p in ((sorted([ p for p in products ], key=lambda p: (-p.price)))[1:])[:3] ]\n	print(\"--- Top products (excluding most expensive) ---\")\n	for item in expensive:\n		print(item.name, \"costs $\", item.price)\n\nif __name__ == \"__main__\":\n	main()\n",
  file:write_file('prog.py', Code),
  Out = os:cmd("python3 prog.py"),
  io:format("~s", [Out]).
