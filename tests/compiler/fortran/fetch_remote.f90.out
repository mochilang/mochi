program main
  implicit none
  type :: Todo
    integer(kind=8) :: userId
    integer(kind=8) :: id
    character(:), allocatable :: title
    logical :: completed
  end type Todo
  type(Todo) :: todo
  todo = mochi_fetch('https://jsonplaceholder.typicode.com/todos/1')
  print *, todo%id
contains

  function mochi_fetch(url) result(path)
    implicit none
    character(len=*), intent(in) :: url
    character(len=256) :: path
    character(len=1024) :: cmd
    path = 'mochi_fetch_tmp.json'
    cmd = 'curl -s ' // trim(url) // ' -o ' // trim(path)
    call execute_command_line(cmd)
  end function mochi_fetch
end program main
