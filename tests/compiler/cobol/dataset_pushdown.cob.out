>>SOURCE FORMAT FREE
IDENTIFICATION DIVISION.
PROGRAM-ID. MAIN.
DATA DIVISION.
WORKING-STORAGE SECTION.
01 A OCCURS 4 TIMES PIC 9.
01 B OCCURS 2 TIMES PIC 9.
01 X PIC 9.
01 Y PIC 9.
01 RES OCCURS 8 TIMES PIC 9.
01 TMP0 PIC 9.
01 TMP1 PIC 9.
01 IDX PIC 9.
01 IDX2 PIC 9.
PROCEDURE DIVISION.
    MOVE 0 TO A(1)
    MOVE 1 TO A(2)
    MOVE 2 TO A(3)
    MOVE 3 TO A(4)
    MOVE 10 TO B(1)
    MOVE 20 TO B(2)
    MOVE 0 TO TMP0
    MOVE 0 TO TMP1
    MOVE 0 TO IDX
    PERFORM VARYING IDX FROM 0 BY 1 UNTIL IDX >= 4
    MOVE A(IDX + 1) TO X
    IF X > 1
            MOVE 0 TO IDX2
            PERFORM VARYING IDX2 FROM 0 BY 1 UNTIL IDX2 >= 2
            MOVE B(IDX2 + 1) TO Y
            ADD 1 TO TMP1
            IF TMP1 > 0
                IF 0 = 0 OR TMP0 < 0
                    ADD 1 TO TMP0
                    COMPUTE RES(TMP0) = X + Y
                END-IF
            END-IF
        END-IF
        END-PERFORM
    END-PERFORM
    *> unsupported for-in loop
    STOP RUN.
