>>SOURCE FORMAT FREE
IDENTIFICATION DIVISION.
PROGRAM-ID. MAIN.
DATA DIVISION.
WORKING-STORAGE SECTION.
01 PEOPLE OCCURS 3 TIMES PIC 9.
01 TMP0_NAME PIC X(100).
01 TMP0_AGE PIC 9.
01 TMP1_NAME PIC X(100).
01 TMP1_AGE PIC 9.
01 TMP2_NAME PIC X(100).
01 TMP2_AGE PIC 9.
01 P PIC 9.
01 NAMES OCCURS 3 TIMES PIC 9.
01 TMP3 PIC 9.
01 TMP4 PIC 9.
01 IDX PIC 9.
PROCEDURE DIVISION.
    MOVE "Alice" TO TMP0_NAME
    COMPUTE TMP0_AGE = 30
    MOVE TMP0 TO PEOPLE(1)
    MOVE "Bob" TO TMP1_NAME
    COMPUTE TMP1_AGE = 15
    MOVE TMP1 TO PEOPLE(2)
    MOVE "Charlie" TO TMP2_NAME
    COMPUTE TMP2_AGE = 65
    MOVE TMP2 TO PEOPLE(3)
    MOVE 0 TO TMP3
    MOVE 0 TO TMP4
    MOVE 0 TO IDX
    PERFORM VARYING IDX FROM 0 BY 1 UNTIL IDX >= 3
    MOVE PEOPLE(IDX + 1) TO P
    IF P_AGE >= 18
        ADD 1 TO TMP4
        IF TMP4 > 0
            IF 0 = 0 OR TMP3 < 0
                ADD 1 TO TMP3
                COMPUTE NAMES(TMP3) = P_NAME
            END-IF
        END-IF
    END-IF
    END-PERFORM
    *> unsupported for-in loop
    STOP RUN.
