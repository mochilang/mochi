>>SOURCE FORMAT FREE
IDENTIFICATION DIVISION.
PROGRAM-ID. MAIN.

DATA DIVISION.
WORKING-STORAGE SECTION.
01 TMP0 OCCURS 4 TIMES PIC 9.
01 X PIC 9.
01 XS OCCURS 4 TIMES PIC 9.
01 TMP1 PIC 9.
01 TMP2 PIC 9.
01 IDX PIC 9.
01 TMP3 PIC S9.
01 TMP4 PIC 9.

PROCEDURE DIVISION.
    MOVE 1 TO TMP0(1)
    MOVE 2 TO TMP0(2)
    MOVE 3 TO TMP0(3)
    MOVE 4 TO TMP0(4)
    MOVE 0 TO TMP1
    MOVE 0 TO TMP2
    MOVE 0 TO IDX
    PERFORM VARYING IDX FROM 0 BY 1 UNTIL IDX >= 4
    MOVE TMP0(IDX + 1) TO X
    IF X > 2
        ADD 1 TO TMP2
        IF TMP2 > 0
            IF 0 = 0 OR TMP1 < 0
                ADD 1 TO TMP1
                COMPUTE XS(TMP1) = X
            END-IF
        END-IF
    END-IF
    END-PERFORM
    MOVE -1 TO TMP3
    IF TMP3 < 0
    ADD 4 TO TMP3
    END-IF
    COMPUTE TMP4 = XS(TMP3 + 1)
    DISPLAY TMP4
    STOP RUN.
