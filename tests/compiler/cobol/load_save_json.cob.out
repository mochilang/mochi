>>SOURCE FORMAT FREE
IDENTIFICATION DIVISION.
PROGRAM-ID. MAIN.

DATA DIVISION.
WORKING-STORAGE SECTION.
01 PEOPLE OCCURS 0 TIMES PIC 9.
01 P PIC 9.
01 ADULTS OCCURS 0 TIMES PIC 9.
01 TMP0 PIC 9.
01 TMP1 PIC 9.
01 IDX PIC 9.

PROCEDURE DIVISION.
    *> load json not implemented
    MOVE 0 TO TMP0
    MOVE 0 TO TMP1
    MOVE 0 TO IDX
    PERFORM VARYING IDX FROM 0 BY 1 UNTIL IDX >= 0
    MOVE PEOPLE(IDX + 1) TO P
    IF P_AGE >= 18
        ADD 1 TO TMP1
        IF TMP1 > 0
            IF 0 = 0 OR TMP0 < 0
                ADD 1 TO TMP0
                COMPUTE ADULTS(TMP0) = P
            END-IF
        END-IF
    END-IF
    END-PERFORM
*> save json not implemented
    STOP RUN.
