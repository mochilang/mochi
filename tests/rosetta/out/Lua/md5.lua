-- Generated by Mochi compiler v0.10.26 on 2025-07-16T10:11:50Z
function __eq(a, b)
    if type(a) ~= type(b) then return false end
    if type(a) == 'number' then return math.abs(a-b) < 1e-9 end
    if type(a) ~= 'table' then return a == b end
    if (a[1] ~= nil or #a > 0) and (b[1] ~= nil or #b > 0) then
        if #a ~= #b then return false end
        for i = 1, #a do if not __eq(a[i], b[i]) then return false end end
        return true
    end
    for k, v in pairs(a) do if not __eq(v, b[k]) then return false end end
    for k, _ in pairs(b) do if a[k] == nil then return false end end
    return true
end
function __index(obj, i)
    if type(obj) == 'string' then
        return __indexString(obj, i)
    elseif type(obj) == 'table' then
        if obj[1] ~= nil or #obj > 0 then
            return obj[(i)+1]
        else
            return obj[i]
        end
    else
        error('cannot index')
    end
end
function __indexString(s, i)
    local len = #s
    if i < 0 then
        i = len + i + 1
    else
        i = i + 1
    end
    if i < 1 or i > len then error('index out of range') end
    return string.sub(s, i, i)
end
local testpkg = {
    Add = function(a,b) return a + b end,
    Pi = 3.14,
    Answer = 42,
    MD5Hex = function(s)
        local tmp = os.tmpname()
        local f = assert(io.open(tmp, 'wb')); f:write(s); f:close()
        local p = assert(io.popen('openssl md5 '..tmp, 'r'))
        local out = p:read('*a'); p:close(); os.remove(tmp)
        return string.match(out, '= ([a-f0-9]+)')
    end,
    FifteenPuzzleExample = function()
        return 'Solution found in 52 moves: rrrulddluuuldrurdddrullulurrrddldluurddlulurruldrdrd'
    end,
}
for _, pair in ipairs({{"d41d8cd98f00b204e9800998ecf8427e", ""}, {"0cc175b9c0f1b6a831c399e269772661", "a"}, {"900150983cd24fb0d6963f7d28e17f72", "abc"}, {"f96b697d7cb7938d525a2f31aaf161d0", "message digest"}, {"c3fcd3d76192e4007dfb496cca67e13b", "abcdefghijklmnopqrstuvwxyz"}, {"d174ab98d277d9f5a5611c2c9f419d9f", "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789"}, {"57edf4a22be3c955ac49da2e2107b67a", ("12345678901234567890" .. "123456789012345678901234567890123456789012345678901234567890")}, {"e38ca1d920c4b8b8d3946b2c72f01680", "The quick brown fox jumped over the lazy dog's back"}}) do
    local sum = testpkg.MD5Hex(__index(pair, 1))
    if not __eq(sum, __index(pair, 0)) then
        print("MD5 fail")
        print(tostring("  for string,") .. " " .. tostring(__index(pair, 1)))
        print(tostring("  expected:  ") .. " " .. tostring(__index(pair, 0)))
        print(tostring("  got:       ") .. " " .. tostring(sum))
    end
end
