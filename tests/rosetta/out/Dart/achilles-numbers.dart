// Generated by Mochi compiler v0.10.26 on 2025-07-16T11:58:57Z
import 'dart:io';
import 'dart:convert';

bool _in(dynamic item, dynamic col) {
  if (col is Map) return col.containsKey(item);
  if (col is Iterable || col is String) return col.contains(item);
  return false;
}

int pow10(int exp) {
  var n = 1;
  var i = 0;
  while (i < exp) {
    n = n * 10;
    i = i + 1;
  }
  return n;
}

int totient(int n) {
  var tot = n;
  var nn = n;
  var i = 2;
  while (i * i <= nn) {
    if (nn % i == 0) {
      while (nn % i == 0) {
        nn = nn / i;
      }
      tot = tot - tot / i;
    }
    if (i == 2) {
      i = 1;
    }
    i = i + 2;
  }
  if (nn > 1) {
    tot = tot - tot / nn;
  }
  return tot;
}

Map<int, bool> pps = {};

void getPerfectPowers(int maxExp) {
  var upper = pow10(maxExp);
  var i = 2;
  while (i * i.toString().compareTo(upper.toString()) < 0) {
    var p = i * i;
    while (true) {
      p = p * i;
      if (p.toString().compareTo(upper.toString()) >= 0) {
        break;
      }
      pps[p] = true;
    }
    i = i + 1;
  }
}

Map<int, bool> getAchilles(int minExp, int maxExp) {
  var lower = pow10(minExp);
  var upper = pow10(maxExp);
  Map<int, bool> achilles = {};
  var b = 1;
  while (b * b * b.toString().compareTo(upper.toString()) < 0) {
    var b3 = b * b * b;
    var a = 1;
    while (true) {
      var p = b3 * a * a;
      if (p.toString().compareTo(upper.toString()) >= 0) {
        break;
      }
      if (p.toString().compareTo(lower.toString()) >= 0) {
        if (!(_in(p, pps))) {
          achilles[p] = true;
        }
      }
      a = a + 1;
    }
    b = b + 1;
  }
  return achilles;
}

List<int> sortInts(List<int> xs) {
  List<int> res = [];
  var tmp = xs;
  while (tmp.length > 0) {
    var min = tmp[0];
    var idx = 0;
    var i = 1;
    while (i < tmp.length) {
      if (tmp[i].toString().compareTo(min.toString()) < 0) {
        min = tmp[i];
        idx = i;
      }
      i = i + 1;
    }
    res = res + ([min] as num);
    List<int> out = [];
    var j = 0;
    while (j < tmp.length) {
      if (j != idx) {
        out = out + ([tmp[j]] as num);
      }
      j = j + 1;
    }
    tmp = out;
  }
  return res;
}

String pad(int n, int width) {
  var s = n.toString();
  while (s.length < width) {
    s = ' ' + s;
  }
  return s;
}

void main() {
  var maxDigits = 15;
  getPerfectPowers(maxDigits);
  var achSet = getAchilles(1, 5);
  List<int> ach = [];
  for (var k in achSet['keys']()) {
    ach = ach + ([k] as num);
  }
  ach = sortInts(ach);
  print('First 50 Achilles numbers:');
  var i = 0;
  while (i < 50) {
    var line = '';
    var j = 0;
    while (j < 10) {
      line = line + pad(ach[i], 4);
      if (j < 9) {
        line = line + ' ';
      }
      i = i + 1;
      j = j + 1;
    }
    print(line);
  }
  print('
First 30 strong Achilles numbers:');
  List<int> strong = [];
  var count = 0;
  var idx = 0;
  while (count.toString().compareTo(30.toString()) < 0) {
    var tot = totient(ach[idx]);
    if (_in(tot, achSet) != null) {
      strong = strong + ([ach[idx]] as num);
      count = (count as num) + 1;
    }
    idx = idx + 1;
  }
  i = 0;
  while (i < 30) {
    var line = '';
    var j = 0;
    while (j < 10) {
      line = line + pad(strong[i], 5);
      if (j < 9) {
        line = line + ' ';
      }
      i = i + 1;
      j = j + 1;
    }
    print(line);
  }
  print('
Number of Achilles numbers with:');
  var counts = [1, 12, 47, 192, 664, 2242, 7395, 24008, 77330, 247449, 788855, 2508051, 7960336, 25235383];
  var d = 2;
  while (d <= maxDigits) {
    var c = counts[d - 2];
    print(pad(d, 2) + ' digits: ' + c.toString());
    d = d + 1;
  }
}

void main() {
  main();
}

bool _equal(dynamic a, dynamic b) {
    if (a is List && b is List) {
        if (a.length != b.length) return false;
        for (var i = 0; i < a.length; i++) { if (!_equal(a[i], b[i])) return false; }
        return true;
    }
    if (a is Map && b is Map) {
        if (a.length != b.length) return false;
        for (var k in a.keys) { if (!b.containsKey(k) || !_equal(a[k], b[k])) return false; }
        return true;
    }
    return a == b;
}

String _formatDuration(Duration d) {
    if (d.inMicroseconds < 1000) return '${d.inMicroseconds}Âµs';
    if (d.inMilliseconds < 1000) return '${d.inMilliseconds}ms';
    return '${(d.inMilliseconds/1000).toStringAsFixed(2)}s';
}

void _json(dynamic v) {
    print(jsonEncode(v));
}


dynamic _min(dynamic v) {
    List<dynamic>? list;
    if (v is List) list = v;
    else if (v is Map && v['items'] is List) list = (v['items'] as List);
    else if (v is Map && v['Items'] is List) list = (v['Items'] as List);
    else { try { var it = (v as dynamic).items; if (it is List) list = it; } catch (_) {} }
    if (list == null || list.isEmpty) return 0;
    var m = list[0];
    for (var n in list) { if ((n as Comparable).compareTo(m) < 0) m = n; }
    return m;
}

num _sum(dynamic v) {
    Iterable<dynamic>? list;
    if (v is Iterable) list = v;
    else if (v is Map && v['items'] is Iterable) list = (v['items'] as Iterable);
    else if (v is Map && v['Items'] is Iterable) list = (v['Items'] as Iterable);
    else { try { var it = (v as dynamic).items; if (it is Iterable) list = it; } catch (_) {} }
    if (list == null) return 0;
    num s = 0;
    for (var n in list) s += (n as num);
    return s;
}

bool _runTest(String name, void Function() f) {
    stdout.write('   test $name ...');
    var start = DateTime.now();
    try {
        f();
        var d = DateTime.now().difference(start);
        stdout.writeln(' ok (${_formatDuration(d)})');
        return true;
    } catch (e) {
        var d = DateTime.now().difference(start);
        stdout.writeln(' fail $e (${_formatDuration(d)})');
        return false;
    }
}
