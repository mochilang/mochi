#!/usr/bin/env escript
% Generated by Mochi compiler v0.10.26 on 2025-07-16T09:59:10Z
% abc-problem.erl - generated from abc-problem.mochi

fields(S) ->
    Res0 = [],
    Cur0 = "",
    I0 = 0,
    (fun Loop0(I) -> case (I < length(S)) of true -> C = string:substr(S, (I)+1, ((I + 1))-(I)), (case (C == " ") of true -> (case (length(Cur0) > 0) of true -> Res1 = Res0 ++ [Cur0], Cur1 = ""; _ -> ok end); _ -> Cur2 = (Cur1 + C) end), I1 = (I + 1), Loop0(I1); _ -> ok end end(I0)),
    (case (length(Cur2) > 0) of true -> Res2 = Res1 ++ [Cur2]; _ -> ok end),
    Res2.

canSpell(Word, Blks) ->
    (case (length(Word) == 0) of true -> true; _ -> ok end),
    C = lower(string:substr(Word, (0)+1, (1)-(0))),
    I2 = 0,
    (fun Loop2(I) -> case (I < length(Blks)) of true -> B = lists:nth((I)+1, Blks), (case ((C == lower(lists:sublist(B, (0)+1, (1)-(0)))) orelse (C == lower(lists:sublist(B, (1)+1, (2)-(1))))) of true -> Rest0 = [], J0 = 0, (fun Loop1(J) -> case (J < length(Blks)) of true -> (case (J /= I) of true -> Rest1 = Rest0 ++ [lists:nth((J)+1, Blks)]; _ -> ok end), J1 = (J + 1), Loop1(J1); _ -> ok end end(J0)), (case canSpell(string:substr(Word, (1)+1, (length(Word))-(1)), Rest1) of undefined -> ok; false -> ok; _ -> true end); _ -> ok end), I3 = (I + 1), Loop2(I3); _ -> ok end end(I2)),
    false.

newSpeller(Blocks) ->
    Bl = fields(Blocks),
    fun(W) -> canSpell(W, Bl) end.

main() ->
    Sp = newSpeller("BO XK DQ CP NA GT RE TG QD FS JW HU VI AN OB ER FS LY PC ZM"),
    lists:foreach(fun(Word) -> io:format("~p~n", [Word ++ " " ++ lists:flatten(io_lib:format("~p", [Sp(Word)]))]) end, ["A", "BARK", "BOOK", "TREAT", "COMMON", "SQUAD", "CONFUSE"]).

main(_) ->
    main().
