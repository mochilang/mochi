! Generated by Mochi compiler v0.10.26 on 2025-07-16T09:28:40Z
program checkpoint_synchronization_4
  implicit none
  integer :: nMech
  integer :: detailsPerMech
  integer :: mech
    integer :: id
    character(len=100) :: s0
    character(len=100) :: s1
    character(len=100) :: s2
    integer :: d
      character(len=100) :: s3
      character(len=100) :: s4
    character(len=100) :: s5
    character(len=100) :: s6
  nMech = 5
  detailsPerMech = 4
  do mech = 1, ((nMech + 1))
    id = mech
    write(s0,'(G0)') id
    write(s1,'(G0)') detailsPerMech
    print *, trim(trim(trim('worker ' // s0) // ' contracted to assemble ') // s1) // ' details'
    write(s2,'(G0)') id
    print *, trim('worker ' // s2) // ' enters shop'
    d = 0
    do while ((d < detailsPerMech))
      write(s3,'(G0)') id
      print *, trim('worker ' // s3) // ' assembling'
      write(s4,'(G0)') id
      print *, trim('worker ' // s4) // ' completed detail'
      d = (d + 1)
    end do
    write(s5,'(G0)') id
    print *, trim('worker ' // s5) // ' leaves shop'
    write(s6,'(G0)') mech
    print *, trim('mechanism ' // s6) // ' completed'
  end do
end program checkpoint_synchronization_4
