! Generated by Mochi compiler v0.10.26 on 2006-01-02T15:04:05Z
program archimedean_spiral
  implicit none
  real :: PI
  real :: degreesIncr
  real :: turns
  real :: stop
  real :: width
  real :: centre
  real :: a
  real :: b
  real :: theta
  integer :: count
    real :: r
    integer :: x
    integer :: y
      character(len=100) :: s0
      character(len=100) :: s1
    integer :: term
    integer :: sum
    integer :: n
      integer :: denom
  PI = 3.141592653589793
  degreesIncr = ((0.1 * PI) / 180)
  turns = 2
  stop = (((360 * turns) * 10) * degreesIncr)
  width = 600
  centre = (width / 2)
  a = 1
  b = 20
  theta = 0
  count = 0
  do while ((theta < stop))
    r = ((a + b) * theta)
    x = (r * cosApprox(theta))
    y = (r * sinApprox(theta))
    if ((mod(count,100) == 0)) then
      write(s0,'(G0)') (centre + x)
      write(s1,'(G0)') (centre - y)
      print *, trim(s0 // ',') // s1
    end if
    theta = (theta + degreesIncr)
    count = (count + 1)
  end do
  contains
  recursive real function sinApprox(x) result(res)
    real, intent(in) :: x
    term = x
    sum = x
    n = 1
    do while ((n <= 10))
      denom = real(((((2 * n)) * (((2 * n) + 1)))))
      term = (((-term * x) * x) / denom)
      sum = (sum + term)
      n = (n + 1)
    end do
    res = sum
    return
  end function sinApprox
  recursive real function cosApprox(x) result(res)
    real, intent(in) :: x
    term = 1
    sum = 1
    n = 1
    do while ((n <= 10))
      denom = real((((((2 * n) - 1)) * ((2 * n)))))
      term = (((-term * x) * x) / denom)
      sum = (sum + term)
      n = (n + 1)
    end do
    res = sum
    return
  end function cosApprox
end program archimedean_spiral
