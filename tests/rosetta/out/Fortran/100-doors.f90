! Generated by Mochi compiler v0.10.26 on 2006-01-02T15:04:05Z
program p_100_doors
  implicit none
  logical, allocatable, dimension(:) :: doors
  integer :: i
    logical, allocatable, dimension(:) :: app0
  integer :: pass
    integer :: idx
  integer :: row
    character(len=100) :: line
    integer :: col
  allocate(doors(0))
  do i = 0, 100
    if (allocated(app0)) deallocate(app0)
    allocate(app0(size(doors)+1))
    app0(1:size(doors)) = doors
    app0(size(doors)+1) = .false.
    doors = app0
  end do
  do pass = 1, 101
    idx = (pass - 1)
    do while ((idx < 100))
      doors(((idx)+1)) = .not. doors(((idx)+1))
      idx = (idx + pass)
    end do
  end do
  do row = 0, 10
    line = ''
    do col = 0, 10
      idx = ((row * 10) + col)
      if (doors(((idx)+1))) then
        line = line // '1'
      else
        line = line // '0'
      end if
      if ((col < 9)) then
        line = line // ' '
      end if
    end do
    print *, line
  end do
end program p_100_doors
