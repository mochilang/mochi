// Generated by Mochi compiler v0.10.30 on 2025-07-18T17:22:32Z
using System;
using System.Collections.Generic;

class Program
{
    static List<List<int>> newPile(int d)
    {
        List<List<int>> b = new List<List<int>>();
        int y = 0;
        while (y < d)
        {
            List<int> row = new List<int>();
            int x = 0;
            while (x < d)
            {
                row = new List<int>(row) { 0 };
                x = (x + 1);
            }
            b = new List<List<int>>(b) { row };
            y = (y + 1);
        }
        return b;
    }

    static List<List<int>> handlePile(List<List<int>> pile, int x, int y)
    {
        if (pile[(int)y][(int)x] >= 4)
        {
            pile[(int)y][(int)x] = (pile[(int)y][(int)x] - 4);
            if (y > 0)
            {
                pile[(int)(y - 1)][(int)x] = (pile[(int)(y - 1)][(int)x] + 1);
                if (pile[(int)(y - 1)][(int)x] >= 4)
                {
                    pile = handlePile(pile, x, (y - 1));
                }
            }
            if (x > 0)
            {
                pile[(int)y][(int)(x - 1)] = (pile[(int)y][(int)(x - 1)] + 1);
                if (pile[(int)y][(int)(x - 1)] >= 4)
                {
                    pile = handlePile(pile, (x - 1), y);
                }
            }
            if (y < (dim - 1))
            {
                pile[(int)(y + 1)][(int)x] = (pile[(int)(y + 1)][(int)x] + 1);
                if (pile[(int)(y + 1)][(int)x] >= 4)
                {
                    pile = handlePile(pile, x, (y + 1));
                }
            }
            if (x < (dim - 1))
            {
                pile[(int)y][(int)(x + 1)] = (pile[(int)y][(int)(x + 1)] + 1);
                if (pile[(int)y][(int)(x + 1)] >= 4)
                {
                    pile = handlePile(pile, (x + 1), y);
                }
            }
            pile = handlePile(pile, x, y);
        }
        return pile;
    }

    static void drawPile(List<List<int>> pile, int d)
    {
        List<string> chars = new List<string> { " ", "░", "▓", "█" };
        int row = 0;
        while (row < d)
        {
            string line = "";
            int col = 0;
            while (col < d)
            {
                int v = pile[(int)row][(int)col];
                if (v > 3)
                {
                    v = 3;
                }
                line = (line + chars[(int)v]);
                col = (col + 1);
            }
            Console.WriteLine(line);
            row = (row + 1);
        }
    }

    static void main()
    {
        List<List<int>> pile = newPile(16);
        int hdim = 7;
        pile[(int)hdim][(int)hdim] = 16;
        pile = handlePile(pile, hdim, hdim);
        drawPile(pile, 16);
    }

    static void Main()
    {
        int dim = 16;
        main();
    }
}
