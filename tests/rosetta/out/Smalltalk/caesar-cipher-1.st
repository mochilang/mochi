" Generated by Mochi compiler v0.10.30 on 2006-01-02T15:04:05Z
"
| indexOf i ord upper lower idx chr shiftRune encipher out decipher main pt key ct |
Object subclass: #ContinueSignal instanceVariableNames: '' classVariableNames: '' poolDictionaries: '' category: nil!.
indexOf := [:s :ch | i := 0.
[(i < ((s size)))] whileTrue: [.
((((s copyFrom: i to: (i + 1))) = ch)) ifTrue: [
i.
] .
i := (i + 1).
].
.
-1. ].
ord := [:ch | upper := 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.
lower := 'abcdefghijklmnopqrstuvwxyz'.
idx := indexOf value: upper value: ch.
((idx >= 0)) ifTrue: [
(65 + idx).
] .
idx := indexOf value: lower value: ch.
((idx >= 0)) ifTrue: [
(97 + idx).
] .
0. ].
chr := [:n | upper := 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.
lower := 'abcdefghijklmnopqrstuvwxyz'.
((((n >= 65)) and: [((n < 91))])) ifTrue: [
upper copyFrom: ((n - 65) + 1) to: (n - 64).
] .
((((n >= 97)) and: [((n < 123))])) ifTrue: [
lower copyFrom: ((n - 97) + 1) to: (n - 96).
] .
'?'. ].
shiftRune := [:r :k | ((((r >= 'a')) and: [((r <= 'z'))])) ifTrue: [
chr value: ((((((((ord value: r) - 97)) + k)) % 26)) + 97).
] .
((((r >= 'A')) and: [((r <= 'Z'))])) ifTrue: [
chr value: ((((((((ord value: r) - 65)) + k)) % 26)) + 65).
] .
r. ].
encipher := [:s :k | out := ''.
i := 0.
[(i < ((s size)))] whileTrue: [.
out := (out + (shiftRune value: s copyFrom: (i + 1) to: (i + 1) value: k)).
i := (i + 1).
].
.
out. ].
decipher := [:s :k | encipher value: s value: (((26 - ((k % 26)))) % 26). ].
main := [ pt := 'The five boxing wizards jump quickly'.
Transcript show: ((('Plaintext: ') + pt)) printString; cr.
[.
{0. 1. 7. 25. 26} do: [:key |.
[.
((((key < 1)) or: [((key > 25))])) ifTrue: [
Transcript show: ((((('Key ') + ((key asString)))) + (' invalid'))) printString; cr.
ContinueSignal signal.
] .
ct := encipher value: pt value: key.
Transcript show: ((('Key ') + ((key asString)))) printString; cr.
Transcript show: ((('  Enciphered: ') + ct)) printString; cr.
Transcript show: ((('  Deciphered: ') + (decipher value: ct value: key))) printString; cr.
] on: ContinueSignal do: [:ex | ].
].
] on: BreakSignal do: [:ex | ]. ].
main value.
