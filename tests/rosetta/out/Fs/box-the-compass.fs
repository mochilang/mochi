// Generated by Mochi compiler v0.10.26 on 2006-01-02T15:04:05Z
open System

let padLeft (s) (w) =
    let mutable res: string = ""
    let mutable n: obj = w - List.length s
    while n > 0 do
        res <- res + " "
        n <- n - 1
    res + s
let padRight (s) (w) =
    let mutable out: obj = s
    let mutable i: obj = List.length s
    while i < w do
        out <- out + " "
        i <- i + 1
    out
let indexOf (s) (ch) =
    let mutable i: int = 0
    while i < List.length s do
        if s.Substring(i, i + 1 - i) = ch then
            i
        i <- i + 1
    -1
let format2 (f) =
    let mutable s: obj = string f
    let idx: obj = indexOf s "."
    if idx < 0 then
        s <- s + ".00"
    else
        let mutable need: obj = idx + 3
        if List.length s > need then
            s <- s.Substring(0, need - 0)
        else
            while List.length s < need do
                s <- s + "0"
    s
let cpx (h) =
    let mutable x: obj = ((h / 11.25) + 0.5)
    x <- x % 32
    if x < 0 then
        x <- x + 32
    x
let compassPoint: string list = ["North"; "North by east"; "North-northeast"; "Northeast by north"; "Northeast"; "Northeast by east"; "East-northeast"; "East by north"; "East"; "East by south"; "East-southeast"; "Southeast by east"; "Southeast"; "Southeast by south"; "South-southeast"; "South by east"; "South"; "South by west"; "South-southwest"; "Southwest by south"; "Southwest"; "Southwest by west"; "West-southwest"; "West by south"; "West"; "West by north"; "West-northwest"; "Northwest by west"; "Northwest"; "Northwest by north"; "North-northwest"; "North by west"]
let degrees2compasspoint (h) =
    compassPoint.[cpx h]
let headings: float list = [0.0; 16.87; 16.88; 33.75; 50.62; 50.63; 67.5; 84.37; 84.38; 101.25; 118.12; 118.13; 135.0; 151.87; 151.88; 168.75; 185.62; 185.63; 202.5; 219.37; 219.38; 236.25; 253.12; 253.13; 270.0; 286.87; 286.88; 303.75; 320.62; 320.63; 337.5; 354.37; 354.38]
printfn "%s" "Index  Compass point         Degree"
let mutable i: int = 0
while i < List.length headings do
    let h: float list = headings.[i]
    let idx: int = i % 32 + 1
    let cp: obj = degrees2compasspoint h
    printfn "%A" (padLeft string idx 4 + "   " + padRight cp 19 + " " + format2 h + "Â°")
    i <- i + 1
