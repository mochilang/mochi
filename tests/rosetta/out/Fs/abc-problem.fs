// Generated by Mochi compiler v0.10.26 on 2006-01-02T15:04:05Z
open System

let fields (s) =
    let mutable res: obj = [||]
    let mutable cur: string = ""
    let mutable i: int = 0
    while i < List.length s do
        let c: obj = s.[i..(i + 1-1)]
        if c = " " then
            if List.length cur > 0 then
                res <- res @ [cur]
                cur <- ""
        else
            cur <- cur + c
        i <- i + 1
    if List.length cur > 0 then
        res <- res @ [cur]
    res
let canSpell (word) (blks) =
    if List.length word = 0 then
        true
    let c: obj = lower word.[0..(1-1)]
    let mutable i: int = 0
    while i < List.length blks do
        let b: obj = blks.[i]
        if c = lower b.[0..(1-1)] || c = lower b.[1..(2-1)] then
            let mutable rest: obj = [||]
            let mutable j: int = 0
            while j < List.length blks do
                if j <> i then
                    rest <- rest @ [blks.[j]]
                j <- j + 1
            if canSpell word.[1..] rest then
                true
        i <- i + 1
    false
let newSpeller (blocks) =
    let bl: obj = fields blocks
    fun w -> canSpell w bl
let main () =
    let sp: obj = newSpeller "BO XK DQ CP NA GT RE TG QD FS JW HU VI AN OB ER FS LY PC ZM"
    for word in ["A"; "BARK"; "BOOK"; "TREAT"; "COMMON"; "SQUAD"; "CONFUSE"] do
        printfn "%A" (word + " " + string sp word)
printfn "%A" (main())
