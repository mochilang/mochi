// Generated by Mochi compiler v0.10.26 on 2006-01-02T15:04:05Z
open System

let listStr (xs) =
    let mutable s: string = "["
    let mutable i: int = 0
    while i < List.length xs do
        s <- s + string xs.[i]
        if i < List.length xs - 1 then
            s <- s + " "
        i <- i + 1
    s <- s + "]"
    s
let llStr (lst) =
    let mutable s: string = "["
    let mutable i: int = 0
    while i < List.length lst do
        s <- s + listStr lst.[i]
        if i < List.length lst - 1 then
            s <- s + " "
        i <- i + 1
    s <- s + "]"
    s
let copy (xs) =
    let mutable out: obj = [||]
    for v in xs do
        out <- out @ [v]
    out
let cartN (lists) =
    if lists = () then
        []
    let a: obj = lists
    if List.length a = 0 then
        [[]]
    let mutable out: obj = [||]
    let last: obj = List.length a - 1
    let left: obj = cartN a.[0..(last-1)]
    for p in left do
        for x in a.[last] do
            let mutable row: obj = copy p
            row <- row @ [x]
            out <- out @ [row]
    out
let main () =
    printfn "%A" (llStr cartN [[1; 2]; [3; 4]])
    printfn "%A" (llStr cartN [[3; 4]; [1; 2]])
    printfn "%A" (llStr cartN [[1; 2]; []])
    printfn "%A" (llStr cartN [[]; [1; 2]])
    printfn "%s" ""
    printfn "%s" "["
    for p in cartN [[1776; 1789]; [7; 12]; [4; 14; 23]; [0; 1]] do
        printfn "%s" (" " + listStr p)
    printfn "%s" "]"
    printfn "%A" (llStr cartN [[1; 2; 3]; [30]; [500; 100]])
    printfn "%A" (llStr cartN [[1; 2; 3]; []; [500; 100]])
    printfn "%s" ""
    printfn "%A" (llStr cartN ())
    printfn "%A" (llStr cartN [])
printfn "%A" (main())
