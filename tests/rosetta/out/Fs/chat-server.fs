// Generated by Mochi compiler v0.10.26 on 2006-01-02T15:04:05Z
open System

let removeName (names) (name) =
    let mutable out: obj = [||]
    for n in names do
        if n <> name then
            out <- out @ [n]
    out
let main () =
    let mutable clients: obj = [||]
    let broadcast (msg) =
        printfn "%A" msg
    let add (name) =
        clients <- clients @ [name]
        printfn "%A" (broadcast "+++ \"" + name + "\" connected +++\n")
    let send (name) (msg) =
        printfn "%A" (broadcast name + "> " + msg + "\n")
    let remove (name) =
        clients <- removeName clients name
        printfn "%A" (broadcast "--- \"" + name + "\" disconnected ---\n")
    printfn "%A" (add "Alice")
    printfn "%A" (add "Bob")
    printfn "%A" (send "Alice" "Hello Bob!")
    printfn "%A" (send "Bob" "Hi Alice!")
    printfn "%A" (remove "Bob")
    printfn "%A" (remove "Alice")
    printfn "%A" (broadcast "Server stopping!\n")
printfn "%A" (main())
