// Generated by Mochi compiler v0.10.26 on 2006-01-02T15:04:05Z
open System

exception Break
exception Continue

let sameDigits (n) (b) =
    let mutable f: obj = n % b
    n <- (n / b)
    while n > 0 do
        if n % b <> f then
            false
        n <- (n / b)
    true
let isBrazilian (n) =
    if n < 7 then
        false
    if n % 2 = 0 && n >= 8 then
        true
    let mutable b: int = 2
    while b < n - 1 do
        if sameDigits n b then
            true
        b <- b + 1
    false
let isPrime (n) =
    if n < 2 then
        false
    if n % 2 = 0 then
        n = 2
    if n % 3 = 0 then
        n = 3
    let mutable d: int = 5
    while d * d <= n do
        if n % d = 0 then
            false
        d <- d + 2
        if n % d = 0 then
            false
        d <- d + 4
    true
let main () =
    let mutable kinds: string list = [|" "; " odd "; " prime "|]
    try
        for kind in kinds do
            try
                printfn "%s" "First 20" + kind + "Brazilian numbers:"
                let mutable c: int = 0
                let mutable n: int = 7
                try
                    while true do
                        try
                            if isBrazilian n then
                                printfn "%A" (string n + " ")
                                c <- c + 1
                                if c = 20 then
                                    printfn "%s" "\n"
                                    raise Break
                            if kind = " " then
                                n <- n + 1
                        with Continue -> ()
                with Break -> ()
            with Continue -> ()
        with Break -> ()
        let mutable n: int = 7
        let mutable c: int = 0
        while c < 100000 do
            if isBrazilian n then
                c <- c + 1
            n <- n + 1
        printfn "%s" ("The 100,000th Brazilian number: " + string n - 1)
    printfn "%A" (main())
