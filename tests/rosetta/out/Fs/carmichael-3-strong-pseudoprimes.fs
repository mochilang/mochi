// Generated by Mochi compiler v0.10.26 on 2006-01-02T15:04:05Z
open System

exception Break
exception Continue

let mod (n) (m) =
    ((n % m) + m) % m
let isPrime (n) =
    if n < 2 then
        false
    if n % 2 = 0 then
        n = 2
    if n % 3 = 0 then
        n = 3
    let mutable d: int = 5
    while d * d <= n do
        if n % d = 0 then
            false
        d <- d + 2
        if n % d = 0 then
            false
        d <- d + 4
    true
let pad (n) (width) =
    let mutable s: obj = string n
    while List.length s < width do
        s <- " " + s
    s
let carmichael (p1) =
    try
        for h3 in 2 .. p1 do
            try
                try
                    for d in 1 .. (h3 + p1) do
                        try
                            if ((h3 + p1) * (p1 - 1)) % d = 0 && mod -p1 * p1 h3 = d % h3 then
                                let p2: int = 1 + ((p1 - 1) * (h3 + p1) / d)
                                if not isPrime p2 then
                                    raise Continue
                                let p3: int = 1 + (p1 * p2 / h3)
                                if not isPrime p3 then
                                    raise Continue
                                if (p2 * p3) % (p1 - 1) <> 1 then
                                    raise Continue
                                let c: obj = p1 * p2 * p3
                                printfn "%A" (pad p1 2 + "   " + pad p2 4 + "   " + pad p3 5 + "     " + string c)
                        with Continue -> ()
                    with Break -> ()
                with Continue -> ()
            with Break -> ()
        printfn "%s" "The following are Carmichael munbers for p1 <= 61:\n"
        printfn "%s" "p1     p2      p3     product"
        printfn "%s" "==     ==      ==     ======="
        for p1 in 2 .. 62 do
            if isPrime p1 then
                printfn "%A" (carmichael p1)
