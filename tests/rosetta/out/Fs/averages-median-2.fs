// Generated by Mochi compiler v0.10.26 on 2006-01-02T15:04:05Z
open System

let sel (list) (k) =
    let mutable i: int = 0
    while i <= k do
        let mutable minIndex: int = i
        let mutable j: int = i + 1
        while j < List.length list do
            if list.[j] < list.[minIndex] then
                minIndex <- j
            j <- j + 1
        let tmp: obj = list.[i]
        list.[i] <- list.[minIndex]
        list.[minIndex] <- tmp
        i <- i + 1
    list.[k]
let median (a) =
    let mutable arr: obj = a
    let half: obj = (List.length arr / 2)
    let med: obj = sel arr half
    if List.length arr % 2 = 0 then
        (med + arr.[half - 1]) / 2.0
    med
printfn "%A" (string median [3.0; 1.0; 4.0; 1.0])
printfn "%A" (string median [3.0; 1.0; 4.0; 1.0; 5.0])
