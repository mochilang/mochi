// Generated by Mochi compiler v0.10.26 on 2006-01-02T15:04:05Z
open System

let abs (x) =
    if x < 0.0 then
        -x
    x
let sqrtApprox (x) =
    let mutable guess: obj = x
    let mutable i: int = 0
    while i < 20 do
        guess <- (guess + x / guess) / 2.0
        i <- i + 1
    guess
let agmPi () =
    let mutable a: float = 1.0
    let mutable g: float = 1.0 / sqrtApprox 2.0
    let mutable sum: float = 0.0
    let mutable pow: float = 2.0
    while abs a - g > 0.000000000000001 do
        let mutable t: obj = (a + g) / 2.0
        let mutable u: obj = sqrtApprox a * g
        a <- t
        g <- u
        pow <- pow * 2.0
        let mutable diff: float = a * a - g * g
        sum <- sum + diff * pow
    let mutable pi: float = 4.0 * a * a / (1.0 - sum)
    pi
let main () =
    printfn "%A" (string agmPi())
printfn "%A" (main())
