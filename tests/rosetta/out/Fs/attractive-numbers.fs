// Generated by Mochi compiler v0.10.26 on 2006-01-02T15:04:05Z
open System

let isPrime (n) =
    if n < 2 then
        false
    if n % 2 = 0 then
        n = 2
    if n % 3 = 0 then
        n = 3
    let mutable d: int = 5
    while d * d <= n do
        if n % d = 0 then
            false
        d <- d + 2
        if n % d = 0 then
            false
        d <- d + 4
    true
let countPrimeFactors (n) =
    if n = 1 then
        0
    if isPrime n then
        1
    let mutable count: int = 0
    let mutable f: int = 2
    while true do
        if n % f = 0 then
            count <- count + 1
            n <- n / f
            if n = 1 then
                count
            if isPrime n then
                f <- n
    count
let pad4 (n) =
    let mutable s: obj = string n
    while List.length s < 4 do
        s <- " " + s
    s
let main () =
    let max: int = 120
    printfn "%s" "The attractive numbers up to and including " + string max + " are:"
    let mutable count: int = 0
    let mutable line: string = ""
    let mutable lineCount: int = 0
    let mutable i: int = 1
    while i <= max do
        let c: obj = countPrimeFactors i
        if isPrime c then
            line <- line + pad4 i
            count <- count + 1
            lineCount <- lineCount + 1
            if lineCount = 20 then
                printfn "%s" line
                line <- ""
                lineCount <- 0
        i <- i + 1
    if lineCount > 0 then
        printfn "%s" line
printfn "%A" (main())
