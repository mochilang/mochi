//go:build ignore

// Generated by Mochi compiler v0.10.30 on 2006-01-02T15:04:05Z

package main

import (
	"fmt"
	"os"
	"strconv"
	"time"
)

type v map[string]any

// line 1
func shuffle(xs []int) []int {
	arr := xs
	i := 99
	for i > 0 {
		j := (int64(_now()) % int64((i + 1)))
		tmp := arr[i]
		arr[i] = arr[j]
		arr[j] = tmp
		i = (i - 1)
	}
	return arr
}

// line 14
func doTrials(trials int, np int, strategy string) {
	pardoned := 0
	t := 0
	for t < trials {
		var drawers []int = []int{}
		i := 0
		for i < 100 {
			drawers = append(drawers, i)
			i = (i + 1)
		}
		drawers = shuffle(drawers)
		p := 0
		success := true
		for p < np {
			found := false
			if strategy == "optimal" {
				prev := p
				d := 0
				for d < 50 {
					this := drawers[prev]
					if this == p {
						found = true
						break
					}
					prev = this
					d = (d + 1)
				}
			} else {
				var opened []bool = []bool{}
				k := 0
				for k < 100 {
					opened = append(opened, false)
					k = (k + 1)
				}
				d := 0
				for d < 50 {
					n := (int64(_now()) % int64(100))
					for opened[n] {
						n = (int64(_now()) % int64(100))
					}
					opened[n] = true
					if drawers[n] == p {
						found = true
						break
					}
					d = (d + 1)
				}
			}
			if !(found) {
				success = false
				break
			}
			p = (p + 1)
		}
		if success {
			pardoned = (pardoned + 1)
		}
		t = (t + 1)
	}
	rf := (((float64(pardoned)) / (float64(trials))) * 100.0)
	fmt.Println(any("  strategy = " + strategy + "  pardoned = " + fmt.Sprint(any(pardoned)) + " relative frequency = " + fmt.Sprint(any(rf)) + "%"))
}

// line 77
func mainFn() {
	trials := 1000
	for _, np := range []int{10, 100} {
		fmt.Println(any("Results from " + fmt.Sprint(any(trials)) + " trials with " + fmt.Sprint(any(np)) + " prisoners:\n"))
		for _, strat := range []string{"random", "optimal"} {
			doTrials(trials, np, strat)
		}
	}
}

func main() {
	mainFn()
}

var seededNow bool
var nowSeed int64

func init() {
	if s := os.Getenv("MOCHI_NOW_SEED"); s != "" {
		if v, err := strconv.ParseInt(s, 10, 64); err == nil {
			nowSeed = v
			seededNow = true
		}
	}
}
func _now() int {
	if seededNow {
		nowSeed = (nowSeed*1664525 + 1013904223) % 2147483647
		return int(nowSeed)
	}
	return int(time.Now().UnixNano())
}
