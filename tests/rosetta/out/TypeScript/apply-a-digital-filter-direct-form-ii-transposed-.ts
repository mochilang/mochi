// Generated by Mochi compiler v0.10.26 on 2025-07-16T09:12:33Z
// Source: /workspace/mochi/tests/rosetta/x/Mochi/apply-a-digital-filter-direct-form-ii-transposed-.mochi

function applyFilter(input: number[], a: number[], b: number[]): number[] {
  var out: number[] = [];
  let scale = 1 / a[0];
  var i = 0;
  while ((i < input.length)) {
    var tmp = 0;
    var j = 0;
    while (((j <= i) && (j < b.length))) {
      tmp = tmp + (b[j] * input[i - j]);
      j = j + 1;
    }
    j = 0;
    while (((j < i) && ((j + 1) < a.length))) {
      tmp = tmp - (a[j + 1] * out[(i - j) - 1]);
      j = j + 1;
    }
    out = [...out, tmp * scale];
    i = i + 1;
  }
  return out;
}

let a: number[];
let b: number[];
var k: number;
let res: number[];
let sig: number[];

function main(): void {
  a = [
    1,
    -2.7756e-16,
    0.33333333,
    -1.85e-17,
  ];
  b = [
    0.16666667,
    0.5,
    0.5,
    0.16666667,
  ];
  sig = [
    -0.917843918645,
    0.141984778794,
    1.20536903482,
    0.190286794412,
    -0.662370894973,
    -1.00700480494,
    -0.404707073677,
    0.800482325044,
    0.743500089861,
    1.01090520172,
    0.741527555207,
    0.277841675195,
    0.400833448236,
    -0.2085993586,
    -0.172842103641,
    -0.134316096293,
    0.0259303398477,
    0.490105989562,
    0.549391221511,
    0.9047198589,
  ];
  res = applyFilter(sig, a, b);
  k = 0;
  while ((k < res.length)) {
    console.log(res[k]);
    k = k + 1;
  }
}
main();
