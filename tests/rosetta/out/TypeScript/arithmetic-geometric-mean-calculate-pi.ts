// Generated by Mochi compiler v0.10.26 on 2025-07-16T09:12:33Z
// Source: /workspace/mochi/tests/rosetta/x/Mochi/arithmetic-geometric-mean-calculate-pi.mochi

function abs(x: number): number {
  if ((x < 0)) {
    return (-x);
  }
  return x;
}

function sqrtApprox(x: number): number {
  var guess = x;
  var i = 0;
  while ((i < 20)) {
    guess = (guess + (x / guess)) / 2;
    i = i + 1;
  }
  return guess;
}

function agmPi(): number {
  var a = 1;
  var g = 1 / sqrtApprox(2);
  var sum = 0;
  var pow = 2;
  while ((abs(a - g) > 1e-15)) {
    var t = (a + g) / 2;
    var u = sqrtApprox(a * g);
    a = t;
    g = u;
    pow = pow * 2;
    var diff = (a * a) - (g * g);
    sum = sum + (diff * pow);
  }
  var pi = ((4 * a) * a) / (1 - sum);
  return pi;
}

function main(): void {
  return console.log(String(agmPi()));
}

function main(): void {
  main();
}
main();
