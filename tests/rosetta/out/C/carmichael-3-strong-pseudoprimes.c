// Generated by Mochi compiler v0.10.30 on 2025-07-18T17:27:17Z
// Generated by Mochi compiler v0.10.30 on 2025-07-18T17:27:17Z
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

static char *concat_string(char *a, char *b) {
  size_t len1 = strlen(a);
  size_t len2 = strlen(b);
  char *buf = (char *)malloc(len1 + len2 + 1);
  memcpy(buf, a, len1);
  memcpy(buf + len1, b, len2);
  buf[len1 + len2] = '\0';
  return buf;
}
static char *_str(int v) {
  char *buf = (char *)malloc(32);
  sprintf(buf, "%d", v);
  return buf;
}
static double _fmod_simple(double x, double y) {
  if (y == 0)
    return 0;
  double r = x - (long long)(x / y) * y;
  if (r < 0)
    r += y;
  return r;
}
int mod(int n, int m) { return ((n % m) + m) % m; }

int isPrime(int n) {
  if (n < 2) {
    return 0;
  }
  if (n % 2 == 0) {
    return n == 2;
  }
  if (n % 3 == 0) {
    return n == 3;
  }
  __auto_type d = 5;
  while (d * d <= n) {
    if (n % d == 0) {
      return 0;
    }
    d = d + 2;
    if (n % d == 0) {
      return 0;
    }
    d = d + 4;
  }
  return 1;
}

char *pad(int n, int width) {
  char *tmp1 = _str(n);
  __auto_type s = tmp1;
  while (strlen(s) < width) {
    char *tmp2 = concat_string(" ", s);
    s = tmp2;
  }
  return s;
}

int carmichael(int p1) {
  for (int h3 = 2; h3 < p1; h3++) {
    for (int d = 1; d < (h3 + p1); d++) {
      if (((h3 + p1) * (p1 - 1)) % d == 0 && mod((-p1) * p1, h3) == d % h3) {
        __auto_type p2 = 1 + (((double)(p1 - 1) * (h3 + p1)) / ((double)d));
        if (((!isPrime(p2)))) {
          continue;
        }
        __auto_type p3 = 1 + (p1 * p2 / h3);
        if (((!isPrime(p3)))) {
          continue;
        }
        if (_fmod_simple((p2 * p3), (p1 - 1)) != 1) {
          continue;
        }
        __auto_type c = p1 * p2 * p3;
        char *tmp3 = concat_string(pad(p1, 2), "   ");
        char *tmp4 = concat_string(tmp3, pad(p2, 4));
        char *tmp5 = concat_string(tmp4, "   ");
        char *tmp6 = concat_string(tmp5, pad(p3, 5));
        char *tmp7 = concat_string(tmp6, "     ");
        char *tmp8 = _str(c);
        char *tmp9 = concat_string(tmp7, tmp8);
        char *tmp10 = concat_string(pad(p1, 2), "   ");
        char *tmp11 = concat_string(tmp10, pad(p2, 4));
        char *tmp12 = concat_string(tmp11, "   ");
        char *tmp13 = concat_string(tmp12, pad(p3, 5));
        char *tmp14 = concat_string(tmp13, "     ");
        char *tmp15 = _str(c);
        char *tmp16 = concat_string(tmp14, tmp15);
        printf("%d\n", tmp16);
      }
    }
  }
}

int _mochi_main() {
  printf("The following are Carmichael munbers for p1 <= 61:\n\n");
  printf("p1     p2      p3     product\n");
  printf("==     ==      ==     =======\n");
  for (int p1 = 2; p1 < 62; p1++) {
    if (isPrime(p1)) {
      carmichael(p1);
    }
  }
  return 0;
}
int main() { return _mochi_main(); }
