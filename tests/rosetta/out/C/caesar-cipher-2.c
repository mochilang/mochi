// Generated by Mochi compiler v0.10.30 on 2025-07-18T17:09:48Z
// Generated by Mochi compiler v0.10.30 on 2025-07-18T17:09:48Z
#include <stdio.h>
#include <stdlib.h>
#include <string.h>

typedef struct {
  int len;
  int *data;
} list_int;
static list_int list_int_create(int len) {
  list_int l;
  l.len = len;
  l.data = calloc(len, sizeof(int));
  if (!l.data && len > 0) {
    fprintf(stderr, "alloc failed\n");
    exit(1);
  }
  return l;
}
static char *concat_string(char *a, char *b) {
  size_t len1 = strlen(a);
  size_t len2 = strlen(b);
  char *buf = (char *)malloc(len1 + len2 + 1);
  memcpy(buf, a, len1);
  memcpy(buf + len1, b, len2);
  buf[len1 + len2] = '\0';
  return buf;
}
static char *_str(int v) {
  char *buf = (char *)malloc(32);
  sprintf(buf, "%d", v);
  return buf;
}
static int index_of_string(char *s, char *sub) {
  char *pos = strstr(s, sub);
  if (!pos)
    return -1;
  return pos - s;
}
static char *slice_string(char *s, int start, int end) {
  int len = strlen(s);
  if (start < 0)
    start += len;
  if (end < 0)
    end += len;
  if (start < 0)
    start = 0;
  if (end > len)
    end = len;
  if (start > end)
    start = end;
  char *buf = (char *)malloc(end - start + 1);
  memcpy(buf, s + start, end - start);
  buf[end - start] = '\0';
  return buf;
}
int indexOf(char *s, char *ch) {
  __auto_type i = 0;
  while (i < strlen(s)) {
    if ((strcmp(slice_string(s, i, i + 1), ch) == 0)) {
      return i;
    }
    i = i + 1;
  }
  return (-1);
}

int ord(char *ch) {
  __auto_type upper = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
  __auto_type lower = "abcdefghijklmnopqrstuvwxyz";
  __auto_type idx = index_of_string(upper, ch);
  if ((idx >= 0)) {
    return 65 + idx;
  }
  idx = index_of_string(lower, ch);
  if ((idx >= 0)) {
    return 97 + idx;
  }
  return 0;
}

char *chr(int n) {
  __auto_type upper = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
  __auto_type lower = "abcdefghijklmnopqrstuvwxyz";
  if (n >= 65 && n < 91) {
    char *tmp1 = slice_string(upper, n - 65, n - 64);
    return tmp1;
  }
  if (n >= 97 && n < 123) {
    char *tmp2 = slice_string(lower, n - 97, n - 96);
    return tmp2;
  }
  return "?";
}

char *shiftRune(char *r, int k) {
  if ((strcmp(r, "a") >= 0) && r <= "z") {
    return chr(((ord(r) - 97 + k) % 26) + 97);
  }
  if ((strcmp(r, "A") >= 0) && r <= "Z") {
    return chr(((ord(r) - 65 + k) % 26) + 65);
  }
  return r;
}

char *encipher(char *s, int k) {
  __auto_type out = "";
  __auto_type i = 0;
  while (i < strlen(s)) {
    char *tmp3 = slice_string(s, i, i + 1);
    char *tmp4 = concat_string(out, shiftRune(tmp3, k));
    out = tmp4;
    i = i + 1;
  }
  return out;
}

char *decipher(char *s, int k) { return encipher(s, (26 - k % 26) % 26); }

int mochi_main() {
  __auto_type pt = "The five boxing wizards jump quickly";
  char *tmp5 = concat_string("Plaintext: ", pt);
  printf("%s\n", tmp5);
  list_int tmp6 = list_int_create(5);
  tmp6.data[0] = 0;
  tmp6.data[1] = 1;
  tmp6.data[2] = 7;
  tmp6.data[3] = 25;
  tmp6.data[4] = 26;
  for (int tmp7 = 0; tmp7 < 5; tmp7++) {
    int key = tmp6.data[tmp7];
    if (key < 1 || key > 25) {
      char *tmp8 = _str(key);
      char *tmp9 = concat_string("Key ", tmp8);
      char *tmp10 = concat_string(tmp9, " invalid");
      printf("%s\n", tmp10);
      continue;
    }
    __auto_type ct = encipher(pt, key);
    char *tmp11 = _str(key);
    char *tmp12 = concat_string("Key ", tmp11);
    printf("%s\n", tmp12);
    char *tmp13 = concat_string("  Enciphered: ", ct);
    printf("%s\n", tmp13);
    char *tmp14 = concat_string("  Deciphered: ", decipher(ct, key));
    printf("%s\n", tmp14);
  }
}

int _mochi_main() {
  mochi_main();
  return 0;
}
int main() { return _mochi_main(); }
