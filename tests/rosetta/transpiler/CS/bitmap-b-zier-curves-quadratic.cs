// Generated by Mochi 0.10.52 on 2025-07-31 14:19 +0700
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text.Json;
using System.Numerics;

class Pixel {
    public long r;
    public long g;
    public long b;
    public override string ToString() => $"Pixel {{r = {r}, g = {g}, b = {b}}}";
}
class Program {
    static bool seededNow = false;
    static long nowSeed = 0;
    static long _now() {
        if (!seededNow) {
            var s = Environment.GetEnvironmentVariable("MOCHI_NOW_SEED");
            if (long.TryParse(s, out var v)) {
                nowSeed = v;
                seededNow = true;
            }
        }
        if (seededNow) {
            nowSeed = unchecked(nowSeed * 1664525 + 1013904223);
            nowSeed %= 9223372036854775783L;
            if (nowSeed < 0) nowSeed += 9223372036854775783L;
            return nowSeed;
        }
        return DateTime.UtcNow.Ticks / 100;
    }
    static long _mem() {
        return GC.GetTotalMemory(false);
    }
    static long b2Seg_0 = 20;
    static Dictionary<string, object> b_63 = newBitmap(400, 300);
    static Pixel pixelFromRgb(long rgb_1) {
        long r_2 = Convert.ToInt64(((rgb_1 / 65536) % 256));
        long g_3 = Convert.ToInt64(((rgb_1 / 256) % 256));
        long b_4 = Convert.ToInt64((rgb_1 % 256));
        return new Pixel{r = r_2, g = g_3, b = b_4};
    }

    static Dictionary<string, object> newBitmap(long cols_5, long rows_6) {
        Pixel[][] d_7 = new Pixel[][]{};
        long y_8 = 0;
        while ((y_8 < rows_6)) {
            Pixel[] row_9 = new Pixel[]{};
            long x_10 = 0;
            while ((x_10 < cols_5)) {
                row_9 = (Enumerable.ToArray(Enumerable.Append(row_9, new Pixel{r = 0, g = 0, b = 0})));
                x_10 = (x_10 + 1);
            }
            d_7 = (Enumerable.ToArray(Enumerable.Append(d_7, row_9)));
            y_8 = (y_8 + 1);
        };
        return new Dictionary<string, object>{{"cols", cols_5}, {"rows", rows_6}, {"data", d_7}};
    }

    static void setPx(Dictionary<string, object> b_11, long x_12, long y_13, Pixel p_14) {
        long cols_15 = Convert.ToInt64(((dynamic)b_11)["cols"]);
        long rows_16 = Convert.ToInt64(((dynamic)b_11)["rows"]);
        if (((((x_12 >= 0) && (x_12 < cols_15)) && (y_13 >= 0)) && (y_13 < rows_16))) {
            ((dynamic)((dynamic)b_11)["data"])[y_13][x_12] = p_14;
        };
    }

    static void fill(Dictionary<string, object> b_17, Pixel p_18) {
        long cols_19 = Convert.ToInt64(((dynamic)b_17)["cols"]);
        long rows_20 = Convert.ToInt64(((dynamic)b_17)["rows"]);
        long y_21 = 0;
        while ((y_21 < rows_20)) {
            long x_22 = 0;
            while ((x_22 < cols_19)) {
                ((dynamic)((dynamic)b_17)["data"])[y_21][x_22] = p_18;
                x_22 = (x_22 + 1);
            }
            y_21 = (y_21 + 1);
        };
    }

    static void fillRgb(Dictionary<string, object> b_23, long rgb_24) {
        fill(b_23, pixelFromRgb(rgb_24));
    }

    static void line(Dictionary<string, object> b_25, long x0_26, long y0_27, long x1_28, long y1_29, Pixel p_30) {
        long dx_31 = (x1_28 - x0_26);
        if ((dx_31 < 0)) {
            dx_31 = -dx_31;
        };
        long dy_32 = (y1_29 - y0_27);
        if ((dy_32 < 0)) {
            dy_32 = -dy_32;
        };
        long sx_33 = -1;
        if ((x0_26 < x1_28)) {
            sx_33 = 1;
        };
        long sy_34 = -1;
        if ((y0_27 < y1_29)) {
            sy_34 = 1;
        };
        long err_35 = (dx_31 - dy_32);
        while (true) {
            setPx(b_25, x0_26, y0_27, p_30);
            if (((x0_26 == x1_28) && (y0_27 == y1_29))) {
                break;
            }
            long e2_36 = (2 * err_35);
            if ((e2_36 > (0 - dy_32))) {
                err_35 = (err_35 - dy_32);
                x0_26 = (x0_26 + sx_33);
            }
            if ((e2_36 < dx_31)) {
                err_35 = (err_35 + dx_31);
                y0_27 = (y0_27 + sy_34);
            }
        };
    }

    static void bezier2(Dictionary<string, object> b_37, long x1_38, long y1_39, long x2_40, long y2_41, long x3_42, long y3_43, Pixel p_44) {
        long[] px_45 = new long[]{};
        long[] py_46 = new long[]{};
        long i_47 = 0;
        while ((i_47 <= b2Seg_0)) {
            px_45 = (Enumerable.ToArray(Enumerable.Append(px_45, 0)));
            py_46 = (Enumerable.ToArray(Enumerable.Append(py_46, 0)));
            i_47 = (i_47 + 1);
        };
        double fx1_48 = Convert.ToDouble(x1_38);
        double fy1_49 = Convert.ToDouble(y1_39);
        double fx2_50 = Convert.ToDouble(x2_40);
        double fy2_51 = Convert.ToDouble(y2_41);
        double fx3_52 = Convert.ToDouble(x3_42);
        double fy3_53 = Convert.ToDouble(y3_43);
        i_47 = 0;
        while ((i_47 <= b2Seg_0)) {
            double c_54 = (Convert.ToDouble(i_47) / Convert.ToDouble(b2Seg_0));
            double a_55 = (1.0 - c_54);
            double a2_56 = (a_55 * a_55);
            double b2_57 = ((2.0 * c_54) * a_55);
            double c2_58 = (c_54 * c_54);
            px_45[i_47] = Convert.ToInt64((((a2_56 * fx1_48) + (b2_57 * fx2_50)) + (c2_58 * fx3_52)));
            py_46[i_47] = Convert.ToInt64((((a2_56 * fy1_49) + (b2_57 * fy2_51)) + (c2_58 * fy3_53)));
            i_47 = (i_47 + 1);
        };
        long x0_59 = px_45[(int)(0)];
        long y0_60 = py_46[(int)(0)];
        i_47 = 1;
        while ((i_47 <= b2Seg_0)) {
            long x_61 = px_45[(int)(i_47)];
            long y_62 = py_46[(int)(i_47)];
            line(b_37, x0_59, y0_60, x_61, y_62, p_44);
            x0_59 = x_61;
            y0_60 = y_62;
            i_47 = (i_47 + 1);
        };
    }

    static void Main() {
        {
            var __memStart = _mem();
            var __start = _now();
            fillRgb(b_63, 14614575);
            bezier2(b_63, 20, 150, 500, -100, 300, 280, pixelFromRgb(4165615));
            var __end = _now();
            var __memEnd = _mem();
            var __dur = (__end - __start);
            var __memDiff = __memEnd - __memStart;
            Console.WriteLine(JsonSerializer.Serialize(new SortedDictionary<string, object>{{"name", "main"}, {"duration_us", __dur}, {"memory_bytes", __memDiff}}, new JsonSerializerOptions{ WriteIndented = true }));
        }
    }
}
