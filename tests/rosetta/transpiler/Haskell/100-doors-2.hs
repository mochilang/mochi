{-# LANGUAGE DuplicateRecordFields #-}
{-# LANGUAGE OverloadedRecordDot #-}
{-# LANGUAGE NoFieldSelectors #-}
-- Generated by Mochi transpiler v0.10.37 on 2025-07-22 21:00 GMT+7
import Data.IORef
import System.IO.Unsafe (unsafePerformIO)
main :: IO ()
main = do
    door <- newIORef (1)
    incrementer <- newIORef (0)
    mapM_ (\current -> do
        line <- newIORef ("Door " ++ show current ++ " ")
        if current == (unsafePerformIO (readIORef door)) then do
            writeIORef line $! ((unsafePerformIO (readIORef line)) ++ "Open")
            writeIORef incrementer $! ((unsafePerformIO (readIORef incrementer)) + 1)
            writeIORef door $! ((unsafePerformIO (readIORef door)) + 2 * (unsafePerformIO (readIORef incrementer)) + 1)
        else do
            writeIORef line $! ((unsafePerformIO (readIORef line)) ++ "Closed")

        putStrLn ((unsafePerformIO (readIORef line)))
        ) [1 .. (101 - 1)]
