// Generated by Mochi transpiler v0.10.52 on 2025-08-01 19:12:02 GMT+7
import Foundation

func _p(_ v: Any?) -> String {
    if let val = v { return String(describing: val) }
    return "<nil>"
}

typealias Fn = (Any?) -> Any?
typealias Church = (Fn) -> Fn
func zero(_ f: Fn) -> Fn {
    return { (x: Any?) -> Any? in
    return x
}
}
func succ(_ c: Church) -> Church {
    return { (f: Fn) -> Fn in
    return { (x: Any?) -> Any? in
    return f((c((f as! (Any?) -> Any?))(x) as! Any?))
}
}
}
func add(_ c: Church, _ d: Church) -> Church {
    return { (f: Fn) -> Fn in
    return { (x: Any?) -> Any? in
    return c((f as! (Any?) -> Any?))(d((f as! (Any?) -> Any?))(x))
}
}
}
func mul(_ c: Church, _ d: Church) -> Church {
    return { (f: Fn) -> Fn in
    return { (x: Any?) -> Any? in
    return c((d((f as! (Any?) -> Any?)) as! (Any?) -> Any?))(x)
}
}
}
func pow(_ c: Church, _ d: Church) -> Church {
    var di: Int = Int(toInt((d as! ((Any?) -> Any?) -> (Any?) -> Any?)))
    var prod: ((Any?) -> Any?) -> (Any?) -> Any? = c
    var i: Int = 1
    while (i < di) {
        prod = (mul((prod as! ((Any?) -> Any?) -> (Any?) -> Any?), (c as! ((Any?) -> Any?) -> (Any?) -> Any?)) as! ((Any?) -> Any?) -> (Any?) -> Any?)
        i = ((i + 1) as! Int)
    }
    return prod
}
func incr(_ i: Any?) -> Any? {
    return (((i as! Int) + 1) as! Any?)
}
func toInt(_ c: Church) -> Int {
    return (c((incr as! (Any?) -> Any?))(0) as! Int)
}
func intToChurch(_ i: Int) -> Church {
    if (i == 0) {
        return zero
    }
    return succ((intToChurch(((i - 1) as! Int)) as! ((Any?) -> Any?) -> (Any?) -> Any?))
}
let z: Church = zero
let three = succ((succ((succ((z as! ((Any?) -> Any?) -> (Any?) -> Any?)) as! ((Any?) -> Any?) -> (Any?) -> Any?)) as! ((Any?) -> Any?) -> (Any?) -> Any?))
let four = succ((three as! ((Any?) -> Any?) -> (Any?) -> Any?))
print(_p(("three        -> " + _p(Int(toInt((three as! ((Any?) -> Any?) -> (Any?) -> Any?)))))))
print(_p(("four         -> " + _p(Int(toInt((four as! ((Any?) -> Any?) -> (Any?) -> Any?)))))))
print(_p(("three + four -> " + _p(Int(toInt((add((three as! ((Any?) -> Any?) -> (Any?) -> Any?), (four as! ((Any?) -> Any?) -> (Any?) -> Any?)) as! ((Any?) -> Any?) -> (Any?) -> Any?)))))))
print(_p(("three * four -> " + _p(Int(toInt((mul((three as! ((Any?) -> Any?) -> (Any?) -> Any?), (four as! ((Any?) -> Any?) -> (Any?) -> Any?)) as! ((Any?) -> Any?) -> (Any?) -> Any?)))))))
print(_p(("three ^ four -> " + _p(Int(toInt((pow((three as! ((Any?) -> Any?) -> (Any?) -> Any?), (four as! ((Any?) -> Any?) -> (Any?) -> Any?)) as! ((Any?) -> Any?) -> (Any?) -> Any?)))))))
print(_p(("four ^ three -> " + _p(Int(toInt((pow((four as! ((Any?) -> Any?) -> (Any?) -> Any?), (three as! ((Any?) -> Any?) -> (Any?) -> Any?)) as! ((Any?) -> Any?) -> (Any?) -> Any?)))))))
print(_p(("5 -> five    -> " + _p(Int(toInt((intToChurch(5) as! ((Any?) -> Any?) -> (Any?) -> Any?)))))))
