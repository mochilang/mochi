// Generated by Mochi transpiler v0.10.40 on 2025-07-25 19:48:23 GMT+7
import Foundation

var _nowSeed = 0
var _nowSeeded = false
func _now() -> Int {
    if !_nowSeeded {
        if let s = ProcessInfo.processInfo.environment["MOCHI_NOW_SEED"], let v = Int(s) {
            _nowSeed = v
            _nowSeeded = true
        }
    }
    if _nowSeeded {
        _nowSeed = (_nowSeed * 1664525 + 1013904223) % 2147483647
        return _nowSeed
    }
    return Int(Date().timeIntervalSince1970 * 1_000_000_000)
}
func parseIntStr(_ str: String) -> Int {
    var i = 0
    var neg = false
    if ((Int(((str).count)) > 0) && (String(Array(str)[0..<1]) == "-")) {
        neg = true
        i = 1
    }
    var n = 0
    let digits = ["0": 0, "1": 1, "2": 2, "3": 3, "4": 4, "5": 5, "6": 6, "7": 7, "8": 8, "9": 9] as [String: Any]
    while (i < Int(((str).count))) {
        n = (((n * 10) + (digits[String(Array(str)[i..<(i + 1)])] as! Int)) as! Int)
        i = ((i + 1) as! Int)
    }
    if neg {
        n = (-n as! Int)
    }
    return (n as! Int)
}
func main() {
    var total = 0
    var computer = (((Int(_now()) % 2) == 0) as! Bool)
    print("Enter q to quit at any time\n")
    if computer {
        print("The computer will choose first")
    } else {
        print("You will choose first")
    }
    print("\n\nRunning total is now 0\n\n")
    var round = 1
    var done = false
    while (!done) {
        print((("ROUND " + String(describing: round)) + ":\n\n"))
        var i = 0
        while ((i < 2) && ((!done) as! Bool)) {
            if computer {
                var choice = 0
                if (total < 18) {
                    choice = (((Int(_now()) % 3) + 1) as! Int)
                } else {
                    choice = ((21 - total) as! Int)
                }
                total = ((total + choice) as! Int)
                print(("The computer chooses " + String(describing: choice)))
                print(("Running total is now " + String(describing: total)))
                if (total == 21) {
                    print("\nSo, commiserations, the computer has won!")
                    done = true
                }
            } else {
                while true {
                    print("Your choice 1 to 3 : ")
                    let line = (readLine() ?? "")
                    if ((line == "q") || (line == "Q")) {
                        print("OK, quitting the game")
                        done = true
                        break
                    }
                    var num = Int(parseIntStr((line as! String)))
                    if ((num < 1) || (num > 3)) {
                        if ((total + num) > 21) {
                            print("Too big, try again")
                        } else {
                            print("Out of range, try again")
                        }
                        continue
                    }
                    if ((total + num) > 21) {
                        print("Too big, try again")
                        continue
                    }
                    total = ((total + num) as! Int)
                    print(("Running total is now " + String(describing: total)))
                    break
                }
                if (total == 21) {
                    print("\nSo, congratulations, you've won!")
                    done = true
                }
            }
            print("\n")
            computer = ((!computer) as! Bool)
            i = ((i + 1) as! Int)
        }
        round = ((round + 1) as! Int)
    }
}
_ = main()
