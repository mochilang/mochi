-- Generated by Mochi v0.10.52 on 2025-08-02 01:52 GMT+7
function input()
  return io.read('*l')
end
local _nil = {}
function id(x)
  return x
end;

function compose(f, g)
  return function(x)
  return f(g(x))
end
end;

function zero()
  return function(f)
  return id
end
end;

function one()
  return id
end;

function succ(n)
  return function(f)
  return compose(f, n(f))
end
end;

function plus(m, n)
  return function(f)
  return compose(m(f), n(f))
end
end;

function mult(m, n)
  return compose(m, n)
end;

function exp(m, n)
  return n(m)
end;

function toInt(x)
  local counter = 0
  local function fCounter(f)
  counter = (counter + 1)
  return f
end
x(fCounter)(id)
return counter
end;

function toStr(x)
  local s = ""
  local function fCounter(f)
  s = (s .. "|")
  return f
end
x(fCounter)(id)
return s
end;

function main()
  print(("zero = " .. tostring(toInt(zero()))))
  local onev = one()
  print(("one = " .. tostring(toInt(onev))))
  local two = succ(succ(zero()))
  print(("two = " .. tostring(toInt(two))))
  local three = plus(onev, two)
  print(("three = " .. tostring(toInt(three))))
  local four = mult(two, two)
  print(("four = " .. tostring(toInt(four))))
  local eight = exp(two, three)
  print(("eight = " .. tostring(toInt(eight))))
  print(("toStr(four) = " .. toStr(four)))
end;
