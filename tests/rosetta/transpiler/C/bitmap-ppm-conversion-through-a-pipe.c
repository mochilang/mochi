// Generated by Mochi 0.10.32 on 2025-08-03 21:09 +0700
#include <stdio.h>
#include <string.h>
#include <stdlib.h>
#include <unistd.h>
#include <malloc.h>


static int** list_append_intptr(int **arr, size_t *len, int *val) {
    arr = realloc(arr, (*len + 1) * sizeof(int*));
    arr[*len] = val;
    (*len)++;
    return arr;
}

static size_t* list_append_szt(size_t *arr, size_t *len, size_t val) {
    arr = realloc(arr, (*len + 1) * sizeof(size_t));
    arr[*len] = val;
    (*len)++;
    return arr;
}

#include <time.h>
#include <stdlib.h>
static int seeded_now = 0;
static long long now_seed = 0;
static long long _now(void) {
    if (!seeded_now) {
        const char *s = getenv("MOCHI_NOW_SEED");
        if (s && *s) {
            now_seed = atoll(s);
            seeded_now = 1;
        }
    }
    if (seeded_now) {
        now_seed = (now_seed * 1664525 + 1013904223) % 2147483647;
        return now_seed;
    }
    struct timespec ts;
    clock_gettime(CLOCK_REALTIME, &ts);
    return (long long)(ts.tv_sec * 1000000000LL + ts.tv_nsec);
}

static long long _mem(void) {
    long long size = 0, rss = 0;
    FILE *f = fopen("/proc/self/statm", "r");
    if (f) {
        if (fscanf(f, "%lld %lld", &size, &rss) != 2) rss = 0;
        fclose(f);
    }
    return rss * (long long)sysconf(_SC_PAGESIZE);
}

typedef struct Bitmap Bitmap;
typedef struct Pixel Pixel;

struct Bitmap {
    long long cols;
    long long rows;
    Pixel **px;
    size_t px_len;
    size_t *px_lens;
    size_t px_lens_len;
};

struct Pixel {
    long long R;
    long long G;
    long long B;
};

static Pixel* list_append_Pixel(Pixel *arr, size_t *len, Pixel val) {
    arr = realloc(arr, (*len + 1) * sizeof(Pixel));
    arr[*len] = val;
    (*len)++;
    return arr;
}

static Pixel** list_append_Pixelptr(Pixel **arr, size_t *len, Pixel *val) {
    arr = realloc(arr, (*len + 1) * sizeof(Pixel*));
    arr[*len] = val;
    (*len)++;
    return arr;
}

Pixel pixelFromRgb(long long c);
long long rgbFromPixel(Pixel p);
Bitmap NewBitmap(long long x, long long y);
void FillRgb(Bitmap b, long long c);
long long SetPxRgb(Bitmap b, long long x, long long y, long long c);
long long nextRand(long long seed);
void user_main();
int main(void);

Pixel pixelFromRgb(long long c) {
    int r = (c / 65536LL) % 256LL;
    int g = (c / 256LL) % 256LL;
    int b = c % 256LL;
    return (Pixel){.R = r, .G = g, .B = b};
}

long long rgbFromPixel(Pixel p) {
    return ((p.R * 65536LL) + (p.G * 256LL)) + p.B;
}

Bitmap NewBitmap(long long x, long long y) {
    Pixel **data = NULL;
    size_t data_len = 0;
    size_t *data_lens = NULL;
    size_t data_lens_len = 0;
    int row = 0LL;
    while (row < y) {
        Pixel *r = NULL;
        size_t r_len = 0;
        int col = 0LL;
        while (col < x) {
            r = list_append_Pixel(r, &r_len, (Pixel){.R = 0LL, .G = 0LL, .B = 0LL});
            col = col + 1LL;
        }
        data = list_append_Pixelptr(data, &data_len, r);
        data_lens = list_append_szt(data_lens, &data_lens_len, r_len);
        row = row + 1LL;
    }
    return (Bitmap){.cols = x, .rows = y, .px = data, .px_len = data_len, .px_lens = data_lens, .px_lens_len = data_len};
}

void FillRgb(Bitmap b, long long c) {
    int y = 0LL;
    Pixel p = pixelFromRgb(c);
    while (y < b.rows) {
        int x = 0LL;
        while (x < b.cols) {
            Pixel **px = b.px;
            size_t px_len = b.px_len;
            size_t *px_lens = b.px_lens;
            size_t px_lens_len = b.px_len;
            Pixel *row = px[(int)(y)];
            size_t row_len = px_lens[y];
            row[(int)(x)] = p;
            px[(int)(y)] = row;
            b.px = px;
            x = x + 1LL;
        }
        y = y + 1LL;
    }
}

long long SetPxRgb(Bitmap b, long long x, long long y, long long c) {
    if ((((x < 0LL) || (x >= b.cols)) || (y < 0LL)) || (y >= b.rows)) {
        return 0LL;
    }
    Pixel **px = b.px;
    size_t px_len = b.px_len;
    size_t *px_lens = b.px_lens;
    size_t px_lens_len = b.px_len;
    Pixel *row = px[(int)(y)];
    size_t row_len = px_lens[y];
    row[(int)(x)] = pixelFromRgb(c);
    px[(int)(y)] = row;
    b.px = px;
    return 1LL;
}

long long nextRand(long long seed) {
    return ((seed * 1664525LL) + 1013904223LL) % 2147483648LL;
}

void user_main() {
    Bitmap bm = NewBitmap(400LL, 300LL);
    FillRgb(bm, 12615744LL);
    long long seed = _now();
    int i = 0LL;
    while (i < 2000LL) {
        seed = nextRand(seed);
        int x = seed % 400LL;
        seed = nextRand(seed);
        int y = seed % 300LL;
        SetPxRgb(bm, (long long)x, (long long)y, 8405024LL);
        i = i + 1LL;
    }
    int x = 0LL;
    while (x < 400LL) {
        int y = 240LL;
        while (y < 245LL) {
            SetPxRgb(bm, (long long)x, (long long)y, 8405024LL);
            y = y + 1LL;
        }
        y = 260LL;
        while (y < 265LL) {
            SetPxRgb(bm, (long long)x, (long long)y, 8405024LL);
            y = y + 1LL;
        }
        x = x + 1LL;
    }
    int y = 0LL;
    while (y < 300LL) {
        int x = 80LL;
        while (x < 85LL) {
            SetPxRgb(bm, (long long)x, (long long)y, 8405024LL);
            x = x + 1LL;
        }
        x = 95LL;
        while (x < 100LL) {
            SetPxRgb(bm, (long long)x, (long long)y, 8405024LL);
            x = x + 1LL;
        }
        y = y + 1LL;
    }
}

int main(void) {
    {
        long long __start = _now();
        user_main();
        long long __end = _now();
        long long __dur_us = (__end - __start) / 1000;
        long long __mem_bytes = _mem();
        printf("{\n  \"duration_us\": %-lld,\n  \"memory_bytes\": %-lld,\n  \"name\": \"main\"\n}\n", __dur_us, __mem_bytes);
    }
    return 0;
}
