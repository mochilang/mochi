// Generated by Mochi 0.10.32 on 2025-07-26 22:52 +0700
#include <stdio.h>
#include <string.h>
#include <stdlib.h>
#include <malloc.h>
#include <math.h>

size_t applyFilter_len;

static double* list_append_double_new(const double *arr, size_t len, double val) {
    double *res = malloc((len + 1) * sizeof(double));
    if (arr && len) memcpy(res, arr, len * sizeof(double));
    res[len] = val;
    return res;
}

#include <time.h>
#include <stdlib.h>
static int seeded_now = 0;
static long long now_seed = 0;
static long long _now(void) {
    if (!seeded_now) {
        const char *s = getenv("MOCHI_NOW_SEED");
        if (s && *s) {
            now_seed = atoll(s);
            seeded_now = 1;
        }
    }
    if (seeded_now) {
        now_seed = (now_seed * 1664525 + 1013904223) % 2147483647;
        return now_seed;
    }
    struct timespec ts;
    clock_gettime(CLOCK_REALTIME, &ts);
    return (long long)(ts.tv_sec * 1000000000LL + ts.tv_nsec);
}

static long long _mem(void) {
    struct mallinfo mi = mallinfo();
    return (long long)mi.uordblks;
}

int a[] = {1, -(2.7756e-16), 0.33333333, -(1.85e-17)};
size_t a_len = 4;
double b[] = {0.16666667, 0.5, 0.5, 0.16666667};
size_t b_len = 4;
double sig[] = {-(0.917843918645), 0.141984778794, 1.20536903482, 0.190286794412, -(0.662370894973), -(1.00700480494), -(0.404707073677), 0.800482325044, 0.743500089861, 1.01090520172, 0.741527555207, 0.277841675195, 0.400833448236, -(0.2085993586), -(0.172842103641), -(0.134316096293), 0.0259303398477, 0.490105989562, 0.549391221511, 0.9047198589};
size_t sig_len = 20;
int k = 0;

double * applyFilter(double * input, size_t input_len, double * a, size_t a_len, double * b, size_t b_len) {
    double *out = NULL;
    size_t out_len = 0;
    double scale = 1 / a[0];
    int i = 0;
    while (i < input_len) {
        int tmp = 0;
        int j = 0;
        while ((j <= i) && (j < b_len)) {
            tmp = tmp + (b[j] * input[i - j]);
            j = j + 1;
        }
        j = 0;
        while ((j < i) && ((j + 1) < a_len)) {
            tmp = tmp - (a[j + 1] * out[(i - j) - 1]);
            j = j + 1;
        }
                out = list_append_double_new(out, out_len, tmp * scale);
        i = i + 1;
    }
    return applyFilter_len = out_len, out;
}

int main(void) {
    {
        long long __start = _now();
        long long __mem_start = _mem();
        double *res = applyFilter(sig, sig_len, a, a_len, b, b_len);
        size_t res_len = applyFilter_len;
        while (k < res_len) {
            printf("%g\n", res[k]);
            k = k + 1;
        }
        long long __end = _now();
        long long __mem_end = _mem();
        long long __dur_us = (__end - __start) / 1000;
        long long __mem_bytes = __mem_end - __mem_start;
        printf("{\n  \"duration_us\": %-lld,\n  \"memory_bytes\": %-lld,\n  \"name\": \"main\"\n}\n", __dur_us, __mem_bytes);
    }
    return 0;
}
