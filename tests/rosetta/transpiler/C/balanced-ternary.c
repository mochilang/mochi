// Generated by Mochi 0.10.32 on 2025-07-27 21:12 +0700
#include <stdio.h>
#include <string.h>
#include <stdlib.h>
#include <malloc.h>

size_t btInt_len;
size_t btNeg_len;
size_t btAdd_len;
size_t btMul_len;

static char* str_concat(const char *a, const char *b) {
    size_t len1 = strlen(a);
    size_t len2 = strlen(b);
    char *res = malloc(len1 + len2 + 1);
    memcpy(res, a, len1);
    memcpy(res + len1, b, len2);
    res[len1 + len2] = 0;
    return res;
}

static char* str_int(int v) {
    char buf[32];
    snprintf(buf, sizeof(buf), "%d", v);
    return strdup(buf);
}

typedef struct { const char **keys; const char **vals; size_t len; } MapSS;

static const char* map_get_ss(const char *keys[], const char *vals[], size_t len, const char *key) {
    for (size_t i = 0; i < len; i++) {
        if (strcmp(keys[i], key) == 0) return vals[i];
    }
    return "";
}

static int* list_append_int(int *arr, size_t *len, int val) {
    arr = realloc(arr, (*len + 1) * sizeof(int));
    arr[*len] = val;
    (*len)++;
    return arr;
}

#include <time.h>
#include <stdlib.h>
static int seeded_now = 0;
static long long now_seed = 0;
static long long _now(void) {
    if (!seeded_now) {
        const char *s = getenv("MOCHI_NOW_SEED");
        if (s && *s) {
            now_seed = atoll(s);
            seeded_now = 1;
        }
    }
    if (seeded_now) {
        now_seed = (now_seed * 1664525 + 1013904223) % 2147483647;
        return now_seed;
    }
    struct timespec ts;
    clock_gettime(CLOCK_REALTIME, &ts);
    return (long long)(ts.tv_sec * 1000000000LL + ts.tv_nsec);
}

static long long _mem(void) {
    struct mallinfo mi = mallinfo();
    return (long long)mi.uordblks;
}

static const char* _substring(const char *s, int start, int end) {
    int len = (int)strlen(s);
    if (start < 0) start = 0;
    if (end > len) end = len;
    if (start > end) start = end;
    char *res = malloc(end - start + 1);
    memcpy(res, s + start, end - start);
    res[end - start] = 0;
    return res;
}

typedef struct Anon1 Anon1;

struct Anon1 {
    int *bt;
    size_t bt_len;
    int ok;
};

const char* trimLeftZeros(const char* s);
Anon1 btString(const char* s);
const char* btToString(int * b, size_t b_len);
int * btInt(int i);
int btToInt(int * b, size_t b_len);
int * btNeg(int * b, size_t b_len);
int * btAdd(int * a, size_t a_len, int * b, size_t b_len);
int * btMul(int * a, size_t a_len, int * b, size_t b_len);
const char* padLeft(const char* s, int w);
int show(const char* label, int * b, size_t b_len);
int user_main();
int main(void);

const char* trimLeftZeros(const char* s) {
    int i = 0;
    while ((i < strlen(s)) && (strcmp(_substring(s, i, i + 1), "0") == 0)) {
        i = i + 1;
    }
    return _substring(s, i, strlen(s));
}

Anon1 btString(const char* s) {
    s = trimLeftZeros(s);
    int *b = NULL;
    size_t b_len = 0;
    int i = strlen(s) - 1;
    while (i >= 0) {
        const char* ch = _substring(s, i, i + 1);
        if (strcmp(ch, "+") == 0) {
            b = list_append_int(b, &b_len, 1);
        } else {
            if (strcmp(ch, "0") == 0) {
                b = list_append_int(b, &b_len, 0);
            } else {
                if (strcmp(ch, "-") == 0) {
                    b = list_append_int(b, &b_len, -1);
                } else {
                    return (Anon1){.bt = NULL, .bt_len = 0, .ok = 0};
                }
            }
        }
        i = i - 1;
    }
    return (Anon1){.bt = b, .bt_len = b_len, .ok = 1};
}

const char* btToString(int * b, size_t b_len) {
    if (b_len == 0) {
        return "0";
    }
    const char* r = "";
    int i = b_len - 1;
    while (i >= 0) {
        int d = b[i];
        if (d == (0 - 1)) {
            r = str_concat(r, "-");
        } else {
            if (d == 0) {
                r = str_concat(r, "0");
            } else {
                r = str_concat(r, "+");
            }
        }
        i = i - 1;
    }
    return r;
}

int * btInt(int i) {
    if (i == 0) {
        return btInt_len = 0, NULL;
    }
    int n = i;
    int *b = NULL;
    size_t b_len = 0;
    while (n != 0) {
        int m = n % 3;
        n = n / 3;
        if (m == 2) {
            m = -1;
            n = n + 1;
        } else {
            if (m == (0 - 2)) {
                m = 1;
                n = n - 1;
            }
        }
        b = list_append_int(b, &b_len, m);
    }
    return btInt_len = b_len, b;
}

int btToInt(int * b, size_t b_len) {
    int r = 0;
    int pt = 1;
    int i = 0;
    while (i < b_len) {
        r = r + (b[i] * pt);
        pt = pt * 3;
        i = i + 1;
    }
    return r;
}

int * btNeg(int * b, size_t b_len) {
    int *r = NULL;
    size_t r_len = 0;
    int i = 0;
    while (i < b_len) {
        r = list_append_int(r, &r_len, -(b[i]));
        i = i + 1;
    }
    return btNeg_len = r_len, r;
}

int * btAdd(int * a, size_t a_len, int * b, size_t b_len) {
    return btAdd_len = btInt_len, btInt(btToInt(a, a_len) + btToInt(b, b_len));
}

int * btMul(int * a, size_t a_len, int * b, size_t b_len) {
    return btMul_len = btInt_len, btInt(btToInt(a, a_len) * btToInt(b, b_len));
}

const char* padLeft(const char* s, int w) {
    const char* r = s;
    while (strlen(r) < w) {
        r = str_concat(" ", r);
    }
    return r;
}

int show(const char* label, int * b, size_t b_len) {
    const char* l = padLeft(label, 7);
    const char* bs = padLeft(btToString(b, b_len), 12);
    const char* is = padLeft(str_int(btToInt(b, b_len)), 7);
    puts(str_concat(str_concat(str_concat(str_concat(l, " "), bs), " "), is));
}

int user_main() {
    Anon1 ares = btString("+-0++0+");
    int *a = ares.bt;
    size_t a_len = ares.bt_len;
    int *b = btInt(-436);
    size_t b_len = btInt_len;
    Anon1 cres = btString("+-++-");
    int *c = cres.bt;
    size_t c_len = cres.bt_len;
    show("a:", a, a_len);
    show("b:", b, b_len);
    show("c:", c, c_len);
    show("a(b-c):", btMul(a, a_len, btAdd(b, b_len, btNeg(c, c_len), btNeg_len), btAdd_len), btMul_len);
}

int main(void) {
    {
        long long __start = _now();
        long long __mem_start = _mem();
        user_main();
        long long __end = _now();
        long long __mem_end = _mem();
        long long __dur_us = (__end - __start) / 1000;
        long long __mem_bytes = __mem_end - __mem_start;
        printf("{\n  \"duration_us\": %-lld,\n  \"memory_bytes\": %-lld,\n  \"name\": \"main\"\n}\n", __dur_us, __mem_bytes);
    }
    return 0;
}
