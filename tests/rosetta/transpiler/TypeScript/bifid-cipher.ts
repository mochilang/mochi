// Generated by Mochi v0.10.40 on 2025-07-25 17:41:26 GMT+7

function square_to_maps(square: string[][]): Record<string, any> {
  let emap: Record<string, number[]> = {};
  let dmap: Record<string, string> = {};
  let x: number = 0;
  while ((x < (Array.isArray(square) || typeof square === 'string' ? square.length : Object.keys(square ?? {}).length))) {
    const row: string[] = square[x];
    let y: number = 0;
    while ((y < (Array.isArray(row) || typeof row === 'string' ? row.length : Object.keys(row ?? {}).length))) {
      const ch: string = row[y];
      emap[ch] = [x, y];
      dmap[((String(x) + ",") + String(y))] = ch;
      y = (y + 1);
    }
    x = (x + 1);
  }
  return {"e": emap, "d": dmap};
}
function remove_space(text: string, emap: Record<string, number[]>): string {
  const s: string = text.toUpperCase();
  let out: string = "";
  let i: number = 0;
  while ((i < (Array.isArray(s) || typeof s === 'string' ? s.length : Object.keys(s ?? {}).length))) {
    const ch: string = s.slice(i, (i + 1));
    if (((ch != " ") && (ch in emap))) {
      out = (out + ch);
    }
    i = (i + 1);
  }
  return out;
}
function encrypt(text: string, emap: Record<string, number[]>, dmap: Record<string, string>): string {
  text = remove_space(text, emap);
  let row0: number[] = [];
  let row1: number[] = [];
  let i: number = 0;
  while ((i < (Array.isArray(text) || typeof text === 'string' ? text.length : Object.keys(text ?? {}).length))) {
    const ch: string = text.slice(i, (i + 1));
    const xy: number[] = emap[ch];
    row0 = [...row0, xy[Math.trunc(0)]];
    row1 = [...row1, xy[Math.trunc(1)]];
    i = (i + 1);
  }
  for (const v of row1) {
    row0 = [...row0, v];
  }
  let res: string = "";
  let j: number = 0;
  while ((j < (Array.isArray(row0) || typeof row0 === 'string' ? row0.length : Object.keys(row0 ?? {}).length))) {
    const key: string = ((String(row0[j]) + ",") + String(row0[Math.trunc((j + 1))]));
    res = (res + dmap[key]);
    j = (j + 2);
  }
  return res;
}
function decrypt(text: string, emap: Record<string, number[]>, dmap: Record<string, string>): string {
  text = remove_space(text, emap);
  let coords: number[] = [];
  let i: number = 0;
  while ((i < (Array.isArray(text) || typeof text === 'string' ? text.length : Object.keys(text ?? {}).length))) {
    const ch: string = text.slice(i, (i + 1));
    const xy: number[] = emap[ch];
    coords = [...coords, xy[Math.trunc(0)]];
    coords = [...coords, xy[Math.trunc(1)]];
    i = (i + 1);
  }
  let half: number = Math.trunc((Array.isArray(coords) || typeof coords === 'string' ? coords.length : Object.keys(coords ?? {}).length) / 2);
  let k1: number[] = [];
  let k2: number[] = [];
  let idx: number = 0;
  while ((idx < half)) {
    k1 = [...k1, coords[idx]];
    idx = (idx + 1);
  }
  while ((idx < (Array.isArray(coords) || typeof coords === 'string' ? coords.length : Object.keys(coords ?? {}).length))) {
    k2 = [...k2, coords[idx]];
    idx = (idx + 1);
  }
  let res: string = "";
  let j: number = 0;
  while ((j < half)) {
    const key: string = ((String(k1[j]) + ",") + String(k2[j]));
    res = (res + dmap[key]);
    j = (j + 1);
  }
  return res;
}
function main() {
  const squareRosetta: string[][] = [["A", "B", "C", "D", "E"], ["F", "G", "H", "I", "K"], ["L", "M", "N", "O", "P"], ["Q", "R", "S", "T", "U"], ["V", "W", "X", "Y", "Z"], ["J", "1", "2", "3", "4"]];
  const squareWikipedia: string[][] = [["B", "G", "W", "K", "Z"], ["Q", "P", "N", "D", "S"], ["I", "O", "A", "X", "E"], ["F", "C", "L", "U", "M"], ["T", "H", "Y", "V", "R"], ["J", "1", "2", "3", "4"]];
  const textRosetta: string = "0ATTACKATDAWN";
  const textWikipedia: string = "FLEEATONCE";
  const textTest: string = "The invasion will start on the first of January";
  let maps: Record<string, any> = square_to_maps(squareRosetta);
  let emap = maps.e;
  let dmap = maps.d;
  console.log("from Rosettacode");
  console.log(("original:\t " + textRosetta));
  let s: string = encrypt(textRosetta, emap, dmap);
  console.log(("codiert:\t " + s));
  s = decrypt(s, emap, dmap);
  console.log(("and back:\t " + s));
  maps = square_to_maps(squareWikipedia);
  emap = maps.e;
  dmap = maps.d;
  console.log("from Wikipedia");
  console.log(("original:\t " + textWikipedia));
  s = encrypt(textWikipedia, emap, dmap);
  console.log(("codiert:\t " + s));
  s = decrypt(s, emap, dmap);
  console.log(("and back:\t " + s));
  maps = square_to_maps(squareWikipedia);
  emap = maps.e;
  dmap = maps.d;
  console.log("from Rosettacode long part");
  console.log(("original:\t " + textTest));
  s = encrypt(textTest, emap, dmap);
  console.log(("codiert:\t " + s));
  s = decrypt(s, emap, dmap);
  console.log(("and back:\t " + s));
}
main();
