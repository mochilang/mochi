# Generated by Mochi transpiler v0.10.37 on 2025-07-23 09:33 +0700

$now_seed = 0
$now_seeded = false
s = ENV['MOCHI_NOW_SEED']
if s && s != ''
  begin
    $now_seed = Integer(s)
    $now_seeded = true
  rescue StandardError
  end
end
def _now()
  if $now_seeded
    $now_seed = ($now_seed * 1664525 + 1013904223) % 2147483647
    $now_seed
  else
    Process.clock_gettime(Process::CLOCK_MONOTONIC, :nanosecond)
  end
end


def _input()
  line = STDIN.gets
  line ? line.chomp : ''
end

def parseIntStr(str)
  i = 0
  neg = false
  if str.length > 0 && str[0...1] == "-"
    neg = true
    i = 1
  end
  n = 0
  digits = {"0" => 0, "1" => 1, "2" => 2, "3" => 3, "4" => 4, "5" => 5, "6" => 6, "7" => 7, "8" => 8, "9" => 9}
  while i < str.length
    n = n * 10 + digits[str[i...i + 1]]
    i = i + 1
  end
  if neg
    n = -n
  end
  return n
end
def main()
  total = 0
  computer = _now() % 2 == 0
  puts("Enter q to quit at any time\n")
  if computer
    puts("The computer will choose first")
  else
    puts("You will choose first")
  end
  puts("\n\nRunning total is now 0\n\n")
  round = 1
  done = false
  while !done
    puts("ROUND " + (round).to_s + ":\n\n")
    i = 0
    while i < 2 && (!done)
      if computer
        choice = 0
        if total < 18
          choice = _now() % 3 + 1
        else
          choice = 21 - total
        end
        total = total + choice
        puts("The computer chooses " + (choice).to_s)
        puts("Running total is now " + (total).to_s)
        if total == 21
          puts("\nSo, commiserations, the computer has won!")
          done = true
        end
      else
        while true
          puts("Your choice 1 to 3 : ")
          line = _input()
          if line == "q" || line == "Q"
            puts("OK, quitting the game")
            done = true
            break
          end
          num = parseIntStr(line)
          if num < 1 || num > 3
            if total + num > 21
              puts("Too big, try again")
            else
              puts("Out of range, try again")
            end
            next
          end
          if total + num > 21
            puts("Too big, try again")
            next
          end
          total = total + num
          puts("Running total is now " + (total).to_s)
          break
        end
        if total == 21
          puts("\nSo, congratulations, you've won!")
          done = true
        end
      end
      puts("\n")
      computer = !computer
      i = i + 1
    end
    round = round + 1
  end
end
main()
