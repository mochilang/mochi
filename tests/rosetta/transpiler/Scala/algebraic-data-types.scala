// Generated by Mochi v0.10.39 on 2025-07-25 00:16:55 GMT+7
import scala.collection.mutable.{ArrayBuffer, Map}
object Main {
  def node(cl: String, le: Any, aa: Int, ri: Any): Map[String,Any] = {
    return Map("cl" -> (cl), "le" -> (le), "aa" -> (aa), "ri" -> (ri))
  }
  
  def treeString(t: Any): String = {
    if (t == null) {
      return "E"
    }
    val m: Map[String,Any] = t.asInstanceOf[Map[String,Any]]
    return "T(" + (m("cl")).toString + ", " + treeString(m("le")) + ", " + String.valueOf(m("aa")) + ", " + treeString(m("ri")) + ")"
  }
  
  def balance(t: Any): Any = {
    if (t == null) {
      return t
    }
    val m: Map[String,Any] = t.asInstanceOf[Map[String,Any]]
    if (m("cl") != "B") {
      return t
    }
    val le = m("le")
    val ri = m("ri")
    if (le != null) {
      val leMap: Map[String,Any] = le.asInstanceOf[Map[String,Any]]
      if (leMap("cl") == "R") {
        val lele = leMap("le")
        if (lele != null) {
          val leleMap: Map[String,Any] = lele.asInstanceOf[Map[String,Any]]
          if (leleMap("cl") == "R") {
            return (node("R", node("B", leleMap("le"), (leleMap("aa")).asInstanceOf[Int], leleMap("ri")), (leMap("aa")).asInstanceOf[Int], node("B", leMap("ri"), (m("aa")).asInstanceOf[Int], ri))).asInstanceOf[Any]
          }
        }
        val leri = leMap("ri")
        if (leri != null) {
          val leriMap: Map[String,Any] = leri.asInstanceOf[Map[String,Any]]
          if (leriMap("cl") == "R") {
            return (node("R", node("B", leMap("le"), (leMap("aa")).asInstanceOf[Int], leriMap("le")), (leriMap("aa")).asInstanceOf[Int], node("B", leriMap("ri"), (m("aa")).asInstanceOf[Int], ri))).asInstanceOf[Any]
          }
        }
      }
    }
    if (ri != null) {
      val riMap: Map[String,Any] = ri.asInstanceOf[Map[String,Any]]
      if (riMap("cl") == "R") {
        val rile = riMap("le")
        if (rile != null) {
          val rileMap: Map[String,Any] = rile.asInstanceOf[Map[String,Any]]
          if (rileMap("cl") == "R") {
            return (node("R", node("B", m("le"), (m("aa")).asInstanceOf[Int], rileMap("le")), (rileMap("aa")).asInstanceOf[Int], node("B", rileMap("ri"), (riMap("aa")).asInstanceOf[Int], riMap("ri")))).asInstanceOf[Any]
          }
        }
        val riri = riMap("ri")
        if (riri != null) {
          val ririMap: Map[String,Any] = riri.asInstanceOf[Map[String,Any]]
          if (ririMap("cl") == "R") {
            return (node("R", node("B", m("le"), (m("aa")).asInstanceOf[Int], riMap("le")), (riMap("aa")).asInstanceOf[Int], node("B", ririMap("le"), (ririMap("aa")).asInstanceOf[Int], ririMap("ri")))).asInstanceOf[Any]
          }
        }
      }
    }
    return t
  }
  
  def ins(tr: Any, x: Int): Any = {
    if (tr == null) {
      return (node("R", null, x, null)).asInstanceOf[Any]
    }
    if (x < (tr.asInstanceOf[Map[String,Any]]("aa")).asInstanceOf[Int]) {
      return balance(node((tr.asInstanceOf[Map[String,Any]]("cl")).toString, ins(tr.asInstanceOf[Map[String,Any]]("le"), x), (tr.asInstanceOf[Map[String,Any]]("aa")).asInstanceOf[Int], tr.asInstanceOf[Map[String,Any]]("ri")))
    }
    if (x > (tr.asInstanceOf[Map[String,Any]]("aa")).asInstanceOf[Int]) {
      return balance(node((tr.asInstanceOf[Map[String,Any]]("cl")).toString, tr.asInstanceOf[Map[String,Any]]("le"), (tr.asInstanceOf[Map[String,Any]]("aa")).asInstanceOf[Int], ins(tr.asInstanceOf[Map[String,Any]]("ri"), x)))
    }
    return tr
  }
  
  def insert(tr: Any, x: Int): Any = {
    val t = ins(tr, x)
    if (t == null) {
      return null.asInstanceOf[Any]
    }
    val m: Map[String,Any] = t.asInstanceOf[Map[String,Any]]
    return (node("B", m("le"), (m("aa")).asInstanceOf[Int], m("ri"))).asInstanceOf[Any]
  }
  
  var tr: Any = null
  
  var i: Int = 1
  
  def main(args: Array[String]): Unit = {
    while (i <= 16) {
      tr = insert(tr, i)
      i = (i + 1).asInstanceOf[Int]
    }
    println(treeString(tr))
  }
}
