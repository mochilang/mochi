/*
Root-Mean-Square Speed of Gas Molecules
---------------------------------------
The root-mean-square (RMS) speed estimates the average speed of particles in a gas.
For a given absolute temperature `T` in Kelvin and molar mass `M` in kg/mol,
the RMS speed is given by:

    Vrms = sqrt(3 * R * T / M)

where `R` is the universal gas constant (8.3144598 J/(molÂ·K)).
This implementation validates that the temperature is non-negative and the
molar mass is positive before computing the square root using Newton's method.
The algorithm runs in constant time.
*/

let UNIVERSAL_GAS_CONSTANT: float = 8.3144598

fun sqrt(x: float): float {
  if x <= 0.0 { return 0.0 }
  var guess = x
  var i = 0
  while i < 10 {
    guess = (guess + x / guess) / 2.0
    i = i + 1
  }
  return guess
}

fun rms_speed_of_molecule(temperature: float, molar_mass: float): float {
  if temperature < 0.0 { panic("Temperature cannot be less than 0 K") }
  if molar_mass <= 0.0 { panic("Molar mass cannot be less than or equal to 0 kg/mol") }
  let num = 3.0 * UNIVERSAL_GAS_CONSTANT * temperature
  let val: float = num / molar_mass
  let result: float = sqrt(val)
  return result
}

print("rms_speed_of_molecule(100, 2) = " + str(rms_speed_of_molecule(100.0, 2.0)))
print("rms_speed_of_molecule(273, 12) = " + str(rms_speed_of_molecule(273.0, 12.0)))
let vrms = rms_speed_of_molecule(300.0, 28.0)
print("Vrms of Nitrogen gas at 300 K is " + str(vrms) + " m/s")
