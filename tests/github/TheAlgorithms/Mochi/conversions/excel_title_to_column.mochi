/*
Excel Column Title to Number
----------------------------
Convert an Excel-style column title (e.g. "AB") to its corresponding
column number.  Columns are labeled in base-26 using letters A..Z where
A=1, B=2, ..., Z=26.  The algorithm iterates through each character from
left to right, multiplies the accumulated result by 26, and adds the
character's value.  Only uppercase letters are accepted; any other
character triggers a runtime panic.

Time complexity: O(n) for a title of length n.
Space complexity: O(1).
*/

let letters = "ABCDEFGHIJKLMNOPQRSTUVWXYZ"

fun excel_title_to_column(title: string): int {
  var result = 0
  var i = 0
  while i < len(title) {
    let ch = title[i:i+1]
    var value = 0
    var idx = 0
    var found = false
    while idx < len(letters) {
      if letters[idx:idx+1] == ch {
        value = idx + 1
        found = true
        break
      }
      idx = idx + 1
    }
    if !found {
      panic("title must contain only uppercase A-Z")
    }
    result = result * 26 + value
    i = i + 1
  }
  return result
}

fun main() {
  print(excel_title_to_column("A"))
  print(excel_title_to_column("B"))
  print(excel_title_to_column("AB"))
  print(excel_title_to_column("Z"))
}

main()
