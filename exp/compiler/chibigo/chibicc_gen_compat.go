// Code generated by ccgo from chibicc sources; DO NOT EDIT.

package main

import (
	"unsafe"
	"modernc.org/libc"
)

func xstrndup(tls *libc.TLS, s uintptr, n size_t) uintptr { /* compat.c:3:6: */
	var buf uintptr = libc.Xcalloc(tls, uint64(1), n+uint64(1))
	libc.Xmemcpy(tls, buf, s, n)
	*(*int8)(unsafe.Pointer(buf + uintptr(n))) = int8(0)
	return buf
}

func xdirname(tls *libc.TLS, path uintptr) uintptr { /* compat.c:10:6: */
	if !(path != 0) || !(int32(*(*int8)(unsafe.Pointer(path))) != 0) {
		return libc.Xstrdup(tls, ts+6708)
	}

	var slash uintptr = libc.Xstrrchr(tls, path, '/')
	if !(slash != 0) {
		return libc.Xstrdup(tls, ts+6708)
	}
	if slash == path {
		return libc.Xstrdup(tls, ts+6710)
	}
	return xstrndup(tls, path, uint64((int64(slash)-int64(path))/1))
}

func xbasename(tls *libc.TLS, path uintptr) uintptr { /* compat.c:22:6: */
	if !(path != 0) || !(int32(*(*int8)(unsafe.Pointer(path))) != 0) {
		return libc.Xstrdup(tls, ts+6708)
	}

	var slash uintptr = libc.Xstrrchr(tls, path, '/')
	if !(slash != 0) {
		return libc.Xstrdup(tls, path)
	}
	if int32(*(*int8)(unsafe.Pointer(slash + uintptr(1)))) == 0 {
		return libc.Xstrdup(tls, ts+6710)
	}
	return libc.Xstrdup(tls, slash+uintptr(1))
}

func xwait(tls *libc.TLS, status uintptr) int32 { /* compat.c:34:5: */
	return libc.Xwaitpid(tls, -1, status, 0)
}

